var Mt=Object.defineProperty;var Zt=(j,i,t)=>i in j?Mt(j,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):j[i]=t;var et=(j,i,t)=>Zt(j,typeof i!="symbol"?i+"":i,t);(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))d(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&d(n)}).observe(document,{childList:!0,subtree:!0});function t(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function d(a){if(a.ep)return;a.ep=!0;const r=t(a);fetch(a.href,r)}})();class $t{constructor(){et(this,"originalFile",null);et(this,"currentFile",null);et(this,"onBothFilesReady",null);this.initializeUploadHandlers()}initializeUploadHandlers(){const i=document.getElementById("original-upload"),t=document.getElementById("current-upload"),d=i.parentElement?.querySelector(".upload-label"),a=t.parentElement?.querySelector(".upload-label");i.addEventListener("change",r=>{const n=r.target.files?.[0];n&&this.handleOriginalFile(n)}),t.addEventListener("change",r=>{const n=r.target.files?.[0];n&&this.handleCurrentFile(n)}),d&&this.setupDragAndDrop(d,r=>this.handleOriginalFile(r)),a&&this.setupDragAndDrop(a,r=>this.handleCurrentFile(r))}setupDragAndDrop(i,t){i.addEventListener("dragover",d=>{d.preventDefault(),i.classList.add("drag-over")}),i.addEventListener("dragleave",()=>{i.classList.remove("drag-over")}),i.addEventListener("drop",d=>{d.preventDefault(),i.classList.remove("drag-over");const a=d.dataTransfer?.files[0];a&&a.name.endsWith(".docx")?t(a):alert("Please drop a .docx file")})}handleOriginalFile(i){this.originalFile=i,this.updateFileDisplay("original",i.name),this.checkBothFilesReady()}handleCurrentFile(i){this.currentFile=i,this.updateFileDisplay("current",i.name),this.checkBothFilesReady()}updateFileDisplay(i,t){const d=document.getElementById(`${i}-name`),a=document.getElementById(`${i}-upload`)?.parentElement?.querySelector(".upload-label");d&&(d.textContent=t),a&&a.classList.add("has-file")}checkBothFilesReady(){this.originalFile&&this.currentFile&&this.onBothFilesReady&&this.onBothFilesReady(this.originalFile,this.currentFile)}onFilesReady(i){this.onBothFilesReady=i}reset(){this.originalFile=null,this.currentFile=null;const i=document.getElementById("original-upload"),t=document.getElementById("current-upload");i&&(i.value=""),t&&(t.value=""),["original","current"].forEach(d=>{const a=document.getElementById(`${d}-name`),r=document.getElementById(`${d}-upload`)?.parentElement?.querySelector(".upload-label");a&&(a.textContent=""),r&&r.classList.remove("has-file")})}}var Et=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xt(j){return j&&j.__esModule&&Object.prototype.hasOwnProperty.call(j,"default")?j.default:j}function Ct(j){throw new Error('Could not dynamically require "'+j+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var It={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Ft;function Ht(){return Ft||(Ft=1,(function(j,i){(function(t){j.exports=t()})(function(){return(function t(d,a,r){function n(g,b){if(!a[g]){if(!d[g]){var v=typeof Ct=="function"&&Ct;if(!b&&v)return v(g,!0);if(s)return s(g,!0);var w=new Error("Cannot find module '"+g+"'");throw w.code="MODULE_NOT_FOUND",w}var l=a[g]={exports:{}};d[g][0].call(l.exports,function(m){var c=d[g][1][m];return n(c||m)},l,l.exports,t,d,a,r)}return a[g].exports}for(var s=typeof Ct=="function"&&Ct,u=0;u<r.length;u++)n(r[u]);return n})({1:[function(t,d,a){var r=t("./utils"),n=t("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(u){for(var g,b,v,w,l,m,c,f=[],h=0,y=u.length,k=y,E=r.getTypeOf(u)!=="string";h<u.length;)k=y-h,v=E?(g=u[h++],b=h<y?u[h++]:0,h<y?u[h++]:0):(g=u.charCodeAt(h++),b=h<y?u.charCodeAt(h++):0,h<y?u.charCodeAt(h++):0),w=g>>2,l=(3&g)<<4|b>>4,m=1<k?(15&b)<<2|v>>6:64,c=2<k?63&v:64,f.push(s.charAt(w)+s.charAt(l)+s.charAt(m)+s.charAt(c));return f.join("")},a.decode=function(u){var g,b,v,w,l,m,c=0,f=0,h="data:";if(u.substr(0,h.length)===h)throw new Error("Invalid base64 input, it looks like a data url.");var y,k=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===s.charAt(64)&&k--,u.charAt(u.length-2)===s.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=n.uint8array?new Uint8Array(0|k):new Array(0|k);c<u.length;)g=s.indexOf(u.charAt(c++))<<2|(w=s.indexOf(u.charAt(c++)))>>4,b=(15&w)<<4|(l=s.indexOf(u.charAt(c++)))>>2,v=(3&l)<<6|(m=s.indexOf(u.charAt(c++))),y[f++]=g,l!==64&&(y[f++]=b),m!==64&&(y[f++]=v);return y}},{"./support":30,"./utils":32}],2:[function(t,d,a){var r=t("./external"),n=t("./stream/DataWorker"),s=t("./stream/Crc32Probe"),u=t("./stream/DataLengthProbe");function g(b,v,w,l,m){this.compressedSize=b,this.uncompressedSize=v,this.crc32=w,this.compression=l,this.compressedContent=m}g.prototype={getContentWorker:function(){var b=new n(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),v=this;return b.on("end",function(){if(this.streamInfo.data_length!==v.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),b},getCompressedWorker:function(){return new n(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},g.createWorkerFrom=function(b,v,w){return b.pipe(new s).pipe(new u("uncompressedSize")).pipe(v.compressWorker(w)).pipe(new u("compressedSize")).withStreamInfo("compression",v)},d.exports=g},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,d,a){var r=t("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},a.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,d,a){var r=t("./utils"),n=(function(){for(var s,u=[],g=0;g<256;g++){s=g;for(var b=0;b<8;b++)s=1&s?3988292384^s>>>1:s>>>1;u[g]=s}return u})();d.exports=function(s,u){return s!==void 0&&s.length?r.getTypeOf(s)!=="string"?(function(g,b,v,w){var l=n,m=w+v;g^=-1;for(var c=w;c<m;c++)g=g>>>8^l[255&(g^b[c])];return-1^g})(0|u,s,s.length,0):(function(g,b,v,w){var l=n,m=w+v;g^=-1;for(var c=w;c<m;c++)g=g>>>8^l[255&(g^b.charCodeAt(c))];return-1^g})(0|u,s,s.length,0):0}},{"./utils":32}],5:[function(t,d,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(t,d,a){var r=null;r=typeof Promise<"u"?Promise:t("lie"),d.exports={Promise:r}},{lie:37}],7:[function(t,d,a){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",n=t("pako"),s=t("./utils"),u=t("./stream/GenericWorker"),g=r?"uint8array":"array";function b(v,w){u.call(this,"FlateWorker/"+v),this._pako=null,this._pakoAction=v,this._pakoOptions=w,this.meta={}}a.magic="\b\0",s.inherits(b,u),b.prototype.processChunk=function(v){this.meta=v.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(g,v.data),!1)},b.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},b.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},b.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var v=this;this._pako.onData=function(w){v.push({data:w,meta:v.meta})}},a.compressWorker=function(v){return new b("Deflate",v)},a.uncompressWorker=function(){return new b("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,d,a){function r(l,m){var c,f="";for(c=0;c<m;c++)f+=String.fromCharCode(255&l),l>>>=8;return f}function n(l,m,c,f,h,y){var k,E,S=l.file,O=l.compression,D=y!==g.utf8encode,U=s.transformTo("string",y(S.name)),B=s.transformTo("string",g.utf8encode(S.name)),Z=S.comment,V=s.transformTo("string",y(Z)),x=s.transformTo("string",g.utf8encode(Z)),R=B.length!==S.name.length,o=x.length!==Z.length,P="",Q="",W="",tt=S.dir,M=S.date,J={crc32:0,compressedSize:0,uncompressedSize:0};m&&!c||(J.crc32=l.crc32,J.compressedSize=l.compressedSize,J.uncompressedSize=l.uncompressedSize);var A=0;m&&(A|=8),D||!R&&!o||(A|=2048);var I=0,K=0;tt&&(I|=16),h==="UNIX"?(K=798,I|=(function(H,at){var ct=H;return H||(ct=at?16893:33204),(65535&ct)<<16})(S.unixPermissions,tt)):(K=20,I|=(function(H){return 63&(H||0)})(S.dosPermissions)),k=M.getUTCHours(),k<<=6,k|=M.getUTCMinutes(),k<<=5,k|=M.getUTCSeconds()/2,E=M.getUTCFullYear()-1980,E<<=4,E|=M.getUTCMonth()+1,E<<=5,E|=M.getUTCDate(),R&&(Q=r(1,1)+r(b(U),4)+B,P+="up"+r(Q.length,2)+Q),o&&(W=r(1,1)+r(b(V),4)+x,P+="uc"+r(W.length,2)+W);var G="";return G+=`
\0`,G+=r(A,2),G+=O.magic,G+=r(k,2),G+=r(E,2),G+=r(J.crc32,4),G+=r(J.compressedSize,4),G+=r(J.uncompressedSize,4),G+=r(U.length,2),G+=r(P.length,2),{fileRecord:v.LOCAL_FILE_HEADER+G+U+P,dirRecord:v.CENTRAL_FILE_HEADER+r(K,2)+G+r(V.length,2)+"\0\0\0\0"+r(I,4)+r(f,4)+U+P+V}}var s=t("../utils"),u=t("../stream/GenericWorker"),g=t("../utf8"),b=t("../crc32"),v=t("../signature");function w(l,m,c,f){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=m,this.zipPlatform=c,this.encodeFileName=f,this.streamFiles=l,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(w,u),w.prototype.push=function(l){var m=l.meta.percent||0,c=this.entriesCount,f=this._sources.length;this.accumulate?this.contentBuffer.push(l):(this.bytesWritten+=l.data.length,u.prototype.push.call(this,{data:l.data,meta:{currentFile:this.currentFile,percent:c?(m+100*(c-f-1))/c:100}}))},w.prototype.openedSource=function(l){this.currentSourceOffset=this.bytesWritten,this.currentFile=l.file.name;var m=this.streamFiles&&!l.file.dir;if(m){var c=n(l,m,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:c.fileRecord,meta:{percent:0}})}else this.accumulate=!0},w.prototype.closedSource=function(l){this.accumulate=!1;var m=this.streamFiles&&!l.file.dir,c=n(l,m,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(c.dirRecord),m)this.push({data:(function(f){return v.DATA_DESCRIPTOR+r(f.crc32,4)+r(f.compressedSize,4)+r(f.uncompressedSize,4)})(l),meta:{percent:100}});else for(this.push({data:c.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},w.prototype.flush=function(){for(var l=this.bytesWritten,m=0;m<this.dirRecords.length;m++)this.push({data:this.dirRecords[m],meta:{percent:100}});var c=this.bytesWritten-l,f=(function(h,y,k,E,S){var O=s.transformTo("string",S(E));return v.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(h,2)+r(h,2)+r(y,4)+r(k,4)+r(O.length,2)+O})(this.dirRecords.length,c,l,this.zipComment,this.encodeFileName);this.push({data:f,meta:{percent:100}})},w.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},w.prototype.registerPrevious=function(l){this._sources.push(l);var m=this;return l.on("data",function(c){m.processChunk(c)}),l.on("end",function(){m.closedSource(m.previous.streamInfo),m._sources.length?m.prepareNextSource():m.end()}),l.on("error",function(c){m.error(c)}),this},w.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},w.prototype.error=function(l){var m=this._sources;if(!u.prototype.error.call(this,l))return!1;for(var c=0;c<m.length;c++)try{m[c].error(l)}catch{}return!0},w.prototype.lock=function(){u.prototype.lock.call(this);for(var l=this._sources,m=0;m<l.length;m++)l[m].lock()},d.exports=w},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,d,a){var r=t("../compressions"),n=t("./ZipFileWorker");a.generateWorker=function(s,u,g){var b=new n(u.streamFiles,g,u.platform,u.encodeFileName),v=0;try{s.forEach(function(w,l){v++;var m=(function(y,k){var E=y||k,S=r[E];if(!S)throw new Error(E+" is not a valid compression method !");return S})(l.options.compression,u.compression),c=l.options.compressionOptions||u.compressionOptions||{},f=l.dir,h=l.date;l._compressWorker(m,c).withStreamInfo("file",{name:w,dir:f,date:h,comment:l.comment||"",unixPermissions:l.unixPermissions,dosPermissions:l.dosPermissions}).pipe(b)}),b.entriesCount=v}catch(w){b.error(w)}return b}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,d,a){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var n=new r;for(var s in this)typeof this[s]!="function"&&(n[s]=this[s]);return n}}(r.prototype=t("./object")).loadAsync=t("./load"),r.support=t("./support"),r.defaults=t("./defaults"),r.version="3.10.1",r.loadAsync=function(n,s){return new r().loadAsync(n,s)},r.external=t("./external"),d.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,d,a){var r=t("./utils"),n=t("./external"),s=t("./utf8"),u=t("./zipEntries"),g=t("./stream/Crc32Probe"),b=t("./nodejsUtils");function v(w){return new n.Promise(function(l,m){var c=w.decompressed.getContentWorker().pipe(new g);c.on("error",function(f){m(f)}).on("end",function(){c.streamInfo.crc32!==w.decompressed.crc32?m(new Error("Corrupted zip : CRC32 mismatch")):l()}).resume()})}d.exports=function(w,l){var m=this;return l=r.extend(l||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),b.isNode&&b.isStream(w)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",w,!0,l.optimizedBinaryString,l.base64).then(function(c){var f=new u(l);return f.load(c),f}).then(function(c){var f=[n.Promise.resolve(c)],h=c.files;if(l.checkCRC32)for(var y=0;y<h.length;y++)f.push(v(h[y]));return n.Promise.all(f)}).then(function(c){for(var f=c.shift(),h=f.files,y=0;y<h.length;y++){var k=h[y],E=k.fileNameStr,S=r.resolve(k.fileNameStr);m.file(S,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:l.createFolders}),k.dir||(m.file(S).unsafeOriginalName=E)}return f.zipComment.length&&(m.comment=f.zipComment),m})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,d,a){var r=t("../utils"),n=t("../stream/GenericWorker");function s(u,g){n.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(g)}r.inherits(s,n),s.prototype._bindStream=function(u){var g=this;(this._stream=u).pause(),u.on("data",function(b){g.push({data:b,meta:{percent:0}})}).on("error",function(b){g.isPaused?this.generatedError=b:g.error(b)}).on("end",function(){g.isPaused?g._upstreamEnded=!0:g.end()})},s.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},d.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,d,a){var r=t("readable-stream").Readable;function n(s,u,g){r.call(this,u),this._helper=s;var b=this;s.on("data",function(v,w){b.push(v)||b._helper.pause(),g&&g(w)}).on("error",function(v){b.emit("error",v)}).on("end",function(){b.push(null)})}t("../utils").inherits(n,r),n.prototype._read=function(){this._helper.resume()},d.exports=n},{"../utils":32,"readable-stream":16}],14:[function(t,d,a){d.exports={isNode:typeof Buffer<"u",newBufferFrom:function(r,n){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,n);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,n)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var n=new Buffer(r);return n.fill(0),n},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}}},{}],15:[function(t,d,a){function r(S,O,D){var U,B=s.getTypeOf(O),Z=s.extend(D||{},b);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(S=h(S)),Z.createFolders&&(U=f(S))&&y.call(this,U,!0);var V=B==="string"&&Z.binary===!1&&Z.base64===!1;D&&D.binary!==void 0||(Z.binary=!V),(O instanceof v&&O.uncompressedSize===0||Z.dir||!O||O.length===0)&&(Z.base64=!1,Z.binary=!0,O="",Z.compression="STORE",B="string");var x=null;x=O instanceof v||O instanceof u?O:m.isNode&&m.isStream(O)?new c(S,O):s.prepareContent(S,O,Z.binary,Z.optimizedBinaryString,Z.base64);var R=new w(S,x,Z);this.files[S]=R}var n=t("./utf8"),s=t("./utils"),u=t("./stream/GenericWorker"),g=t("./stream/StreamHelper"),b=t("./defaults"),v=t("./compressedObject"),w=t("./zipObject"),l=t("./generate"),m=t("./nodejsUtils"),c=t("./nodejs/NodejsStreamInputAdapter"),f=function(S){S.slice(-1)==="/"&&(S=S.substring(0,S.length-1));var O=S.lastIndexOf("/");return 0<O?S.substring(0,O):""},h=function(S){return S.slice(-1)!=="/"&&(S+="/"),S},y=function(S,O){return O=O!==void 0?O:b.createFolders,S=h(S),this.files[S]||r.call(this,S,null,{dir:!0,createFolders:O}),this.files[S]};function k(S){return Object.prototype.toString.call(S)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(S){var O,D,U;for(O in this.files)U=this.files[O],(D=O.slice(this.root.length,O.length))&&O.slice(0,this.root.length)===this.root&&S(D,U)},filter:function(S){var O=[];return this.forEach(function(D,U){S(D,U)&&O.push(U)}),O},file:function(S,O,D){if(arguments.length!==1)return S=this.root+S,r.call(this,S,O,D),this;if(k(S)){var U=S;return this.filter(function(Z,V){return!V.dir&&U.test(Z)})}var B=this.files[this.root+S];return B&&!B.dir?B:null},folder:function(S){if(!S)return this;if(k(S))return this.filter(function(B,Z){return Z.dir&&S.test(B)});var O=this.root+S,D=y.call(this,O),U=this.clone();return U.root=D.name,U},remove:function(S){S=this.root+S;var O=this.files[S];if(O||(S.slice(-1)!=="/"&&(S+="/"),O=this.files[S]),O&&!O.dir)delete this.files[S];else for(var D=this.filter(function(B,Z){return Z.name.slice(0,S.length)===S}),U=0;U<D.length;U++)delete this.files[D[U].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(S){var O,D={};try{if((D=s.extend(S||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=D.type.toLowerCase(),D.compression=D.compression.toUpperCase(),D.type==="binarystring"&&(D.type="string"),!D.type)throw new Error("No output type specified.");s.checkSupport(D.type),D.platform!=="darwin"&&D.platform!=="freebsd"&&D.platform!=="linux"&&D.platform!=="sunos"||(D.platform="UNIX"),D.platform==="win32"&&(D.platform="DOS");var U=D.comment||this.comment||"";O=l.generateWorker(this,D,U)}catch(B){(O=new u("error")).error(B)}return new g(O,D.type||"string",D.mimeType)},generateAsync:function(S,O){return this.generateInternalStream(S).accumulate(O)},generateNodeStream:function(S,O){return(S=S||{}).type||(S.type="nodebuffer"),this.generateInternalStream(S).toNodejsStream(O)}};d.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,d,a){d.exports=t("stream")},{stream:void 0}],17:[function(t,d,a){var r=t("./DataReader");function n(s){r.call(this,s);for(var u=0;u<this.data.length;u++)s[u]=255&s[u]}t("../utils").inherits(n,r),n.prototype.byteAt=function(s){return this.data[this.zero+s]},n.prototype.lastIndexOfSignature=function(s){for(var u=s.charCodeAt(0),g=s.charCodeAt(1),b=s.charCodeAt(2),v=s.charCodeAt(3),w=this.length-4;0<=w;--w)if(this.data[w]===u&&this.data[w+1]===g&&this.data[w+2]===b&&this.data[w+3]===v)return w-this.zero;return-1},n.prototype.readAndCheckSignature=function(s){var u=s.charCodeAt(0),g=s.charCodeAt(1),b=s.charCodeAt(2),v=s.charCodeAt(3),w=this.readData(4);return u===w[0]&&g===w[1]&&b===w[2]&&v===w[3]},n.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,u},d.exports=n},{"../utils":32,"./DataReader":18}],18:[function(t,d,a){var r=t("../utils");function n(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var u,g=0;for(this.checkOffset(s),u=this.index+s-1;u>=this.index;u--)g=(g<<8)+this.byteAt(u);return this.index+=s,g},readString:function(s){return r.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},d.exports=n},{"../utils":32}],19:[function(t,d,a){var r=t("./Uint8ArrayReader");function n(s){r.call(this,s)}t("../utils").inherits(n,r),n.prototype.readData=function(s){this.checkOffset(s);var u=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,u},d.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,d,a){var r=t("./DataReader");function n(s){r.call(this,s)}t("../utils").inherits(n,r),n.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},n.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},n.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},n.prototype.readData=function(s){this.checkOffset(s);var u=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,u},d.exports=n},{"../utils":32,"./DataReader":18}],21:[function(t,d,a){var r=t("./ArrayReader");function n(s){r.call(this,s)}t("../utils").inherits(n,r),n.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,u},d.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(t,d,a){var r=t("../utils"),n=t("../support"),s=t("./ArrayReader"),u=t("./StringReader"),g=t("./NodeBufferReader"),b=t("./Uint8ArrayReader");d.exports=function(v){var w=r.getTypeOf(v);return r.checkSupport(w),w!=="string"||n.uint8array?w==="nodebuffer"?new g(v):n.uint8array?new b(r.transformTo("uint8array",v)):new s(r.transformTo("array",v)):new u(v)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,d,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,d,a){var r=t("./GenericWorker"),n=t("../utils");function s(u){r.call(this,"ConvertWorker to "+u),this.destType=u}n.inherits(s,r),s.prototype.processChunk=function(u){this.push({data:n.transformTo(this.destType,u.data),meta:u.meta})},d.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(t,d,a){var r=t("./GenericWorker"),n=t("../crc32");function s(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(s,r),s.prototype.processChunk=function(u){this.streamInfo.crc32=n(u.data,this.streamInfo.crc32||0),this.push(u)},d.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,d,a){var r=t("../utils"),n=t("./GenericWorker");function s(u){n.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}r.inherits(s,n),s.prototype.processChunk=function(u){if(u){var g=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=g+u.data.length}n.prototype.processChunk.call(this,u)},d.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(t,d,a){var r=t("../utils"),n=t("./GenericWorker");function s(u){n.call(this,"DataWorker");var g=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(b){g.dataIsReady=!0,g.data=b,g.max=b&&b.length||0,g.type=r.getTypeOf(b),g.isPaused||g._tickAndRepeat()},function(b){g.error(b)})}r.inherits(s,n),s.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,g=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,g);break;case"uint8array":u=this.data.subarray(this.index,g);break;case"array":case"nodebuffer":u=this.data.slice(this.index,g)}return this.index=g,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},d.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(t,d,a){function r(n){this.name=n||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(n){this.emit("data",n)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(n){this.emit("error",n)}return!0},error:function(n){return!this.isFinished&&(this.isPaused?this.generatedError=n:(this.isFinished=!0,this.emit("error",n),this.previous&&this.previous.error(n),this.cleanUp()),!0)},on:function(n,s){return this._listeners[n].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(n,s){if(this._listeners[n])for(var u=0;u<this._listeners[n].length;u++)this._listeners[n][u].call(this,s)},pipe:function(n){return n.registerPrevious(this)},registerPrevious:function(n){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=n.streamInfo,this.mergeStreamInfo(),this.previous=n;var s=this;return n.on("data",function(u){s.processChunk(u)}),n.on("end",function(){s.end()}),n.on("error",function(u){s.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var n=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),n=!0),this.previous&&this.previous.resume(),!n},flush:function(){},processChunk:function(n){this.push(n)},withStreamInfo:function(n,s){return this.extraStreamInfo[n]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var n in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,n)&&(this.streamInfo[n]=this.extraStreamInfo[n])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var n="Worker "+this.name;return this.previous?this.previous+" -> "+n:n}},d.exports=r},{}],29:[function(t,d,a){var r=t("../utils"),n=t("./ConvertWorker"),s=t("./GenericWorker"),u=t("../base64"),g=t("../support"),b=t("../external"),v=null;if(g.nodestream)try{v=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function w(m,c){return new b.Promise(function(f,h){var y=[],k=m._internalType,E=m._outputType,S=m._mimeType;m.on("data",function(O,D){y.push(O),c&&c(D)}).on("error",function(O){y=[],h(O)}).on("end",function(){try{var O=(function(D,U,B){switch(D){case"blob":return r.newBlob(r.transformTo("arraybuffer",U),B);case"base64":return u.encode(U);default:return r.transformTo(D,U)}})(E,(function(D,U){var B,Z=0,V=null,x=0;for(B=0;B<U.length;B++)x+=U[B].length;switch(D){case"string":return U.join("");case"array":return Array.prototype.concat.apply([],U);case"uint8array":for(V=new Uint8Array(x),B=0;B<U.length;B++)V.set(U[B],Z),Z+=U[B].length;return V;case"nodebuffer":return Buffer.concat(U);default:throw new Error("concat : unsupported type '"+D+"'")}})(k,y),S);f(O)}catch(D){h(D)}y=[]}).resume()})}function l(m,c,f){var h=c;switch(c){case"blob":case"arraybuffer":h="uint8array";break;case"base64":h="string"}try{this._internalType=h,this._outputType=c,this._mimeType=f,r.checkSupport(h),this._worker=m.pipe(new n(h)),m.lock()}catch(y){this._worker=new s("error"),this._worker.error(y)}}l.prototype={accumulate:function(m){return w(this,m)},on:function(m,c){var f=this;return m==="data"?this._worker.on(m,function(h){c.call(f,h.data,h.meta)}):this._worker.on(m,function(){r.delay(c,arguments,f)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(r.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new v(this,{objectMode:this._outputType!=="nodebuffer"},m)}},d.exports=l},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,d,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var r=new ArrayBuffer(0);try{a.blob=new Blob([r],{type:"application/zip"}).size===0}catch{try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(r),a.blob=n.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!t("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(t,d,a){for(var r=t("./utils"),n=t("./support"),s=t("./nodejsUtils"),u=t("./stream/GenericWorker"),g=new Array(256),b=0;b<256;b++)g[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;g[254]=g[254]=1;function v(){u.call(this,"utf-8 decode"),this.leftOver=null}function w(){u.call(this,"utf-8 encode")}a.utf8encode=function(l){return n.nodebuffer?s.newBufferFrom(l,"utf-8"):(function(m){var c,f,h,y,k,E=m.length,S=0;for(y=0;y<E;y++)(64512&(f=m.charCodeAt(y)))==55296&&y+1<E&&(64512&(h=m.charCodeAt(y+1)))==56320&&(f=65536+(f-55296<<10)+(h-56320),y++),S+=f<128?1:f<2048?2:f<65536?3:4;for(c=n.uint8array?new Uint8Array(S):new Array(S),y=k=0;k<S;y++)(64512&(f=m.charCodeAt(y)))==55296&&y+1<E&&(64512&(h=m.charCodeAt(y+1)))==56320&&(f=65536+(f-55296<<10)+(h-56320),y++),f<128?c[k++]=f:(f<2048?c[k++]=192|f>>>6:(f<65536?c[k++]=224|f>>>12:(c[k++]=240|f>>>18,c[k++]=128|f>>>12&63),c[k++]=128|f>>>6&63),c[k++]=128|63&f);return c})(l)},a.utf8decode=function(l){return n.nodebuffer?r.transformTo("nodebuffer",l).toString("utf-8"):(function(m){var c,f,h,y,k=m.length,E=new Array(2*k);for(c=f=0;c<k;)if((h=m[c++])<128)E[f++]=h;else if(4<(y=g[h]))E[f++]=65533,c+=y-1;else{for(h&=y===2?31:y===3?15:7;1<y&&c<k;)h=h<<6|63&m[c++],y--;1<y?E[f++]=65533:h<65536?E[f++]=h:(h-=65536,E[f++]=55296|h>>10&1023,E[f++]=56320|1023&h)}return E.length!==f&&(E.subarray?E=E.subarray(0,f):E.length=f),r.applyFromCharCode(E)})(l=r.transformTo(n.uint8array?"uint8array":"array",l))},r.inherits(v,u),v.prototype.processChunk=function(l){var m=r.transformTo(n.uint8array?"uint8array":"array",l.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var c=m;(m=new Uint8Array(c.length+this.leftOver.length)).set(this.leftOver,0),m.set(c,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var f=(function(y,k){var E;for((k=k||y.length)>y.length&&(k=y.length),E=k-1;0<=E&&(192&y[E])==128;)E--;return E<0||E===0?k:E+g[y[E]]>k?E:k})(m),h=m;f!==m.length&&(n.uint8array?(h=m.subarray(0,f),this.leftOver=m.subarray(f,m.length)):(h=m.slice(0,f),this.leftOver=m.slice(f,m.length))),this.push({data:a.utf8decode(h),meta:l.meta})},v.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=v,r.inherits(w,u),w.prototype.processChunk=function(l){this.push({data:a.utf8encode(l.data),meta:l.meta})},a.Utf8EncodeWorker=w},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,d,a){var r=t("./support"),n=t("./base64"),s=t("./nodejsUtils"),u=t("./external");function g(c){return c}function b(c,f){for(var h=0;h<c.length;++h)f[h]=255&c.charCodeAt(h);return f}t("setimmediate"),a.newBlob=function(c,f){a.checkSupport("blob");try{return new Blob([c],{type:f})}catch{try{var h=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return h.append(c),h.getBlob(f)}catch{throw new Error("Bug : can't construct the Blob.")}}};var v={stringifyByChunk:function(c,f,h){var y=[],k=0,E=c.length;if(E<=h)return String.fromCharCode.apply(null,c);for(;k<E;)f==="array"||f==="nodebuffer"?y.push(String.fromCharCode.apply(null,c.slice(k,Math.min(k+h,E)))):y.push(String.fromCharCode.apply(null,c.subarray(k,Math.min(k+h,E)))),k+=h;return y.join("")},stringifyByChar:function(c){for(var f="",h=0;h<c.length;h++)f+=String.fromCharCode(c[h]);return f},applyCanBeUsed:{uint8array:(function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}})()}};function w(c){var f=65536,h=a.getTypeOf(c),y=!0;if(h==="uint8array"?y=v.applyCanBeUsed.uint8array:h==="nodebuffer"&&(y=v.applyCanBeUsed.nodebuffer),y)for(;1<f;)try{return v.stringifyByChunk(c,h,f)}catch{f=Math.floor(f/2)}return v.stringifyByChar(c)}function l(c,f){for(var h=0;h<c.length;h++)f[h]=c[h];return f}a.applyFromCharCode=w;var m={};m.string={string:g,array:function(c){return b(c,new Array(c.length))},arraybuffer:function(c){return m.string.uint8array(c).buffer},uint8array:function(c){return b(c,new Uint8Array(c.length))},nodebuffer:function(c){return b(c,s.allocBuffer(c.length))}},m.array={string:w,array:g,arraybuffer:function(c){return new Uint8Array(c).buffer},uint8array:function(c){return new Uint8Array(c)},nodebuffer:function(c){return s.newBufferFrom(c)}},m.arraybuffer={string:function(c){return w(new Uint8Array(c))},array:function(c){return l(new Uint8Array(c),new Array(c.byteLength))},arraybuffer:g,uint8array:function(c){return new Uint8Array(c)},nodebuffer:function(c){return s.newBufferFrom(new Uint8Array(c))}},m.uint8array={string:w,array:function(c){return l(c,new Array(c.length))},arraybuffer:function(c){return c.buffer},uint8array:g,nodebuffer:function(c){return s.newBufferFrom(c)}},m.nodebuffer={string:w,array:function(c){return l(c,new Array(c.length))},arraybuffer:function(c){return m.nodebuffer.uint8array(c).buffer},uint8array:function(c){return l(c,new Uint8Array(c.length))},nodebuffer:g},a.transformTo=function(c,f){if(f=f||"",!c)return f;a.checkSupport(c);var h=a.getTypeOf(f);return m[h][c](f)},a.resolve=function(c){for(var f=c.split("/"),h=[],y=0;y<f.length;y++){var k=f[y];k==="."||k===""&&y!==0&&y!==f.length-1||(k===".."?h.pop():h.push(k))}return h.join("/")},a.getTypeOf=function(c){return typeof c=="string"?"string":Object.prototype.toString.call(c)==="[object Array]"?"array":r.nodebuffer&&s.isBuffer(c)?"nodebuffer":r.uint8array&&c instanceof Uint8Array?"uint8array":r.arraybuffer&&c instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(c){if(!r[c.toLowerCase()])throw new Error(c+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(c){var f,h,y="";for(h=0;h<(c||"").length;h++)y+="\\x"+((f=c.charCodeAt(h))<16?"0":"")+f.toString(16).toUpperCase();return y},a.delay=function(c,f,h){setImmediate(function(){c.apply(h||null,f||[])})},a.inherits=function(c,f){function h(){}h.prototype=f.prototype,c.prototype=new h},a.extend=function(){var c,f,h={};for(c=0;c<arguments.length;c++)for(f in arguments[c])Object.prototype.hasOwnProperty.call(arguments[c],f)&&h[f]===void 0&&(h[f]=arguments[c][f]);return h},a.prepareContent=function(c,f,h,y,k){return u.Promise.resolve(f).then(function(E){return r.blob&&(E instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(E))!==-1)&&typeof FileReader<"u"?new u.Promise(function(S,O){var D=new FileReader;D.onload=function(U){S(U.target.result)},D.onerror=function(U){O(U.target.error)},D.readAsArrayBuffer(E)}):E}).then(function(E){var S=a.getTypeOf(E);return S?(S==="arraybuffer"?E=a.transformTo("uint8array",E):S==="string"&&(k?E=n.decode(E):h&&y!==!0&&(E=(function(O){return b(O,r.uint8array?new Uint8Array(O.length):new Array(O.length))})(E))),E):u.Promise.reject(new Error("Can't read the data of '"+c+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,d,a){var r=t("./reader/readerFor"),n=t("./utils"),s=t("./signature"),u=t("./zipEntry"),g=t("./support");function b(v){this.files=[],this.loadOptions=v}b.prototype={checkSignature:function(v){if(!this.reader.readAndCheckSignature(v)){this.reader.index-=4;var w=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(w)+", expected "+n.pretty(v)+")")}},isSignature:function(v,w){var l=this.reader.index;this.reader.setIndex(v);var m=this.reader.readString(4)===w;return this.reader.setIndex(l),m},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var v=this.reader.readData(this.zipCommentLength),w=g.uint8array?"uint8array":"array",l=n.transformTo(w,v);this.zipComment=this.loadOptions.decodeFileName(l)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var v,w,l,m=this.zip64EndOfCentralSize-44;0<m;)v=this.reader.readInt(2),w=this.reader.readInt(4),l=this.reader.readData(w),this.zip64ExtensibleData[v]={id:v,length:w,value:l}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var v,w;for(v=0;v<this.files.length;v++)w=this.files[v],this.reader.setIndex(w.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),w.readLocalPart(this.reader),w.handleUTF8(),w.processAttributes()},readCentralDir:function(){var v;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(v=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(v);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var v=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(v<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(v);var w=v;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(v=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(v),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var l=this.centralDirOffset+this.centralDirSize;this.zip64&&(l+=20,l+=12+this.zip64EndOfCentralSize);var m=w-l;if(0<m)this.isSignature(w,s.CENTRAL_FILE_HEADER)||(this.reader.zero=m);else if(m<0)throw new Error("Corrupted zip: missing "+Math.abs(m)+" bytes.")},prepareReader:function(v){this.reader=r(v)},load:function(v){this.prepareReader(v),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},d.exports=b},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,d,a){var r=t("./reader/readerFor"),n=t("./utils"),s=t("./compressedObject"),u=t("./crc32"),g=t("./utf8"),b=t("./compressions"),v=t("./support");function w(l,m){this.options=l,this.loadOptions=m}w.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(l){var m,c;if(l.skip(22),this.fileNameLength=l.readInt(2),c=l.readInt(2),this.fileName=l.readData(this.fileNameLength),l.skip(c),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((m=(function(f){for(var h in b)if(Object.prototype.hasOwnProperty.call(b,h)&&b[h].magic===f)return b[h];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,m,l.readData(this.compressedSize))},readCentralPart:function(l){this.versionMadeBy=l.readInt(2),l.skip(2),this.bitFlag=l.readInt(2),this.compressionMethod=l.readString(2),this.date=l.readDate(),this.crc32=l.readInt(4),this.compressedSize=l.readInt(4),this.uncompressedSize=l.readInt(4);var m=l.readInt(2);if(this.extraFieldsLength=l.readInt(2),this.fileCommentLength=l.readInt(2),this.diskNumberStart=l.readInt(2),this.internalFileAttributes=l.readInt(2),this.externalFileAttributes=l.readInt(4),this.localHeaderOffset=l.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");l.skip(m),this.readExtraFields(l),this.parseZIP64ExtraField(l),this.fileComment=l.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var l=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),l==0&&(this.dosPermissions=63&this.externalFileAttributes),l==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var l=r(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=l.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=l.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=l.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=l.readInt(4))}},readExtraFields:function(l){var m,c,f,h=l.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});l.index+4<h;)m=l.readInt(2),c=l.readInt(2),f=l.readData(c),this.extraFields[m]={id:m,length:c,value:f};l.setIndex(h)},handleUTF8:function(){var l=v.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=g.utf8decode(this.fileName),this.fileCommentStr=g.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var c=n.transformTo(l,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(c)}var f=this.findExtraFieldUnicodeComment();if(f!==null)this.fileCommentStr=f;else{var h=n.transformTo(l,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(h)}}},findExtraFieldUnicodePath:function(){var l=this.extraFields[28789];if(l){var m=r(l.value);return m.readInt(1)!==1||u(this.fileName)!==m.readInt(4)?null:g.utf8decode(m.readData(l.length-5))}return null},findExtraFieldUnicodeComment:function(){var l=this.extraFields[25461];if(l){var m=r(l.value);return m.readInt(1)!==1||u(this.fileComment)!==m.readInt(4)?null:g.utf8decode(m.readData(l.length-5))}return null}},d.exports=w},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,d,a){function r(m,c,f){this.name=m,this.dir=f.dir,this.date=f.date,this.comment=f.comment,this.unixPermissions=f.unixPermissions,this.dosPermissions=f.dosPermissions,this._data=c,this._dataBinary=f.binary,this.options={compression:f.compression,compressionOptions:f.compressionOptions}}var n=t("./stream/StreamHelper"),s=t("./stream/DataWorker"),u=t("./utf8"),g=t("./compressedObject"),b=t("./stream/GenericWorker");r.prototype={internalStream:function(m){var c=null,f="string";try{if(!m)throw new Error("No output type specified.");var h=(f=m.toLowerCase())==="string"||f==="text";f!=="binarystring"&&f!=="text"||(f="string"),c=this._decompressWorker();var y=!this._dataBinary;y&&!h&&(c=c.pipe(new u.Utf8EncodeWorker)),!y&&h&&(c=c.pipe(new u.Utf8DecodeWorker))}catch(k){(c=new b("error")).error(k)}return new n(c,f,"")},async:function(m,c){return this.internalStream(m).accumulate(c)},nodeStream:function(m,c){return this.internalStream(m||"nodebuffer").toNodejsStream(c)},_compressWorker:function(m,c){if(this._data instanceof g&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var f=this._decompressWorker();return this._dataBinary||(f=f.pipe(new u.Utf8EncodeWorker)),g.createWorkerFrom(f,m,c)},_decompressWorker:function(){return this._data instanceof g?this._data.getContentWorker():this._data instanceof b?this._data:new s(this._data)}};for(var v=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],w=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},l=0;l<v.length;l++)r.prototype[v[l]]=w;d.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,d,a){(function(r){var n,s,u=r.MutationObserver||r.WebKitMutationObserver;if(u){var g=0,b=new u(m),v=r.document.createTextNode("");b.observe(v,{characterData:!0}),n=function(){v.data=g=++g%2}}else if(r.setImmediate||r.MessageChannel===void 0)n="document"in r&&"onreadystatechange"in r.document.createElement("script")?function(){var c=r.document.createElement("script");c.onreadystatechange=function(){m(),c.onreadystatechange=null,c.parentNode.removeChild(c),c=null},r.document.documentElement.appendChild(c)}:function(){setTimeout(m,0)};else{var w=new r.MessageChannel;w.port1.onmessage=m,n=function(){w.port2.postMessage(0)}}var l=[];function m(){var c,f;s=!0;for(var h=l.length;h;){for(f=l,l=[],c=-1;++c<h;)f[c]();h=l.length}s=!1}d.exports=function(c){l.push(c)!==1||s||n()}}).call(this,typeof Et<"u"?Et:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,d,a){var r=t("immediate");function n(){}var s={},u=["REJECTED"],g=["FULFILLED"],b=["PENDING"];function v(h){if(typeof h!="function")throw new TypeError("resolver must be a function");this.state=b,this.queue=[],this.outcome=void 0,h!==n&&c(this,h)}function w(h,y,k){this.promise=h,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function l(h,y,k){r(function(){var E;try{E=y(k)}catch(S){return s.reject(h,S)}E===h?s.reject(h,new TypeError("Cannot resolve promise with itself")):s.resolve(h,E)})}function m(h){var y=h&&h.then;if(h&&(typeof h=="object"||typeof h=="function")&&typeof y=="function")return function(){y.apply(h,arguments)}}function c(h,y){var k=!1;function E(D){k||(k=!0,s.reject(h,D))}function S(D){k||(k=!0,s.resolve(h,D))}var O=f(function(){y(S,E)});O.status==="error"&&E(O.value)}function f(h,y){var k={};try{k.value=h(y),k.status="success"}catch(E){k.status="error",k.value=E}return k}(d.exports=v).prototype.finally=function(h){if(typeof h!="function")return this;var y=this.constructor;return this.then(function(k){return y.resolve(h()).then(function(){return k})},function(k){return y.resolve(h()).then(function(){throw k})})},v.prototype.catch=function(h){return this.then(null,h)},v.prototype.then=function(h,y){if(typeof h!="function"&&this.state===g||typeof y!="function"&&this.state===u)return this;var k=new this.constructor(n);return this.state!==b?l(k,this.state===g?h:y,this.outcome):this.queue.push(new w(k,h,y)),k},w.prototype.callFulfilled=function(h){s.resolve(this.promise,h)},w.prototype.otherCallFulfilled=function(h){l(this.promise,this.onFulfilled,h)},w.prototype.callRejected=function(h){s.reject(this.promise,h)},w.prototype.otherCallRejected=function(h){l(this.promise,this.onRejected,h)},s.resolve=function(h,y){var k=f(m,y);if(k.status==="error")return s.reject(h,k.value);var E=k.value;if(E)c(h,E);else{h.state=g,h.outcome=y;for(var S=-1,O=h.queue.length;++S<O;)h.queue[S].callFulfilled(y)}return h},s.reject=function(h,y){h.state=u,h.outcome=y;for(var k=-1,E=h.queue.length;++k<E;)h.queue[k].callRejected(y);return h},v.resolve=function(h){return h instanceof this?h:s.resolve(new this(n),h)},v.reject=function(h){var y=new this(n);return s.reject(y,h)},v.all=function(h){var y=this;if(Object.prototype.toString.call(h)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=h.length,E=!1;if(!k)return this.resolve([]);for(var S=new Array(k),O=0,D=-1,U=new this(n);++D<k;)B(h[D],D);return U;function B(Z,V){y.resolve(Z).then(function(x){S[V]=x,++O!==k||E||(E=!0,s.resolve(U,S))},function(x){E||(E=!0,s.reject(U,x))})}},v.race=function(h){var y=this;if(Object.prototype.toString.call(h)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=h.length,E=!1;if(!k)return this.resolve([]);for(var S=-1,O=new this(n);++S<k;)D=h[S],y.resolve(D).then(function(U){E||(E=!0,s.resolve(O,U))},function(U){E||(E=!0,s.reject(O,U))});var D;return O}},{immediate:36}],38:[function(t,d,a){var r={};(0,t("./lib/utils/common").assign)(r,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),d.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,d,a){var r=t("./zlib/deflate"),n=t("./utils/common"),s=t("./utils/strings"),u=t("./zlib/messages"),g=t("./zlib/zstream"),b=Object.prototype.toString,v=0,w=-1,l=0,m=8;function c(h){if(!(this instanceof c))return new c(h);this.options=n.assign({level:w,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:l,to:""},h||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var k=r.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(k!==v)throw new Error(u[k]);if(y.header&&r.deflateSetHeader(this.strm,y.header),y.dictionary){var E;if(E=typeof y.dictionary=="string"?s.string2buf(y.dictionary):b.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(k=r.deflateSetDictionary(this.strm,E))!==v)throw new Error(u[k]);this._dict_set=!0}}function f(h,y){var k=new c(y);if(k.push(h,!0),k.err)throw k.msg||u[k.err];return k.result}c.prototype.push=function(h,y){var k,E,S=this.strm,O=this.options.chunkSize;if(this.ended)return!1;E=y===~~y?y:y===!0?4:0,typeof h=="string"?S.input=s.string2buf(h):b.call(h)==="[object ArrayBuffer]"?S.input=new Uint8Array(h):S.input=h,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new n.Buf8(O),S.next_out=0,S.avail_out=O),(k=r.deflate(S,E))!==1&&k!==v)return this.onEnd(k),!(this.ended=!0);S.avail_out!==0&&(S.avail_in!==0||E!==4&&E!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(n.shrinkBuf(S.output,S.next_out))):this.onData(n.shrinkBuf(S.output,S.next_out)))}while((0<S.avail_in||S.avail_out===0)&&k!==1);return E===4?(k=r.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===v):E!==2||(this.onEnd(v),!(S.avail_out=0))},c.prototype.onData=function(h){this.chunks.push(h)},c.prototype.onEnd=function(h){h===v&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg},a.Deflate=c,a.deflate=f,a.deflateRaw=function(h,y){return(y=y||{}).raw=!0,f(h,y)},a.gzip=function(h,y){return(y=y||{}).gzip=!0,f(h,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,d,a){var r=t("./zlib/inflate"),n=t("./utils/common"),s=t("./utils/strings"),u=t("./zlib/constants"),g=t("./zlib/messages"),b=t("./zlib/zstream"),v=t("./zlib/gzheader"),w=Object.prototype.toString;function l(c){if(!(this instanceof l))return new l(c);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},c||{});var f=this.options;f.raw&&0<=f.windowBits&&f.windowBits<16&&(f.windowBits=-f.windowBits,f.windowBits===0&&(f.windowBits=-15)),!(0<=f.windowBits&&f.windowBits<16)||c&&c.windowBits||(f.windowBits+=32),15<f.windowBits&&f.windowBits<48&&(15&f.windowBits)==0&&(f.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var h=r.inflateInit2(this.strm,f.windowBits);if(h!==u.Z_OK)throw new Error(g[h]);this.header=new v,r.inflateGetHeader(this.strm,this.header)}function m(c,f){var h=new l(f);if(h.push(c,!0),h.err)throw h.msg||g[h.err];return h.result}l.prototype.push=function(c,f){var h,y,k,E,S,O,D=this.strm,U=this.options.chunkSize,B=this.options.dictionary,Z=!1;if(this.ended)return!1;y=f===~~f?f:f===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof c=="string"?D.input=s.binstring2buf(c):w.call(c)==="[object ArrayBuffer]"?D.input=new Uint8Array(c):D.input=c,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new n.Buf8(U),D.next_out=0,D.avail_out=U),(h=r.inflate(D,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&B&&(O=typeof B=="string"?s.string2buf(B):w.call(B)==="[object ArrayBuffer]"?new Uint8Array(B):B,h=r.inflateSetDictionary(this.strm,O)),h===u.Z_BUF_ERROR&&Z===!0&&(h=u.Z_OK,Z=!1),h!==u.Z_STREAM_END&&h!==u.Z_OK)return this.onEnd(h),!(this.ended=!0);D.next_out&&(D.avail_out!==0&&h!==u.Z_STREAM_END&&(D.avail_in!==0||y!==u.Z_FINISH&&y!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=s.utf8border(D.output,D.next_out),E=D.next_out-k,S=s.buf2string(D.output,k),D.next_out=E,D.avail_out=U-E,E&&n.arraySet(D.output,D.output,k,E,0),this.onData(S)):this.onData(n.shrinkBuf(D.output,D.next_out)))),D.avail_in===0&&D.avail_out===0&&(Z=!0)}while((0<D.avail_in||D.avail_out===0)&&h!==u.Z_STREAM_END);return h===u.Z_STREAM_END&&(y=u.Z_FINISH),y===u.Z_FINISH?(h=r.inflateEnd(this.strm),this.onEnd(h),this.ended=!0,h===u.Z_OK):y!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(D.avail_out=0))},l.prototype.onData=function(c){this.chunks.push(c)},l.prototype.onEnd=function(c){c===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=c,this.msg=this.strm.msg},a.Inflate=l,a.inflate=m,a.inflateRaw=function(c,f){return(f=f||{}).raw=!0,m(c,f)},a.ungzip=m},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,d,a){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(u){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var b=g.shift();if(b){if(typeof b!="object")throw new TypeError(b+"must be non-object");for(var v in b)b.hasOwnProperty(v)&&(u[v]=b[v])}}return u},a.shrinkBuf=function(u,g){return u.length===g?u:u.subarray?u.subarray(0,g):(u.length=g,u)};var n={arraySet:function(u,g,b,v,w){if(g.subarray&&u.subarray)u.set(g.subarray(b,b+v),w);else for(var l=0;l<v;l++)u[w+l]=g[b+l]},flattenChunks:function(u){var g,b,v,w,l,m;for(g=v=0,b=u.length;g<b;g++)v+=u[g].length;for(m=new Uint8Array(v),g=w=0,b=u.length;g<b;g++)l=u[g],m.set(l,w),w+=l.length;return m}},s={arraySet:function(u,g,b,v,w){for(var l=0;l<v;l++)u[w+l]=g[b+l]},flattenChunks:function(u){return[].concat.apply([],u)}};a.setTyped=function(u){u?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,n)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,s))},a.setTyped(r)},{}],42:[function(t,d,a){var r=t("./common"),n=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var u=new r.Buf8(256),g=0;g<256;g++)u[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;function b(v,w){if(w<65537&&(v.subarray&&s||!v.subarray&&n))return String.fromCharCode.apply(null,r.shrinkBuf(v,w));for(var l="",m=0;m<w;m++)l+=String.fromCharCode(v[m]);return l}u[254]=u[254]=1,a.string2buf=function(v){var w,l,m,c,f,h=v.length,y=0;for(c=0;c<h;c++)(64512&(l=v.charCodeAt(c)))==55296&&c+1<h&&(64512&(m=v.charCodeAt(c+1)))==56320&&(l=65536+(l-55296<<10)+(m-56320),c++),y+=l<128?1:l<2048?2:l<65536?3:4;for(w=new r.Buf8(y),c=f=0;f<y;c++)(64512&(l=v.charCodeAt(c)))==55296&&c+1<h&&(64512&(m=v.charCodeAt(c+1)))==56320&&(l=65536+(l-55296<<10)+(m-56320),c++),l<128?w[f++]=l:(l<2048?w[f++]=192|l>>>6:(l<65536?w[f++]=224|l>>>12:(w[f++]=240|l>>>18,w[f++]=128|l>>>12&63),w[f++]=128|l>>>6&63),w[f++]=128|63&l);return w},a.buf2binstring=function(v){return b(v,v.length)},a.binstring2buf=function(v){for(var w=new r.Buf8(v.length),l=0,m=w.length;l<m;l++)w[l]=v.charCodeAt(l);return w},a.buf2string=function(v,w){var l,m,c,f,h=w||v.length,y=new Array(2*h);for(l=m=0;l<h;)if((c=v[l++])<128)y[m++]=c;else if(4<(f=u[c]))y[m++]=65533,l+=f-1;else{for(c&=f===2?31:f===3?15:7;1<f&&l<h;)c=c<<6|63&v[l++],f--;1<f?y[m++]=65533:c<65536?y[m++]=c:(c-=65536,y[m++]=55296|c>>10&1023,y[m++]=56320|1023&c)}return b(y,m)},a.utf8border=function(v,w){var l;for((w=w||v.length)>v.length&&(w=v.length),l=w-1;0<=l&&(192&v[l])==128;)l--;return l<0||l===0?w:l+u[v[l]]>w?l:w}},{"./common":41}],43:[function(t,d,a){d.exports=function(r,n,s,u){for(var g=65535&r|0,b=r>>>16&65535|0,v=0;s!==0;){for(s-=v=2e3<s?2e3:s;b=b+(g=g+n[u++]|0)|0,--v;);g%=65521,b%=65521}return g|b<<16|0}},{}],44:[function(t,d,a){d.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,d,a){var r=(function(){for(var n,s=[],u=0;u<256;u++){n=u;for(var g=0;g<8;g++)n=1&n?3988292384^n>>>1:n>>>1;s[u]=n}return s})();d.exports=function(n,s,u,g){var b=r,v=g+u;n^=-1;for(var w=g;w<v;w++)n=n>>>8^b[255&(n^s[w])];return-1^n}},{}],46:[function(t,d,a){var r,n=t("../utils/common"),s=t("./trees"),u=t("./adler32"),g=t("./crc32"),b=t("./messages"),v=0,w=4,l=0,m=-2,c=-1,f=4,h=2,y=8,k=9,E=286,S=30,O=19,D=2*E+1,U=15,B=3,Z=258,V=Z+B+1,x=42,R=113,o=1,P=2,Q=3,W=4;function tt(e,F){return e.msg=b[F],F}function M(e){return(e<<1)-(4<e?9:0)}function J(e){for(var F=e.length;0<=--F;)e[F]=0}function A(e){var F=e.state,T=F.pending;T>e.avail_out&&(T=e.avail_out),T!==0&&(n.arraySet(e.output,F.pending_buf,F.pending_out,T,e.next_out),e.next_out+=T,F.pending_out+=T,e.total_out+=T,e.avail_out-=T,F.pending-=T,F.pending===0&&(F.pending_out=0))}function I(e,F){s._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,F),e.block_start=e.strstart,A(e.strm)}function K(e,F){e.pending_buf[e.pending++]=F}function G(e,F){e.pending_buf[e.pending++]=F>>>8&255,e.pending_buf[e.pending++]=255&F}function H(e,F){var T,_,p=e.max_chain_length,C=e.strstart,L=e.prev_length,N=e.nice_match,z=e.strstart>e.w_size-V?e.strstart-(e.w_size-V):0,$=e.window,q=e.w_mask,X=e.prev,Y=e.strstart+Z,st=$[C+L-1],nt=$[C+L];e.prev_length>=e.good_match&&(p>>=2),N>e.lookahead&&(N=e.lookahead);do if($[(T=F)+L]===nt&&$[T+L-1]===st&&$[T]===$[C]&&$[++T]===$[C+1]){C+=2,T++;do;while($[++C]===$[++T]&&$[++C]===$[++T]&&$[++C]===$[++T]&&$[++C]===$[++T]&&$[++C]===$[++T]&&$[++C]===$[++T]&&$[++C]===$[++T]&&$[++C]===$[++T]&&C<Y);if(_=Z-(Y-C),C=Y-Z,L<_){if(e.match_start=F,N<=(L=_))break;st=$[C+L-1],nt=$[C+L]}}while((F=X[F&q])>z&&--p!=0);return L<=e.lookahead?L:e.lookahead}function at(e){var F,T,_,p,C,L,N,z,$,q,X=e.w_size;do{if(p=e.window_size-e.lookahead-e.strstart,e.strstart>=X+(X-V)){for(n.arraySet(e.window,e.window,X,X,0),e.match_start-=X,e.strstart-=X,e.block_start-=X,F=T=e.hash_size;_=e.head[--F],e.head[F]=X<=_?_-X:0,--T;);for(F=T=X;_=e.prev[--F],e.prev[F]=X<=_?_-X:0,--T;);p+=X}if(e.strm.avail_in===0)break;if(L=e.strm,N=e.window,z=e.strstart+e.lookahead,$=p,q=void 0,q=L.avail_in,$<q&&(q=$),T=q===0?0:(L.avail_in-=q,n.arraySet(N,L.input,L.next_in,q,z),L.state.wrap===1?L.adler=u(L.adler,N,q,z):L.state.wrap===2&&(L.adler=g(L.adler,N,q,z)),L.next_in+=q,L.total_in+=q,q),e.lookahead+=T,e.lookahead+e.insert>=B)for(C=e.strstart-e.insert,e.ins_h=e.window[C],e.ins_h=(e.ins_h<<e.hash_shift^e.window[C+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[C+B-1])&e.hash_mask,e.prev[C&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=C,C++,e.insert--,!(e.lookahead+e.insert<B)););}while(e.lookahead<V&&e.strm.avail_in!==0)}function ct(e,F){for(var T,_;;){if(e.lookahead<V){if(at(e),e.lookahead<V&&F===v)return o;if(e.lookahead===0)break}if(T=0,e.lookahead>=B&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+B-1])&e.hash_mask,T=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),T!==0&&e.strstart-T<=e.w_size-V&&(e.match_length=H(e,T)),e.match_length>=B)if(_=s._tr_tally(e,e.strstart-e.match_start,e.match_length-B),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=B){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+B-1])&e.hash_mask,T=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,--e.match_length!=0;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else _=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(_&&(I(e,!1),e.strm.avail_out===0))return o}return e.insert=e.strstart<B-1?e.strstart:B-1,F===w?(I(e,!0),e.strm.avail_out===0?Q:W):e.last_lit&&(I(e,!1),e.strm.avail_out===0)?o:P}function rt(e,F){for(var T,_,p;;){if(e.lookahead<V){if(at(e),e.lookahead<V&&F===v)return o;if(e.lookahead===0)break}if(T=0,e.lookahead>=B&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+B-1])&e.hash_mask,T=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=B-1,T!==0&&e.prev_length<e.max_lazy_match&&e.strstart-T<=e.w_size-V&&(e.match_length=H(e,T),e.match_length<=5&&(e.strategy===1||e.match_length===B&&4096<e.strstart-e.match_start)&&(e.match_length=B-1)),e.prev_length>=B&&e.match_length<=e.prev_length){for(p=e.strstart+e.lookahead-B,_=s._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-B),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=p&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+B-1])&e.hash_mask,T=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),--e.prev_length!=0;);if(e.match_available=0,e.match_length=B-1,e.strstart++,_&&(I(e,!1),e.strm.avail_out===0))return o}else if(e.match_available){if((_=s._tr_tally(e,0,e.window[e.strstart-1]))&&I(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return o}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(_=s._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<B-1?e.strstart:B-1,F===w?(I(e,!0),e.strm.avail_out===0?Q:W):e.last_lit&&(I(e,!1),e.strm.avail_out===0)?o:P}function it(e,F,T,_,p){this.good_length=e,this.max_lazy=F,this.nice_length=T,this.max_chain=_,this.func=p}function ut(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*D),this.dyn_dtree=new n.Buf16(2*(2*S+1)),this.bl_tree=new n.Buf16(2*(2*O+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(U+1),this.heap=new n.Buf16(2*E+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*E+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ot(e){var F;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=h,(F=e.state).pending=0,F.pending_out=0,F.wrap<0&&(F.wrap=-F.wrap),F.status=F.wrap?x:R,e.adler=F.wrap===2?0:1,F.last_flush=v,s._tr_init(F),l):tt(e,m)}function pt(e){var F=ot(e);return F===l&&(function(T){T.window_size=2*T.w_size,J(T.head),T.max_lazy_match=r[T.level].max_lazy,T.good_match=r[T.level].good_length,T.nice_match=r[T.level].nice_length,T.max_chain_length=r[T.level].max_chain,T.strstart=0,T.block_start=0,T.lookahead=0,T.insert=0,T.match_length=T.prev_length=B-1,T.match_available=0,T.ins_h=0})(e.state),F}function ft(e,F,T,_,p,C){if(!e)return m;var L=1;if(F===c&&(F=6),_<0?(L=0,_=-_):15<_&&(L=2,_-=16),p<1||k<p||T!==y||_<8||15<_||F<0||9<F||C<0||f<C)return tt(e,m);_===8&&(_=9);var N=new ut;return(e.state=N).strm=e,N.wrap=L,N.gzhead=null,N.w_bits=_,N.w_size=1<<N.w_bits,N.w_mask=N.w_size-1,N.hash_bits=p+7,N.hash_size=1<<N.hash_bits,N.hash_mask=N.hash_size-1,N.hash_shift=~~((N.hash_bits+B-1)/B),N.window=new n.Buf8(2*N.w_size),N.head=new n.Buf16(N.hash_size),N.prev=new n.Buf16(N.w_size),N.lit_bufsize=1<<p+6,N.pending_buf_size=4*N.lit_bufsize,N.pending_buf=new n.Buf8(N.pending_buf_size),N.d_buf=1*N.lit_bufsize,N.l_buf=3*N.lit_bufsize,N.level=F,N.strategy=C,N.method=T,pt(e)}r=[new it(0,0,0,0,function(e,F){var T=65535;for(T>e.pending_buf_size-5&&(T=e.pending_buf_size-5);;){if(e.lookahead<=1){if(at(e),e.lookahead===0&&F===v)return o;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var _=e.block_start+T;if((e.strstart===0||e.strstart>=_)&&(e.lookahead=e.strstart-_,e.strstart=_,I(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-V&&(I(e,!1),e.strm.avail_out===0))return o}return e.insert=0,F===w?(I(e,!0),e.strm.avail_out===0?Q:W):(e.strstart>e.block_start&&(I(e,!1),e.strm.avail_out),o)}),new it(4,4,8,4,ct),new it(4,5,16,8,ct),new it(4,6,32,32,ct),new it(4,4,16,16,rt),new it(8,16,32,32,rt),new it(8,16,128,128,rt),new it(8,32,128,256,rt),new it(32,128,258,1024,rt),new it(32,258,258,4096,rt)],a.deflateInit=function(e,F){return ft(e,F,y,15,8,0)},a.deflateInit2=ft,a.deflateReset=pt,a.deflateResetKeep=ot,a.deflateSetHeader=function(e,F){return e&&e.state?e.state.wrap!==2?m:(e.state.gzhead=F,l):m},a.deflate=function(e,F){var T,_,p,C;if(!e||!e.state||5<F||F<0)return e?tt(e,m):m;if(_=e.state,!e.output||!e.input&&e.avail_in!==0||_.status===666&&F!==w)return tt(e,e.avail_out===0?-5:m);if(_.strm=e,T=_.last_flush,_.last_flush=F,_.status===x)if(_.wrap===2)e.adler=0,K(_,31),K(_,139),K(_,8),_.gzhead?(K(_,(_.gzhead.text?1:0)+(_.gzhead.hcrc?2:0)+(_.gzhead.extra?4:0)+(_.gzhead.name?8:0)+(_.gzhead.comment?16:0)),K(_,255&_.gzhead.time),K(_,_.gzhead.time>>8&255),K(_,_.gzhead.time>>16&255),K(_,_.gzhead.time>>24&255),K(_,_.level===9?2:2<=_.strategy||_.level<2?4:0),K(_,255&_.gzhead.os),_.gzhead.extra&&_.gzhead.extra.length&&(K(_,255&_.gzhead.extra.length),K(_,_.gzhead.extra.length>>8&255)),_.gzhead.hcrc&&(e.adler=g(e.adler,_.pending_buf,_.pending,0)),_.gzindex=0,_.status=69):(K(_,0),K(_,0),K(_,0),K(_,0),K(_,0),K(_,_.level===9?2:2<=_.strategy||_.level<2?4:0),K(_,3),_.status=R);else{var L=y+(_.w_bits-8<<4)<<8;L|=(2<=_.strategy||_.level<2?0:_.level<6?1:_.level===6?2:3)<<6,_.strstart!==0&&(L|=32),L+=31-L%31,_.status=R,G(_,L),_.strstart!==0&&(G(_,e.adler>>>16),G(_,65535&e.adler)),e.adler=1}if(_.status===69)if(_.gzhead.extra){for(p=_.pending;_.gzindex<(65535&_.gzhead.extra.length)&&(_.pending!==_.pending_buf_size||(_.gzhead.hcrc&&_.pending>p&&(e.adler=g(e.adler,_.pending_buf,_.pending-p,p)),A(e),p=_.pending,_.pending!==_.pending_buf_size));)K(_,255&_.gzhead.extra[_.gzindex]),_.gzindex++;_.gzhead.hcrc&&_.pending>p&&(e.adler=g(e.adler,_.pending_buf,_.pending-p,p)),_.gzindex===_.gzhead.extra.length&&(_.gzindex=0,_.status=73)}else _.status=73;if(_.status===73)if(_.gzhead.name){p=_.pending;do{if(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>p&&(e.adler=g(e.adler,_.pending_buf,_.pending-p,p)),A(e),p=_.pending,_.pending===_.pending_buf_size)){C=1;break}C=_.gzindex<_.gzhead.name.length?255&_.gzhead.name.charCodeAt(_.gzindex++):0,K(_,C)}while(C!==0);_.gzhead.hcrc&&_.pending>p&&(e.adler=g(e.adler,_.pending_buf,_.pending-p,p)),C===0&&(_.gzindex=0,_.status=91)}else _.status=91;if(_.status===91)if(_.gzhead.comment){p=_.pending;do{if(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>p&&(e.adler=g(e.adler,_.pending_buf,_.pending-p,p)),A(e),p=_.pending,_.pending===_.pending_buf_size)){C=1;break}C=_.gzindex<_.gzhead.comment.length?255&_.gzhead.comment.charCodeAt(_.gzindex++):0,K(_,C)}while(C!==0);_.gzhead.hcrc&&_.pending>p&&(e.adler=g(e.adler,_.pending_buf,_.pending-p,p)),C===0&&(_.status=103)}else _.status=103;if(_.status===103&&(_.gzhead.hcrc?(_.pending+2>_.pending_buf_size&&A(e),_.pending+2<=_.pending_buf_size&&(K(_,255&e.adler),K(_,e.adler>>8&255),e.adler=0,_.status=R)):_.status=R),_.pending!==0){if(A(e),e.avail_out===0)return _.last_flush=-1,l}else if(e.avail_in===0&&M(F)<=M(T)&&F!==w)return tt(e,-5);if(_.status===666&&e.avail_in!==0)return tt(e,-5);if(e.avail_in!==0||_.lookahead!==0||F!==v&&_.status!==666){var N=_.strategy===2?(function(z,$){for(var q;;){if(z.lookahead===0&&(at(z),z.lookahead===0)){if($===v)return o;break}if(z.match_length=0,q=s._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,q&&(I(z,!1),z.strm.avail_out===0))return o}return z.insert=0,$===w?(I(z,!0),z.strm.avail_out===0?Q:W):z.last_lit&&(I(z,!1),z.strm.avail_out===0)?o:P})(_,F):_.strategy===3?(function(z,$){for(var q,X,Y,st,nt=z.window;;){if(z.lookahead<=Z){if(at(z),z.lookahead<=Z&&$===v)return o;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=B&&0<z.strstart&&(X=nt[Y=z.strstart-1])===nt[++Y]&&X===nt[++Y]&&X===nt[++Y]){st=z.strstart+Z;do;while(X===nt[++Y]&&X===nt[++Y]&&X===nt[++Y]&&X===nt[++Y]&&X===nt[++Y]&&X===nt[++Y]&&X===nt[++Y]&&X===nt[++Y]&&Y<st);z.match_length=Z-(st-Y),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=B?(q=s._tr_tally(z,1,z.match_length-B),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(q=s._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),q&&(I(z,!1),z.strm.avail_out===0))return o}return z.insert=0,$===w?(I(z,!0),z.strm.avail_out===0?Q:W):z.last_lit&&(I(z,!1),z.strm.avail_out===0)?o:P})(_,F):r[_.level].func(_,F);if(N!==Q&&N!==W||(_.status=666),N===o||N===Q)return e.avail_out===0&&(_.last_flush=-1),l;if(N===P&&(F===1?s._tr_align(_):F!==5&&(s._tr_stored_block(_,0,0,!1),F===3&&(J(_.head),_.lookahead===0&&(_.strstart=0,_.block_start=0,_.insert=0))),A(e),e.avail_out===0))return _.last_flush=-1,l}return F!==w?l:_.wrap<=0?1:(_.wrap===2?(K(_,255&e.adler),K(_,e.adler>>8&255),K(_,e.adler>>16&255),K(_,e.adler>>24&255),K(_,255&e.total_in),K(_,e.total_in>>8&255),K(_,e.total_in>>16&255),K(_,e.total_in>>24&255)):(G(_,e.adler>>>16),G(_,65535&e.adler)),A(e),0<_.wrap&&(_.wrap=-_.wrap),_.pending!==0?l:1)},a.deflateEnd=function(e){var F;return e&&e.state?(F=e.state.status)!==x&&F!==69&&F!==73&&F!==91&&F!==103&&F!==R&&F!==666?tt(e,m):(e.state=null,F===R?tt(e,-3):l):m},a.deflateSetDictionary=function(e,F){var T,_,p,C,L,N,z,$,q=F.length;if(!e||!e.state||(C=(T=e.state).wrap)===2||C===1&&T.status!==x||T.lookahead)return m;for(C===1&&(e.adler=u(e.adler,F,q,0)),T.wrap=0,q>=T.w_size&&(C===0&&(J(T.head),T.strstart=0,T.block_start=0,T.insert=0),$=new n.Buf8(T.w_size),n.arraySet($,F,q-T.w_size,T.w_size,0),F=$,q=T.w_size),L=e.avail_in,N=e.next_in,z=e.input,e.avail_in=q,e.next_in=0,e.input=F,at(T);T.lookahead>=B;){for(_=T.strstart,p=T.lookahead-(B-1);T.ins_h=(T.ins_h<<T.hash_shift^T.window[_+B-1])&T.hash_mask,T.prev[_&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=_,_++,--p;);T.strstart=_,T.lookahead=B-1,at(T)}return T.strstart+=T.lookahead,T.block_start=T.strstart,T.insert=T.lookahead,T.lookahead=0,T.match_length=T.prev_length=B-1,T.match_available=0,e.next_in=N,e.input=z,e.avail_in=L,T.wrap=C,l},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,d,a){d.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,d,a){d.exports=function(r,n){var s,u,g,b,v,w,l,m,c,f,h,y,k,E,S,O,D,U,B,Z,V,x,R,o,P;s=r.state,u=r.next_in,o=r.input,g=u+(r.avail_in-5),b=r.next_out,P=r.output,v=b-(n-r.avail_out),w=b+(r.avail_out-257),l=s.dmax,m=s.wsize,c=s.whave,f=s.wnext,h=s.window,y=s.hold,k=s.bits,E=s.lencode,S=s.distcode,O=(1<<s.lenbits)-1,D=(1<<s.distbits)-1;t:do{k<15&&(y+=o[u++]<<k,k+=8,y+=o[u++]<<k,k+=8),U=E[y&O];e:for(;;){if(y>>>=B=U>>>24,k-=B,(B=U>>>16&255)===0)P[b++]=65535&U;else{if(!(16&B)){if((64&B)==0){U=E[(65535&U)+(y&(1<<B)-1)];continue e}if(32&B){s.mode=12;break t}r.msg="invalid literal/length code",s.mode=30;break t}Z=65535&U,(B&=15)&&(k<B&&(y+=o[u++]<<k,k+=8),Z+=y&(1<<B)-1,y>>>=B,k-=B),k<15&&(y+=o[u++]<<k,k+=8,y+=o[u++]<<k,k+=8),U=S[y&D];r:for(;;){if(y>>>=B=U>>>24,k-=B,!(16&(B=U>>>16&255))){if((64&B)==0){U=S[(65535&U)+(y&(1<<B)-1)];continue r}r.msg="invalid distance code",s.mode=30;break t}if(V=65535&U,k<(B&=15)&&(y+=o[u++]<<k,(k+=8)<B&&(y+=o[u++]<<k,k+=8)),l<(V+=y&(1<<B)-1)){r.msg="invalid distance too far back",s.mode=30;break t}if(y>>>=B,k-=B,(B=b-v)<V){if(c<(B=V-B)&&s.sane){r.msg="invalid distance too far back",s.mode=30;break t}if(R=h,(x=0)===f){if(x+=m-B,B<Z){for(Z-=B;P[b++]=h[x++],--B;);x=b-V,R=P}}else if(f<B){if(x+=m+f-B,(B-=f)<Z){for(Z-=B;P[b++]=h[x++],--B;);if(x=0,f<Z){for(Z-=B=f;P[b++]=h[x++],--B;);x=b-V,R=P}}}else if(x+=f-B,B<Z){for(Z-=B;P[b++]=h[x++],--B;);x=b-V,R=P}for(;2<Z;)P[b++]=R[x++],P[b++]=R[x++],P[b++]=R[x++],Z-=3;Z&&(P[b++]=R[x++],1<Z&&(P[b++]=R[x++]))}else{for(x=b-V;P[b++]=P[x++],P[b++]=P[x++],P[b++]=P[x++],2<(Z-=3););Z&&(P[b++]=P[x++],1<Z&&(P[b++]=P[x++]))}break}}break}}while(u<g&&b<w);u-=Z=k>>3,y&=(1<<(k-=Z<<3))-1,r.next_in=u,r.next_out=b,r.avail_in=u<g?g-u+5:5-(u-g),r.avail_out=b<w?w-b+257:257-(b-w),s.hold=y,s.bits=k}},{}],49:[function(t,d,a){var r=t("../utils/common"),n=t("./adler32"),s=t("./crc32"),u=t("./inffast"),g=t("./inftrees"),b=1,v=2,w=0,l=-2,m=1,c=852,f=592;function h(x){return(x>>>24&255)+(x>>>8&65280)+((65280&x)<<8)+((255&x)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(x){var R;return x&&x.state?(R=x.state,x.total_in=x.total_out=R.total=0,x.msg="",R.wrap&&(x.adler=1&R.wrap),R.mode=m,R.last=0,R.havedict=0,R.dmax=32768,R.head=null,R.hold=0,R.bits=0,R.lencode=R.lendyn=new r.Buf32(c),R.distcode=R.distdyn=new r.Buf32(f),R.sane=1,R.back=-1,w):l}function E(x){var R;return x&&x.state?((R=x.state).wsize=0,R.whave=0,R.wnext=0,k(x)):l}function S(x,R){var o,P;return x&&x.state?(P=x.state,R<0?(o=0,R=-R):(o=1+(R>>4),R<48&&(R&=15)),R&&(R<8||15<R)?l:(P.window!==null&&P.wbits!==R&&(P.window=null),P.wrap=o,P.wbits=R,E(x))):l}function O(x,R){var o,P;return x?(P=new y,(x.state=P).window=null,(o=S(x,R))!==w&&(x.state=null),o):l}var D,U,B=!0;function Z(x){if(B){var R;for(D=new r.Buf32(512),U=new r.Buf32(32),R=0;R<144;)x.lens[R++]=8;for(;R<256;)x.lens[R++]=9;for(;R<280;)x.lens[R++]=7;for(;R<288;)x.lens[R++]=8;for(g(b,x.lens,0,288,D,0,x.work,{bits:9}),R=0;R<32;)x.lens[R++]=5;g(v,x.lens,0,32,U,0,x.work,{bits:5}),B=!1}x.lencode=D,x.lenbits=9,x.distcode=U,x.distbits=5}function V(x,R,o,P){var Q,W=x.state;return W.window===null&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new r.Buf8(W.wsize)),P>=W.wsize?(r.arraySet(W.window,R,o-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(P<(Q=W.wsize-W.wnext)&&(Q=P),r.arraySet(W.window,R,o-P,Q,W.wnext),(P-=Q)?(r.arraySet(W.window,R,o-P,P,0),W.wnext=P,W.whave=W.wsize):(W.wnext+=Q,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=Q))),0}a.inflateReset=E,a.inflateReset2=S,a.inflateResetKeep=k,a.inflateInit=function(x){return O(x,15)},a.inflateInit2=O,a.inflate=function(x,R){var o,P,Q,W,tt,M,J,A,I,K,G,H,at,ct,rt,it,ut,ot,pt,ft,e,F,T,_,p=0,C=new r.Buf8(4),L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!x||!x.state||!x.output||!x.input&&x.avail_in!==0)return l;(o=x.state).mode===12&&(o.mode=13),tt=x.next_out,Q=x.output,J=x.avail_out,W=x.next_in,P=x.input,M=x.avail_in,A=o.hold,I=o.bits,K=M,G=J,F=w;t:for(;;)switch(o.mode){case m:if(o.wrap===0){o.mode=13;break}for(;I<16;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if(2&o.wrap&&A===35615){C[o.check=0]=255&A,C[1]=A>>>8&255,o.check=s(o.check,C,2,0),I=A=0,o.mode=2;break}if(o.flags=0,o.head&&(o.head.done=!1),!(1&o.wrap)||(((255&A)<<8)+(A>>8))%31){x.msg="incorrect header check",o.mode=30;break}if((15&A)!=8){x.msg="unknown compression method",o.mode=30;break}if(I-=4,e=8+(15&(A>>>=4)),o.wbits===0)o.wbits=e;else if(e>o.wbits){x.msg="invalid window size",o.mode=30;break}o.dmax=1<<e,x.adler=o.check=1,o.mode=512&A?10:12,I=A=0;break;case 2:for(;I<16;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if(o.flags=A,(255&o.flags)!=8){x.msg="unknown compression method",o.mode=30;break}if(57344&o.flags){x.msg="unknown header flags set",o.mode=30;break}o.head&&(o.head.text=A>>8&1),512&o.flags&&(C[0]=255&A,C[1]=A>>>8&255,o.check=s(o.check,C,2,0)),I=A=0,o.mode=3;case 3:for(;I<32;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}o.head&&(o.head.time=A),512&o.flags&&(C[0]=255&A,C[1]=A>>>8&255,C[2]=A>>>16&255,C[3]=A>>>24&255,o.check=s(o.check,C,4,0)),I=A=0,o.mode=4;case 4:for(;I<16;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}o.head&&(o.head.xflags=255&A,o.head.os=A>>8),512&o.flags&&(C[0]=255&A,C[1]=A>>>8&255,o.check=s(o.check,C,2,0)),I=A=0,o.mode=5;case 5:if(1024&o.flags){for(;I<16;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}o.length=A,o.head&&(o.head.extra_len=A),512&o.flags&&(C[0]=255&A,C[1]=A>>>8&255,o.check=s(o.check,C,2,0)),I=A=0}else o.head&&(o.head.extra=null);o.mode=6;case 6:if(1024&o.flags&&(M<(H=o.length)&&(H=M),H&&(o.head&&(e=o.head.extra_len-o.length,o.head.extra||(o.head.extra=new Array(o.head.extra_len)),r.arraySet(o.head.extra,P,W,H,e)),512&o.flags&&(o.check=s(o.check,P,H,W)),M-=H,W+=H,o.length-=H),o.length))break t;o.length=0,o.mode=7;case 7:if(2048&o.flags){if(M===0)break t;for(H=0;e=P[W+H++],o.head&&e&&o.length<65536&&(o.head.name+=String.fromCharCode(e)),e&&H<M;);if(512&o.flags&&(o.check=s(o.check,P,H,W)),M-=H,W+=H,e)break t}else o.head&&(o.head.name=null);o.length=0,o.mode=8;case 8:if(4096&o.flags){if(M===0)break t;for(H=0;e=P[W+H++],o.head&&e&&o.length<65536&&(o.head.comment+=String.fromCharCode(e)),e&&H<M;);if(512&o.flags&&(o.check=s(o.check,P,H,W)),M-=H,W+=H,e)break t}else o.head&&(o.head.comment=null);o.mode=9;case 9:if(512&o.flags){for(;I<16;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if(A!==(65535&o.check)){x.msg="header crc mismatch",o.mode=30;break}I=A=0}o.head&&(o.head.hcrc=o.flags>>9&1,o.head.done=!0),x.adler=o.check=0,o.mode=12;break;case 10:for(;I<32;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}x.adler=o.check=h(A),I=A=0,o.mode=11;case 11:if(o.havedict===0)return x.next_out=tt,x.avail_out=J,x.next_in=W,x.avail_in=M,o.hold=A,o.bits=I,2;x.adler=o.check=1,o.mode=12;case 12:if(R===5||R===6)break t;case 13:if(o.last){A>>>=7&I,I-=7&I,o.mode=27;break}for(;I<3;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}switch(o.last=1&A,I-=1,3&(A>>>=1)){case 0:o.mode=14;break;case 1:if(Z(o),o.mode=20,R!==6)break;A>>>=2,I-=2;break t;case 2:o.mode=17;break;case 3:x.msg="invalid block type",o.mode=30}A>>>=2,I-=2;break;case 14:for(A>>>=7&I,I-=7&I;I<32;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if((65535&A)!=(A>>>16^65535)){x.msg="invalid stored block lengths",o.mode=30;break}if(o.length=65535&A,I=A=0,o.mode=15,R===6)break t;case 15:o.mode=16;case 16:if(H=o.length){if(M<H&&(H=M),J<H&&(H=J),H===0)break t;r.arraySet(Q,P,W,H,tt),M-=H,W+=H,J-=H,tt+=H,o.length-=H;break}o.mode=12;break;case 17:for(;I<14;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if(o.nlen=257+(31&A),A>>>=5,I-=5,o.ndist=1+(31&A),A>>>=5,I-=5,o.ncode=4+(15&A),A>>>=4,I-=4,286<o.nlen||30<o.ndist){x.msg="too many length or distance symbols",o.mode=30;break}o.have=0,o.mode=18;case 18:for(;o.have<o.ncode;){for(;I<3;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}o.lens[L[o.have++]]=7&A,A>>>=3,I-=3}for(;o.have<19;)o.lens[L[o.have++]]=0;if(o.lencode=o.lendyn,o.lenbits=7,T={bits:o.lenbits},F=g(0,o.lens,0,19,o.lencode,0,o.work,T),o.lenbits=T.bits,F){x.msg="invalid code lengths set",o.mode=30;break}o.have=0,o.mode=19;case 19:for(;o.have<o.nlen+o.ndist;){for(;it=(p=o.lencode[A&(1<<o.lenbits)-1])>>>16&255,ut=65535&p,!((rt=p>>>24)<=I);){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if(ut<16)A>>>=rt,I-=rt,o.lens[o.have++]=ut;else{if(ut===16){for(_=rt+2;I<_;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if(A>>>=rt,I-=rt,o.have===0){x.msg="invalid bit length repeat",o.mode=30;break}e=o.lens[o.have-1],H=3+(3&A),A>>>=2,I-=2}else if(ut===17){for(_=rt+3;I<_;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}I-=rt,e=0,H=3+(7&(A>>>=rt)),A>>>=3,I-=3}else{for(_=rt+7;I<_;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}I-=rt,e=0,H=11+(127&(A>>>=rt)),A>>>=7,I-=7}if(o.have+H>o.nlen+o.ndist){x.msg="invalid bit length repeat",o.mode=30;break}for(;H--;)o.lens[o.have++]=e}}if(o.mode===30)break;if(o.lens[256]===0){x.msg="invalid code -- missing end-of-block",o.mode=30;break}if(o.lenbits=9,T={bits:o.lenbits},F=g(b,o.lens,0,o.nlen,o.lencode,0,o.work,T),o.lenbits=T.bits,F){x.msg="invalid literal/lengths set",o.mode=30;break}if(o.distbits=6,o.distcode=o.distdyn,T={bits:o.distbits},F=g(v,o.lens,o.nlen,o.ndist,o.distcode,0,o.work,T),o.distbits=T.bits,F){x.msg="invalid distances set",o.mode=30;break}if(o.mode=20,R===6)break t;case 20:o.mode=21;case 21:if(6<=M&&258<=J){x.next_out=tt,x.avail_out=J,x.next_in=W,x.avail_in=M,o.hold=A,o.bits=I,u(x,G),tt=x.next_out,Q=x.output,J=x.avail_out,W=x.next_in,P=x.input,M=x.avail_in,A=o.hold,I=o.bits,o.mode===12&&(o.back=-1);break}for(o.back=0;it=(p=o.lencode[A&(1<<o.lenbits)-1])>>>16&255,ut=65535&p,!((rt=p>>>24)<=I);){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if(it&&(240&it)==0){for(ot=rt,pt=it,ft=ut;it=(p=o.lencode[ft+((A&(1<<ot+pt)-1)>>ot)])>>>16&255,ut=65535&p,!(ot+(rt=p>>>24)<=I);){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}A>>>=ot,I-=ot,o.back+=ot}if(A>>>=rt,I-=rt,o.back+=rt,o.length=ut,it===0){o.mode=26;break}if(32&it){o.back=-1,o.mode=12;break}if(64&it){x.msg="invalid literal/length code",o.mode=30;break}o.extra=15&it,o.mode=22;case 22:if(o.extra){for(_=o.extra;I<_;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}o.length+=A&(1<<o.extra)-1,A>>>=o.extra,I-=o.extra,o.back+=o.extra}o.was=o.length,o.mode=23;case 23:for(;it=(p=o.distcode[A&(1<<o.distbits)-1])>>>16&255,ut=65535&p,!((rt=p>>>24)<=I);){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if((240&it)==0){for(ot=rt,pt=it,ft=ut;it=(p=o.distcode[ft+((A&(1<<ot+pt)-1)>>ot)])>>>16&255,ut=65535&p,!(ot+(rt=p>>>24)<=I);){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}A>>>=ot,I-=ot,o.back+=ot}if(A>>>=rt,I-=rt,o.back+=rt,64&it){x.msg="invalid distance code",o.mode=30;break}o.offset=ut,o.extra=15&it,o.mode=24;case 24:if(o.extra){for(_=o.extra;I<_;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}o.offset+=A&(1<<o.extra)-1,A>>>=o.extra,I-=o.extra,o.back+=o.extra}if(o.offset>o.dmax){x.msg="invalid distance too far back",o.mode=30;break}o.mode=25;case 25:if(J===0)break t;if(H=G-J,o.offset>H){if((H=o.offset-H)>o.whave&&o.sane){x.msg="invalid distance too far back",o.mode=30;break}at=H>o.wnext?(H-=o.wnext,o.wsize-H):o.wnext-H,H>o.length&&(H=o.length),ct=o.window}else ct=Q,at=tt-o.offset,H=o.length;for(J<H&&(H=J),J-=H,o.length-=H;Q[tt++]=ct[at++],--H;);o.length===0&&(o.mode=21);break;case 26:if(J===0)break t;Q[tt++]=o.length,J--,o.mode=21;break;case 27:if(o.wrap){for(;I<32;){if(M===0)break t;M--,A|=P[W++]<<I,I+=8}if(G-=J,x.total_out+=G,o.total+=G,G&&(x.adler=o.check=o.flags?s(o.check,Q,G,tt-G):n(o.check,Q,G,tt-G)),G=J,(o.flags?A:h(A))!==o.check){x.msg="incorrect data check",o.mode=30;break}I=A=0}o.mode=28;case 28:if(o.wrap&&o.flags){for(;I<32;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if(A!==(4294967295&o.total)){x.msg="incorrect length check",o.mode=30;break}I=A=0}o.mode=29;case 29:F=1;break t;case 30:F=-3;break t;case 31:return-4;case 32:default:return l}return x.next_out=tt,x.avail_out=J,x.next_in=W,x.avail_in=M,o.hold=A,o.bits=I,(o.wsize||G!==x.avail_out&&o.mode<30&&(o.mode<27||R!==4))&&V(x,x.output,x.next_out,G-x.avail_out)?(o.mode=31,-4):(K-=x.avail_in,G-=x.avail_out,x.total_in+=K,x.total_out+=G,o.total+=G,o.wrap&&G&&(x.adler=o.check=o.flags?s(o.check,Q,G,x.next_out-G):n(o.check,Q,G,x.next_out-G)),x.data_type=o.bits+(o.last?64:0)+(o.mode===12?128:0)+(o.mode===20||o.mode===15?256:0),(K==0&&G===0||R===4)&&F===w&&(F=-5),F)},a.inflateEnd=function(x){if(!x||!x.state)return l;var R=x.state;return R.window&&(R.window=null),x.state=null,w},a.inflateGetHeader=function(x,R){var o;return x&&x.state?(2&(o=x.state).wrap)==0?l:((o.head=R).done=!1,w):l},a.inflateSetDictionary=function(x,R){var o,P=R.length;return x&&x.state?(o=x.state).wrap!==0&&o.mode!==11?l:o.mode===11&&n(1,R,P,0)!==o.check?-3:V(x,R,P,P)?(o.mode=31,-4):(o.havedict=1,w):l},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,d,a){var r=t("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],g=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];d.exports=function(b,v,w,l,m,c,f,h){var y,k,E,S,O,D,U,B,Z,V=h.bits,x=0,R=0,o=0,P=0,Q=0,W=0,tt=0,M=0,J=0,A=0,I=null,K=0,G=new r.Buf16(16),H=new r.Buf16(16),at=null,ct=0;for(x=0;x<=15;x++)G[x]=0;for(R=0;R<l;R++)G[v[w+R]]++;for(Q=V,P=15;1<=P&&G[P]===0;P--);if(P<Q&&(Q=P),P===0)return m[c++]=20971520,m[c++]=20971520,h.bits=1,0;for(o=1;o<P&&G[o]===0;o++);for(Q<o&&(Q=o),x=M=1;x<=15;x++)if(M<<=1,(M-=G[x])<0)return-1;if(0<M&&(b===0||P!==1))return-1;for(H[1]=0,x=1;x<15;x++)H[x+1]=H[x]+G[x];for(R=0;R<l;R++)v[w+R]!==0&&(f[H[v[w+R]]++]=R);if(D=b===0?(I=at=f,19):b===1?(I=n,K-=257,at=s,ct-=257,256):(I=u,at=g,-1),x=o,O=c,tt=R=A=0,E=-1,S=(J=1<<(W=Q))-1,b===1&&852<J||b===2&&592<J)return 1;for(;;){for(U=x-tt,Z=f[R]<D?(B=0,f[R]):f[R]>D?(B=at[ct+f[R]],I[K+f[R]]):(B=96,0),y=1<<x-tt,o=k=1<<W;m[O+(A>>tt)+(k-=y)]=U<<24|B<<16|Z|0,k!==0;);for(y=1<<x-1;A&y;)y>>=1;if(y!==0?(A&=y-1,A+=y):A=0,R++,--G[x]==0){if(x===P)break;x=v[w+f[R]]}if(Q<x&&(A&S)!==E){for(tt===0&&(tt=Q),O+=o,M=1<<(W=x-tt);W+tt<P&&!((M-=G[W+tt])<=0);)W++,M<<=1;if(J+=1<<W,b===1&&852<J||b===2&&592<J)return 1;m[E=A&S]=Q<<24|W<<16|O-c|0}}return A!==0&&(m[O+A]=x-tt<<24|64<<16|0),h.bits=Q,0}},{"../utils/common":41}],51:[function(t,d,a){d.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,d,a){var r=t("../utils/common"),n=0,s=1;function u(p){for(var C=p.length;0<=--C;)p[C]=0}var g=0,b=29,v=256,w=v+1+b,l=30,m=19,c=2*w+1,f=15,h=16,y=7,k=256,E=16,S=17,O=18,D=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],U=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=new Array(2*(w+2));u(V);var x=new Array(2*l);u(x);var R=new Array(512);u(R);var o=new Array(256);u(o);var P=new Array(b);u(P);var Q,W,tt,M=new Array(l);function J(p,C,L,N,z){this.static_tree=p,this.extra_bits=C,this.extra_base=L,this.elems=N,this.max_length=z,this.has_stree=p&&p.length}function A(p,C){this.dyn_tree=p,this.max_code=0,this.stat_desc=C}function I(p){return p<256?R[p]:R[256+(p>>>7)]}function K(p,C){p.pending_buf[p.pending++]=255&C,p.pending_buf[p.pending++]=C>>>8&255}function G(p,C,L){p.bi_valid>h-L?(p.bi_buf|=C<<p.bi_valid&65535,K(p,p.bi_buf),p.bi_buf=C>>h-p.bi_valid,p.bi_valid+=L-h):(p.bi_buf|=C<<p.bi_valid&65535,p.bi_valid+=L)}function H(p,C,L){G(p,L[2*C],L[2*C+1])}function at(p,C){for(var L=0;L|=1&p,p>>>=1,L<<=1,0<--C;);return L>>>1}function ct(p,C,L){var N,z,$=new Array(f+1),q=0;for(N=1;N<=f;N++)$[N]=q=q+L[N-1]<<1;for(z=0;z<=C;z++){var X=p[2*z+1];X!==0&&(p[2*z]=at($[X]++,X))}}function rt(p){var C;for(C=0;C<w;C++)p.dyn_ltree[2*C]=0;for(C=0;C<l;C++)p.dyn_dtree[2*C]=0;for(C=0;C<m;C++)p.bl_tree[2*C]=0;p.dyn_ltree[2*k]=1,p.opt_len=p.static_len=0,p.last_lit=p.matches=0}function it(p){8<p.bi_valid?K(p,p.bi_buf):0<p.bi_valid&&(p.pending_buf[p.pending++]=p.bi_buf),p.bi_buf=0,p.bi_valid=0}function ut(p,C,L,N){var z=2*C,$=2*L;return p[z]<p[$]||p[z]===p[$]&&N[C]<=N[L]}function ot(p,C,L){for(var N=p.heap[L],z=L<<1;z<=p.heap_len&&(z<p.heap_len&&ut(C,p.heap[z+1],p.heap[z],p.depth)&&z++,!ut(C,N,p.heap[z],p.depth));)p.heap[L]=p.heap[z],L=z,z<<=1;p.heap[L]=N}function pt(p,C,L){var N,z,$,q,X=0;if(p.last_lit!==0)for(;N=p.pending_buf[p.d_buf+2*X]<<8|p.pending_buf[p.d_buf+2*X+1],z=p.pending_buf[p.l_buf+X],X++,N===0?H(p,z,C):(H(p,($=o[z])+v+1,C),(q=D[$])!==0&&G(p,z-=P[$],q),H(p,$=I(--N),L),(q=U[$])!==0&&G(p,N-=M[$],q)),X<p.last_lit;);H(p,k,C)}function ft(p,C){var L,N,z,$=C.dyn_tree,q=C.stat_desc.static_tree,X=C.stat_desc.has_stree,Y=C.stat_desc.elems,st=-1;for(p.heap_len=0,p.heap_max=c,L=0;L<Y;L++)$[2*L]!==0?(p.heap[++p.heap_len]=st=L,p.depth[L]=0):$[2*L+1]=0;for(;p.heap_len<2;)$[2*(z=p.heap[++p.heap_len]=st<2?++st:0)]=1,p.depth[z]=0,p.opt_len--,X&&(p.static_len-=q[2*z+1]);for(C.max_code=st,L=p.heap_len>>1;1<=L;L--)ot(p,$,L);for(z=Y;L=p.heap[1],p.heap[1]=p.heap[p.heap_len--],ot(p,$,1),N=p.heap[1],p.heap[--p.heap_max]=L,p.heap[--p.heap_max]=N,$[2*z]=$[2*L]+$[2*N],p.depth[z]=(p.depth[L]>=p.depth[N]?p.depth[L]:p.depth[N])+1,$[2*L+1]=$[2*N+1]=z,p.heap[1]=z++,ot(p,$,1),2<=p.heap_len;);p.heap[--p.heap_max]=p.heap[1],(function(nt,dt){var yt,mt,vt,lt,xt,zt,gt=dt.dyn_tree,Rt=dt.max_code,Ut=dt.stat_desc.static_tree,jt=dt.stat_desc.has_stree,Wt=dt.stat_desc.extra_bits,Ot=dt.stat_desc.extra_base,wt=dt.stat_desc.max_length,kt=0;for(lt=0;lt<=f;lt++)nt.bl_count[lt]=0;for(gt[2*nt.heap[nt.heap_max]+1]=0,yt=nt.heap_max+1;yt<c;yt++)wt<(lt=gt[2*gt[2*(mt=nt.heap[yt])+1]+1]+1)&&(lt=wt,kt++),gt[2*mt+1]=lt,Rt<mt||(nt.bl_count[lt]++,xt=0,Ot<=mt&&(xt=Wt[mt-Ot]),zt=gt[2*mt],nt.opt_len+=zt*(lt+xt),jt&&(nt.static_len+=zt*(Ut[2*mt+1]+xt)));if(kt!==0){do{for(lt=wt-1;nt.bl_count[lt]===0;)lt--;nt.bl_count[lt]--,nt.bl_count[lt+1]+=2,nt.bl_count[wt]--,kt-=2}while(0<kt);for(lt=wt;lt!==0;lt--)for(mt=nt.bl_count[lt];mt!==0;)Rt<(vt=nt.heap[--yt])||(gt[2*vt+1]!==lt&&(nt.opt_len+=(lt-gt[2*vt+1])*gt[2*vt],gt[2*vt+1]=lt),mt--)}})(p,C),ct($,st,p.bl_count)}function e(p,C,L){var N,z,$=-1,q=C[1],X=0,Y=7,st=4;for(q===0&&(Y=138,st=3),C[2*(L+1)+1]=65535,N=0;N<=L;N++)z=q,q=C[2*(N+1)+1],++X<Y&&z===q||(X<st?p.bl_tree[2*z]+=X:z!==0?(z!==$&&p.bl_tree[2*z]++,p.bl_tree[2*E]++):X<=10?p.bl_tree[2*S]++:p.bl_tree[2*O]++,$=z,st=(X=0)===q?(Y=138,3):z===q?(Y=6,3):(Y=7,4))}function F(p,C,L){var N,z,$=-1,q=C[1],X=0,Y=7,st=4;for(q===0&&(Y=138,st=3),N=0;N<=L;N++)if(z=q,q=C[2*(N+1)+1],!(++X<Y&&z===q)){if(X<st)for(;H(p,z,p.bl_tree),--X!=0;);else z!==0?(z!==$&&(H(p,z,p.bl_tree),X--),H(p,E,p.bl_tree),G(p,X-3,2)):X<=10?(H(p,S,p.bl_tree),G(p,X-3,3)):(H(p,O,p.bl_tree),G(p,X-11,7));$=z,st=(X=0)===q?(Y=138,3):z===q?(Y=6,3):(Y=7,4)}}u(M);var T=!1;function _(p,C,L,N){G(p,(g<<1)+(N?1:0),3),(function(z,$,q,X){it(z),K(z,q),K(z,~q),r.arraySet(z.pending_buf,z.window,$,q,z.pending),z.pending+=q})(p,C,L)}a._tr_init=function(p){T||((function(){var C,L,N,z,$,q=new Array(f+1);for(z=N=0;z<b-1;z++)for(P[z]=N,C=0;C<1<<D[z];C++)o[N++]=z;for(o[N-1]=z,z=$=0;z<16;z++)for(M[z]=$,C=0;C<1<<U[z];C++)R[$++]=z;for($>>=7;z<l;z++)for(M[z]=$<<7,C=0;C<1<<U[z]-7;C++)R[256+$++]=z;for(L=0;L<=f;L++)q[L]=0;for(C=0;C<=143;)V[2*C+1]=8,C++,q[8]++;for(;C<=255;)V[2*C+1]=9,C++,q[9]++;for(;C<=279;)V[2*C+1]=7,C++,q[7]++;for(;C<=287;)V[2*C+1]=8,C++,q[8]++;for(ct(V,w+1,q),C=0;C<l;C++)x[2*C+1]=5,x[2*C]=at(C,5);Q=new J(V,D,v+1,w,f),W=new J(x,U,0,l,f),tt=new J(new Array(0),B,0,m,y)})(),T=!0),p.l_desc=new A(p.dyn_ltree,Q),p.d_desc=new A(p.dyn_dtree,W),p.bl_desc=new A(p.bl_tree,tt),p.bi_buf=0,p.bi_valid=0,rt(p)},a._tr_stored_block=_,a._tr_flush_block=function(p,C,L,N){var z,$,q=0;0<p.level?(p.strm.data_type===2&&(p.strm.data_type=(function(X){var Y,st=4093624447;for(Y=0;Y<=31;Y++,st>>>=1)if(1&st&&X.dyn_ltree[2*Y]!==0)return n;if(X.dyn_ltree[18]!==0||X.dyn_ltree[20]!==0||X.dyn_ltree[26]!==0)return s;for(Y=32;Y<v;Y++)if(X.dyn_ltree[2*Y]!==0)return s;return n})(p)),ft(p,p.l_desc),ft(p,p.d_desc),q=(function(X){var Y;for(e(X,X.dyn_ltree,X.l_desc.max_code),e(X,X.dyn_dtree,X.d_desc.max_code),ft(X,X.bl_desc),Y=m-1;3<=Y&&X.bl_tree[2*Z[Y]+1]===0;Y--);return X.opt_len+=3*(Y+1)+5+5+4,Y})(p),z=p.opt_len+3+7>>>3,($=p.static_len+3+7>>>3)<=z&&(z=$)):z=$=L+5,L+4<=z&&C!==-1?_(p,C,L,N):p.strategy===4||$===z?(G(p,2+(N?1:0),3),pt(p,V,x)):(G(p,4+(N?1:0),3),(function(X,Y,st,nt){var dt;for(G(X,Y-257,5),G(X,st-1,5),G(X,nt-4,4),dt=0;dt<nt;dt++)G(X,X.bl_tree[2*Z[dt]+1],3);F(X,X.dyn_ltree,Y-1),F(X,X.dyn_dtree,st-1)})(p,p.l_desc.max_code+1,p.d_desc.max_code+1,q+1),pt(p,p.dyn_ltree,p.dyn_dtree)),rt(p),N&&it(p)},a._tr_tally=function(p,C,L){return p.pending_buf[p.d_buf+2*p.last_lit]=C>>>8&255,p.pending_buf[p.d_buf+2*p.last_lit+1]=255&C,p.pending_buf[p.l_buf+p.last_lit]=255&L,p.last_lit++,C===0?p.dyn_ltree[2*L]++:(p.matches++,C--,p.dyn_ltree[2*(o[L]+v+1)]++,p.dyn_dtree[2*I(C)]++),p.last_lit===p.lit_bufsize-1},a._tr_align=function(p){G(p,2,3),H(p,k,V),(function(C){C.bi_valid===16?(K(C,C.bi_buf),C.bi_buf=0,C.bi_valid=0):8<=C.bi_valid&&(C.pending_buf[C.pending++]=255&C.bi_buf,C.bi_buf>>=8,C.bi_valid-=8)})(p)}},{"../utils/common":41}],53:[function(t,d,a){d.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,d,a){(function(r){(function(n,s){if(!n.setImmediate){var u,g,b,v,w=1,l={},m=!1,c=n.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(n);f=f&&f.setTimeout?f:n,u={}.toString.call(n.process)==="[object process]"?function(E){process.nextTick(function(){y(E)})}:(function(){if(n.postMessage&&!n.importScripts){var E=!0,S=n.onmessage;return n.onmessage=function(){E=!1},n.postMessage("","*"),n.onmessage=S,E}})()?(v="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",k,!1):n.attachEvent("onmessage",k),function(E){n.postMessage(v+E,"*")}):n.MessageChannel?((b=new MessageChannel).port1.onmessage=function(E){y(E.data)},function(E){b.port2.postMessage(E)}):c&&"onreadystatechange"in c.createElement("script")?(g=c.documentElement,function(E){var S=c.createElement("script");S.onreadystatechange=function(){y(E),S.onreadystatechange=null,g.removeChild(S),S=null},g.appendChild(S)}):function(E){setTimeout(y,0,E)},f.setImmediate=function(E){typeof E!="function"&&(E=new Function(""+E));for(var S=new Array(arguments.length-1),O=0;O<S.length;O++)S[O]=arguments[O+1];var D={callback:E,args:S};return l[w]=D,u(w),w++},f.clearImmediate=h}function h(E){delete l[E]}function y(E){if(m)setTimeout(y,0,E);else{var S=l[E];if(S){m=!0;try{(function(O){var D=O.callback,U=O.args;switch(U.length){case 0:D();break;case 1:D(U[0]);break;case 2:D(U[0],U[1]);break;case 3:D(U[0],U[1],U[2]);break;default:D.apply(s,U)}})(S)}finally{h(E),m=!1}}}}function k(E){E.source===n&&typeof E.data=="string"&&E.data.indexOf(v)===0&&y(+E.data.slice(v.length))}})(typeof self>"u"?r===void 0?this:r:self)}).call(this,typeof Et<"u"?Et:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(It)),It.exports}var Gt=Ht();const At=Xt(Gt);class qt{constructor(){et(this,"scriptLoaded",!1);this.ensureScriptLoaded()}ensureScriptLoaded(){if(this.scriptLoaded)return;if(typeof window.officeParser<"u"){this.scriptLoaded=!0;return}if(document.querySelector('script[src="/officeparser.browser.js"]')){this.scriptLoaded=!0;return}throw new Error('officeparser.browser.js not loaded. Add <script src="/officeparser.browser.js"><\/script> to index.html')}async parseFile(i){this.ensureScriptLoaded();const t=await i.arrayBuffer(),d=await window.officeParser.parseOffice(t),a=await this.extractSectionProperties(t),r=this.normalizeAST(d);r.sectionProperties=a;const n=await this.extractNumberedLists(t);return n.length>0&&(r.blocks=this.mergeBlocks(r.blocks,n)),r}async extractNumberedLists(i){try{const d=await(await At.loadAsync(i)).file("word/document.xml")?.async("string");if(!d)return[];const r=new DOMParser().parseFromString(d,"application/xml"),n=[],s=r.getElementsByTagName("w:p");for(let u=0;u<s.length;u++){const g=s[u];if(g.getElementsByTagName("w:numPr").length>0){const v=this.extractTextFromParagraph(g);if(v.trim()){const w=this.extractFormattingFromParagraph(g),l=v.trim().replace(/\s+/g," ");n.push({block:{id:this.generateBlockId(l,1e3+u),type:"paragraph",text:l,runs:[{text:l,formatting:w}],formatting:w},xmlIndex:u})}}}return n}catch(t){return console.warn("Failed to extract numbered lists:",t),[]}}extractTextFromParagraph(i){const t=i.getElementsByTagName("w:t");let d="";for(let a=0;a<t.length;a++)d+=t[a].textContent||"";return d}extractFormattingFromParagraph(i){const t={},d=i.getElementsByTagName("w:b");if(d.length>0){const n=d[0].getAttribute("w:val");(n===null||n===""||n==="true"||n==="1")&&(t.bold=!0)}const a=i.getElementsByTagName("w:i");if(a.length>0){const n=a[0].getAttribute("w:val");(n===null||n===""||n==="true"||n==="1")&&(t.italic=!0)}const r=i.getElementsByTagName("w:u");if(r.length>0){const n=r[0].getAttribute("w:val");n&&n!=="none"&&(t.underline=!0)}return t}mergeBlocks(i,t){if(t.length===0)return i;if(i.length===0)return t.map(u=>u.block);const d=new Set(i.map(u=>u.text.toLowerCase().trim())),a=t.filter(u=>!d.has(u.block.text.toLowerCase().trim()));if(a.length===0)return i;a.sort((u,g)=>u.xmlIndex-g.xmlIndex);const r=[];let n=0,s=0;for(;n<i.length||s<a.length;){for(;s<a.length;){if(n>=i.length){r.push(a[s].block),s++;continue}const u=a[s].xmlIndex;if(s===0||u<(n+s)*2)r.push(a[s].block),s++;else break}n<i.length&&(r.push(i[n]),n++)}return r.map((u,g)=>({...u,id:this.generateBlockId(u.text,g)}))}async extractSectionProperties(i){try{const d=await(await At.loadAsync(i)).file("word/document.xml")?.async("string");if(!d)return{};const n=new DOMParser().parseFromString(d,"application/xml").getElementsByTagName("w:sectPr");if(n.length===0)return{};const u=n[n.length-1].getElementsByTagName("w:cols");if(u.length===0)return{};const g=u[0],b=g.getAttribute("w:num"),v=g.getAttribute("w:space"),w={};return b&&(w.columnCount=parseInt(b,10)),v&&(w.columnSpace=parseInt(v,10)),w}catch(t){return console.warn("Failed to extract section properties:",t),{}}}normalizeAST(i){const t=[],d={author:i.author||void 0,title:i.title||void 0,created:i.created?new Date(i.created):void 0,modified:i.modified?new Date(i.modified):void 0};return Array.isArray(i.content)&&i.content.forEach((a,r)=>{if(a.type&&a.type!=="paragraph"&&a.type!=="heading"&&a.type!=="table"&&console.log(`[DocxParser] Unhandled item type at index ${r}:`,a.type,a),a.type==="paragraph"||a.type==="heading"){const n=this.normalizeParagraph(a,r);n&&t.push(n)}else if(a.type==="table"){const n=this.normalizeTable(a,r);n&&t.push(n)}else(a.type==="page-break"||a.type==="break")&&t.push({id:`page-break-${r}`,type:"page-break",text:"",runs:[],formatting:{}})}),{metadata:d,blocks:t}}normalizeParagraph(i,t){let d="paragraph";if(i.style){const n=i.style.toLowerCase();n.includes("heading1")||n.includes("heading 1")?d="heading1":n.includes("heading2")||n.includes("heading 2")?d="heading2":(n.includes("heading3")||n.includes("heading 3"))&&(d="heading3")}let a=i.text||"";const r=[];if(Array.isArray(i.runs)&&i.runs.length>0&&(i.runs.forEach(n=>{const s=n.text||"";s&&r.push({text:s,formatting:this.extractFormatting(n)})}),a=r.map(n=>n.text).join("").trim().replace(/\s+/g," ")),r.length===0&&a){const n=a.trim().replace(/\s+/g," ");r.push({text:n,formatting:this.extractFormatting(i)}),a=n}return a.trim()?{id:this.generateBlockId(a,t),type:d,text:a.trim().replace(/\s+/g," "),runs:r,formatting:this.extractFormatting(i)}:null}normalizeTable(i,t){let d="";if(Array.isArray(i.rows)&&i.rows.forEach(r=>{if(Array.isArray(r.cells)){const n=r.cells.map(s=>s.text||"").filter(s=>s.trim());n.length>0&&(d+=n.join(" | ")+`
`)}}),!d.trim())return null;const a=d.trim().replace(/\s+/g," ");return{id:this.generateBlockId(a,t),type:"table",text:a,runs:[{text:a,formatting:{}}],formatting:{}}}extractFormatting(i){const t={};return i.bold===!0&&(t.bold=!0),i.italic===!0&&(t.italic=!0),i.underline===!0&&(t.underline=!0),i.color&&(t.color=i.color),i.font&&(t.font=i.font),i.fontSize&&(t.fontSize=i.fontSize),t}generateBlockId(i,t){const d=this.simpleHash(i.substring(0,100));return`block-${t}-${d}`}simpleHash(i){let t=0;for(let d=0;d<i.length;d++){const a=i.charCodeAt(d);t=(t<<5)-t+a,t=t&t}return Math.abs(t).toString(36)}terminate(){}}function _t(){}_t.prototype={diff:function(i,t){var d,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=a.callback;typeof a=="function"&&(r=a,a={}),this.options=a;var n=this;function s(E){return r?(setTimeout(function(){r(void 0,E)},0),!0):E}i=this.castInput(i),t=this.castInput(t),i=this.removeEmpty(this.tokenize(i)),t=this.removeEmpty(this.tokenize(t));var u=t.length,g=i.length,b=1,v=u+g;a.maxEditLength&&(v=Math.min(v,a.maxEditLength));var w=(d=a.timeout)!==null&&d!==void 0?d:1/0,l=Date.now()+w,m=[{oldPos:-1,lastComponent:void 0}],c=this.extractCommon(m[0],t,i,0);if(m[0].oldPos+1>=g&&c+1>=u)return s([{value:this.join(t),count:t.length}]);var f=-1/0,h=1/0;function y(){for(var E=Math.max(f,-b);E<=Math.min(h,b);E+=2){var S=void 0,O=m[E-1],D=m[E+1];O&&(m[E-1]=void 0);var U=!1;if(D){var B=D.oldPos-E;U=D&&0<=B&&B<u}var Z=O&&O.oldPos+1<g;if(!U&&!Z){m[E]=void 0;continue}if(!Z||U&&O.oldPos+1<D.oldPos?S=n.addToPath(D,!0,void 0,0):S=n.addToPath(O,void 0,!0,1),c=n.extractCommon(S,t,i,E),S.oldPos+1>=g&&c+1>=u)return s(Yt(n,S.lastComponent,t,i,n.useLongestToken));m[E]=S,S.oldPos+1>=g&&(h=Math.min(h,E-1)),c+1>=u&&(f=Math.max(f,E+1))}b++}if(r)(function E(){setTimeout(function(){if(b>v||Date.now()>l)return r();y()||E()},0)})();else for(;b<=v&&Date.now()<=l;){var k=y();if(k)return k}},addToPath:function(i,t,d,a){var r=i.lastComponent;return r&&r.added===t&&r.removed===d?{oldPos:i.oldPos+a,lastComponent:{count:r.count+1,added:t,removed:d,previousComponent:r.previousComponent}}:{oldPos:i.oldPos+a,lastComponent:{count:1,added:t,removed:d,previousComponent:r}}},extractCommon:function(i,t,d,a){for(var r=t.length,n=d.length,s=i.oldPos,u=s-a,g=0;u+1<r&&s+1<n&&this.equals(t[u+1],d[s+1]);)u++,s++,g++;return g&&(i.lastComponent={count:g,previousComponent:i.lastComponent}),i.oldPos=s,u},equals:function(i,t){return this.options.comparator?this.options.comparator(i,t):i===t||this.options.ignoreCase&&i.toLowerCase()===t.toLowerCase()},removeEmpty:function(i){for(var t=[],d=0;d<i.length;d++)i[d]&&t.push(i[d]);return t},castInput:function(i){return i},tokenize:function(i){return i.split("")},join:function(i){return i.join("")}};function Yt(j,i,t,d,a){for(var r=[],n;i;)r.push(i),n=i.previousComponent,delete i.previousComponent,i=n;r.reverse();for(var s=0,u=r.length,g=0,b=0;s<u;s++){var v=r[s];if(v.removed){if(v.value=j.join(d.slice(b,b+v.count)),b+=v.count,s&&r[s-1].added){var l=r[s-1];r[s-1]=r[s],r[s]=l}}else{if(!v.added&&a){var w=t.slice(g,g+v.count);w=w.map(function(c,f){var h=d[b+f];return h.length>c.length?h:c}),v.value=j.join(w)}else v.value=j.join(t.slice(g,g+v.count));g+=v.count,v.added||(b+=v.count)}}var m=r[u-1];return u>1&&typeof m.value=="string"&&(m.added||m.removed)&&j.equals("",m.value)&&(r[u-2].value+=m.value,r.pop()),r}function Kt(j,i){if(typeof j=="function")i.callback=j;else if(j)for(var t in j)j.hasOwnProperty(t)&&(i[t]=j[t]);return i}var Pt=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,Lt=/\S/,Dt=new _t;Dt.equals=function(j,i){return this.options.ignoreCase&&(j=j.toLowerCase(),i=i.toLowerCase()),j===i||this.options.ignoreWhitespace&&!Lt.test(j)&&!Lt.test(i)};Dt.tokenize=function(j){for(var i=j.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),t=0;t<i.length-1;t++)!i[t+1]&&i[t+2]&&Pt.test(i[t])&&Pt.test(i[t+2])&&(i[t]+=i[t+2],i.splice(t+1,2),t--);return i};function Vt(j,i,t){return t=Kt(t,{ignoreWhitespace:!0}),Dt.diff(j,i,t)}var Nt=new _t;Nt.tokenize=function(j){this.options.stripTrailingCr&&(j=j.replace(/\r\n/g,`
`));var i=[],t=j.split(/(\n|\r\n)/);t[t.length-1]||t.pop();for(var d=0;d<t.length;d++){var a=t[d];d%2&&!this.options.newlineIsToken?i[i.length-1]+=a:(this.options.ignoreWhitespace&&(a=a.trim()),i.push(a))}return i};var Jt=new _t;Jt.tokenize=function(j){return j.split(/(\S.+?[.!?])(?=\s+|$)/)};var Qt=new _t;Qt.tokenize=function(j){return j.split(/([{}:;,]|\s+)/)};function St(j){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?St=function(i){return typeof i}:St=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},St(j)}var te=Object.prototype.toString,bt=new _t;bt.useLongestToken=!0;bt.tokenize=Nt.tokenize;bt.castInput=function(j){var i=this.options,t=i.undefinedReplacement,d=i.stringifyReplacer,a=d===void 0?function(r,n){return typeof n>"u"?t:n}:d;return typeof j=="string"?j:JSON.stringify(Tt(j,null,null,a),a,"  ")};bt.equals=function(j,i){return _t.prototype.equals.call(bt,j.replace(/,([\r\n])/g,"$1"),i.replace(/,([\r\n])/g,"$1"))};function Tt(j,i,t,d,a){i=i||[],t=t||[],d&&(j=d(a,j));var r;for(r=0;r<i.length;r+=1)if(i[r]===j)return t[r];var n;if(te.call(j)==="[object Array]"){for(i.push(j),n=new Array(j.length),t.push(n),r=0;r<j.length;r+=1)n[r]=Tt(j[r],i,t,d,a);return i.pop(),t.pop(),n}if(j&&j.toJSON&&(j=j.toJSON()),St(j)==="object"&&j!==null){i.push(j),n={},t.push(n);var s=[],u;for(u in j)j.hasOwnProperty(u)&&s.push(u);for(s.sort(),r=0;r<s.length;r+=1)u=s[r],n[u]=Tt(j[u],i,t,d,u);i.pop(),t.pop()}else n=j;return n}var Bt=new _t;Bt.tokenize=function(j){return j.slice()};Bt.join=Bt.removeEmpty=function(j){return j};class ee{constructor(){et(this,"debugMode",!1)}setDebugMode(i){this.debugMode=i}isDebugMode(){return this.debugMode}diffDocuments(i,t){return this.diffDocumentsWithDebug(i,t).diff}diffDocumentsWithDebug(i,t){const{alignment:d,decisions:a}=this.alignBlocks(i.blocks,t.blocks),r=[];let n=0;return d.forEach(([u,g])=>{if(!u&&g)r.push({type:"insert",currentBlock:g,changeId:`change-${n++}`});else if(u&&!g)r.push({type:"delete",originalBlock:u,changeId:`change-${n++}`});else if(u&&g)if(u.text===g.text&&this.formatingsEqual(u.formatting,g.formatting))r.push({type:"unchanged",originalBlock:u,currentBlock:g});else{const b=Vt(u.text,g.text),v=this.diffFormatting(u,g,b),w=b.some(l=>l.added||l.removed)||v.some(l=>l.type==="format-change");r.push({type:w?"modify":"unchanged",originalBlock:u,currentBlock:g,wordDiff:b,formatDiff:v,changeId:w?`change-${n++}`:void 0})}}),{diff:{blockDiffs:r,totalChanges:n,sectionProperties:t.sectionProperties},alignmentDecisions:a}}alignBlocks(i,t){const d=[],a=[],r=l=>l.trim().replace(/\s+/g," "),n=l=>r(l.text),s=l=>l.substring(0,100),u=(l,m)=>{const c=r(l.text),f=r(m.text);if(c===f)return 1;if(!c||!f)return 0;const h=c.split(/\s+/),y=f.split(/\s+/),k=new Set(h),E=new Set(y);let S=0;return k.forEach(O=>{E.has(O)&&S++}),2*S/(k.size+E.size)},g=new Map;t.forEach(l=>{const m=n(l);g.has(m)||g.set(m,[]),g.get(m).push(l)});const b=new Set,v=[];i.forEach((l,m)=>{const c=n(l),f=g.get(c)||[];let h=!1;for(let y=0;y<f.length;y++){const k=t.indexOf(f[y]);if(!b.has(k)){d.push([l,f[y]]),b.add(k),h=!0,a.push({originalIndex:m,currentIndex:k,matchType:"exact",similarityScore:1,reason:"Exact text match after whitespace normalization",originalPreview:s(l.text),currentPreview:s(f[y].text)});break}}h||v.push({block:l,index:m})});const w=.5;return v.forEach(({block:l,index:m})=>{let c=null;if(t.forEach((f,h)=>{if(b.has(h))return;const y=u(l,f);y>=w&&(!c||y>c.similarity)&&(c={block:f,index:h,similarity:y})}),c){const f=c;d.push([l,f.block]),b.add(f.index),a.push({originalIndex:m,currentIndex:f.index,matchType:"fuzzy",similarityScore:f.similarity,reason:`Fuzzy match: ${(f.similarity*100).toFixed(1)}% word overlap (threshold: ${w*100}%)`,originalPreview:s(l.text),currentPreview:s(f.block.text)})}else{d.push([l,null]);let f=0,h=null;t.forEach((k,E)=>{if(b.has(E))return;const S=u(l,k);S>f&&(f=S,h=E)});const y=h!==null?`No match found. Best candidate had ${(f*100).toFixed(1)}% similarity (below ${w*100}% threshold)`:"No match found. No unmatched candidates remaining";a.push({originalIndex:m,currentIndex:null,matchType:"delete",similarityScore:f>0?f:void 0,reason:y,originalPreview:s(l.text)})}}),t.forEach((l,m)=>{b.has(m)||(d.push([null,l]),a.push({originalIndex:null,currentIndex:m,matchType:"insert",reason:"No matching block in original document",currentPreview:s(l.text)}))}),d.sort((l,m)=>{const c=l[0]?i.indexOf(l[0]):1/0,f=m[0]?i.indexOf(m[0]):1/0;if(c!==f)return c-f;const h=l[1]?t.indexOf(l[1]):1/0,y=m[1]?t.indexOf(m[1]):1/0;return h-y}),{alignment:d,decisions:a}}diffFormatting(i,t,d){const a=[];return d.forEach(r=>{if(r.added)a.push({type:"insert",text:r.value,formatting:t.formatting});else if(r.removed)a.push({type:"delete",text:r.value,formatting:i.formatting});else{const n=this.compareFormatting(i.formatting,t.formatting);n.changed?a.push({type:"format-change",text:r.value,from:i.formatting,to:t.formatting,changes:n.changes}):a.push({type:"unchanged",text:r.value,formatting:i.formatting})}}),a}compareFormatting(i,t){const d={};let a=!1;return["bold","italic","underline","color","font","fontSize"].forEach(n=>{i[n]!==t[n]&&(d[n]={from:i[n],to:t[n]},a=!0)}),{changed:a,changes:d}}formatingsEqual(i,t){return i.bold===t.bold&&i.italic===t.italic&&i.underline===t.underline&&i.color===t.color&&i.font===t.font&&i.fontSize===t.fontSize}}class re{constructor(i){et(this,"redlinedPane");et(this,"changeElements",[]);const t=document.getElementById(i);if(!t)throw new Error("Redlined pane not found");this.redlinedPane=t}renderRedlined(i){this.changeElements=[];const t=[];i.blockDiffs.forEach(d=>{t.push(this.renderRedlinedBlock(d))}),this.applyColumnStyling(this.redlinedPane,i.sectionProperties),this.redlinedPane.innerHTML=t.join(""),this.collectChangeElements()}applyColumnStyling(i,t){if(t?.columnCount&&t.columnCount>1){const d=t.columnSpace?Math.round(t.columnSpace/1440*96):24;i.style.columnCount=String(t.columnCount),i.style.columnGap=`${d}px`}else i.style.columnCount="",i.style.columnGap=""}renderRedlinedBlock(i){const t=i.changeId?` data-change-id="${i.changeId}"`:"";switch(i.type){case"insert":return this.renderBlock(i.currentBlock,"inserted",t);case"delete":return this.renderBlock(i.originalBlock,"deleted",t);case"modify":return this.renderRedlinedModifiedBlock(i,t);case"unchanged":return this.renderBlock(i.currentBlock,"unchanged","");default:return""}}renderBlock(i,t,d){if(i.type==="page-break")return`<div class="block block-page-break ${t==="inserted"?"block-inserted":t==="deleted"?"block-deleted":"block-unchanged"}"${d}>
        <div class="page-break-indicator">
          <span> Page Break </span>
        </div>
      </div>`;const a=t==="inserted"?"block-inserted":t==="deleted"?"block-deleted":"block-unchanged",r=`para-${i.type}`;let n="";return i.runs&&i.runs.length>0?n=i.runs.map(s=>this.renderFormattedText(s.text,s.formatting)).join(""):n=this.escapeHtml(i.text),`<div class="block ${a} ${r}"${d}>${n}</div>`}renderRedlinedModifiedBlock(i,t){if(!i.wordDiff)return this.renderBlock(i.currentBlock,"unchanged",t);const d=i.currentBlock;let r=`<div class="block block-modified ${`para-${d.type}`}"${t}>`;return i.wordDiff.forEach(n=>{if(n.removed){const s=i.originalBlock,u=this.renderFormattedText(n.value,s.formatting);r+=`<span class="diff-delete">${u}</span>`}else if(n.added){const s=this.renderFormattedText(n.value,d.formatting);r+=`<span class="diff-insert">${s}</span>`}else r+=this.renderFormattedText(n.value,d.formatting)}),r+="</div>",r}renderFormattedText(i,t){let d=this.escapeHtml(i);t.bold&&(d=`<strong>${d}</strong>`),t.italic&&(d=`<em>${d}</em>`),t.underline&&(d=`<u>${d}</u>`);const a=[];return t.color&&a.push(`color: ${t.color}`),t.font&&a.push(`font-family: ${t.font}`),t.fontSize&&a.push(`font-size: ${t.fontSize}pt`),a.length>0&&(d=`<span style="${a.join("; ")}">${d}</span>`),d}escapeHtml(i){const t=document.createElement("div");return t.textContent=i,t.innerHTML}collectChangeElements(){this.changeElements=Array.from(this.redlinedPane.querySelectorAll("[data-change-id]"))}getChangeElements(){return this.changeElements}}class ne{constructor(i,t,d,a){et(this,"changeElements");et(this,"currentIndex",-1);et(this,"prevButton");et(this,"nextButton");et(this,"counterElement");this.changeElements=i;const r=document.getElementById(t),n=document.getElementById(d),s=document.getElementById(a);if(!r||!n||!s)throw new Error("Navigation elements not found");this.prevButton=r,this.nextButton=n,this.counterElement=s,this.setupListeners(),this.updateUI()}setupListeners(){this.prevButton.addEventListener("click",()=>this.goToPrevious()),this.nextButton.addEventListener("click",()=>this.goToNext()),document.addEventListener("keydown",i=>{i.key==="n"&&!this.isInputFocused()?(i.preventDefault(),this.goToNext()):i.key==="p"&&!this.isInputFocused()&&(i.preventDefault(),this.goToPrevious())})}isInputFocused(){const i=document.activeElement;return i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement}goToNext(){this.currentIndex<this.changeElements.length-1?this.navigateToIndex(this.currentIndex+1):this.changeElements.length>0&&this.navigateToIndex(0)}goToPrevious(){this.currentIndex>0?this.navigateToIndex(this.currentIndex-1):this.changeElements.length>0&&this.navigateToIndex(this.changeElements.length-1)}navigateToIndex(i){this.currentIndex>=0&&this.currentIndex<this.changeElements.length&&this.changeElements[this.currentIndex].classList.remove("change-highlight"),this.currentIndex=i;const t=this.changeElements[this.currentIndex];t.classList.add("change-highlight"),t.scrollIntoView({behavior:"smooth",block:"center"}),this.updateUI()}updateUI(){const i=this.changeElements.length;if(i===0)this.counterElement.textContent="No changes",this.prevButton.disabled=!0,this.nextButton.disabled=!0;else{const t=this.currentIndex+1;this.counterElement.textContent=`${t} of ${i} changes`,this.prevButton.disabled=!1,this.nextButton.disabled=!1}}reset(){this.changeElements.forEach(i=>i.classList.remove("change-highlight")),this.currentIndex=-1,this.updateUI()}updateChangeElements(i){this.changeElements=i,this.reset(),i.length>0?this.navigateToIndex(0):this.updateUI()}}const ht={w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"};class ie{constructor(){et(this,"zip",null);et(this,"documentXml",null);et(this,"comments",[]);et(this,"nextCommentId",0);et(this,"nextRevisionId",0);et(this,"author","Document Comparison");et(this,"date",new Date().toISOString())}async export(i,t,d){this.zip=await At.loadAsync(t);const a=await this.zip.file("word/document.xml")?.async("string");if(!a)throw new Error("Invalid DOCX: missing word/document.xml");const r=new DOMParser;this.documentXml=r.parseFromString(a,"application/xml"),this.comments=[],this.nextCommentId=0,this.nextRevisionId=0,this.date=new Date().toISOString();const n=Array.from(this.documentXml.getElementsByTagName("w:p"));this.processBlockDiffs(i.blockDiffs,n);const u=new XMLSerializer().serializeToString(this.documentXml);this.zip.file("word/document.xml",u),this.comments.length>0&&await this.addCommentsToZip();const g=await this.zip.generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});this.downloadBlob(g,`${this.getBaseName(d)}_redlined.docx`)}processBlockDiffs(i,t){const d=new Set,a=new Map;for(const r of i){if(r.type==="delete")continue;const n=r.currentBlock;if(!n||n.type==="page-break")continue;const s=this.matchBlockToParagraph(n,t,d);s&&(d.add(s),a.set(r,s))}for(let r=0;r<i.length;r++){const n=i[r];if(n.type==="unchanged")continue;if(n.type==="delete"){const g=n.originalBlock;if(!g||g.type==="page-break")continue;let b=null;for(let v=r+1;v<i.length;v++){const w=i[v];if(w.type!=="delete"&&(b=a.get(w)||null,b))break}this.insertDeletedParagraph(g,b);continue}const s=a.get(n);if(!s)continue;const u=n.currentBlock;switch(n.type){case"insert":this.markParagraphAsInserted(s,u);break;case"modify":this.applyWordLevelChanges(s,n);break}}}matchBlockToParagraph(i,t,d){const a=this.normalizeText(i.text);for(const r of t){if(d.has(r))continue;if(this.normalizeText(this.getParagraphText(r))===a)return r}for(const r of t){if(d.has(r))continue;const n=this.normalizeText(this.getParagraphText(r));if(n.length>0&&a.length>0){if(n.includes(a)||a.includes(n))return r;const s=Math.min(n.length,a.length,30);if(s>10&&n.substring(0,s)===a.substring(0,s))return r}}return null}getParagraphText(i){const t=i.getElementsByTagName("w:t");let d="";for(let a=0;a<t.length;a++)d+=t[a].textContent||"";return d}normalizeText(i){return i.trim().replace(/\s+/g," ").toLowerCase()}markParagraphAsInserted(i,t){const d=this.addComment(`Added: New ${t.type}`),a=Array.from(i.getElementsByTagName("w:r"));if(a.length===0)return;const r=a[0],n=this.createCommentRangeStart(d);r.parentNode?.insertBefore(n,r);for(const b of a)this.applyInsertionFormatting(b);const s=a[a.length-1],u=this.createCommentRangeEnd(d),g=this.createCommentReference(d);s.parentNode?.insertBefore(u,s.nextSibling),u.parentNode?.insertBefore(g,u.nextSibling)}insertDeletedParagraph(i,t){const d=this.documentXml?.getElementsByTagName("w:body")[0];if(!d)return;const a=this.addComment(`Removed: Deleted ${i.type}`),r=this.documentXml.createElementNS(ht.w,"w:p");r.appendChild(this.createCommentRangeStart(a));const n=this.createDelElement(),s=this.createRunWithText(i.text,!0);if(n.appendChild(s),r.appendChild(n),r.appendChild(this.createCommentRangeEnd(a)),r.appendChild(this.createCommentReference(a)),t)t.parentNode?.insertBefore(r,t);else{const u=d.getElementsByTagName("w:sectPr")[0];u?d.insertBefore(r,u):d.appendChild(r)}}applyWordLevelChanges(i,t){if(!t.wordDiff||t.wordDiff.length===0)return;const d=i.getElementsByTagName("w:pPr")[0];for(;i.firstChild;)i.removeChild(i.firstChild);d&&i.appendChild(d);for(const a of t.wordDiff)if(a.added){const r=this.addComment(`Added: "${a.value.trim()}"`);i.appendChild(this.createCommentRangeStart(r));const n=this.createRunWithText(a.value,!1,!0);i.appendChild(n),i.appendChild(this.createCommentRangeEnd(r)),i.appendChild(this.createCommentReference(r))}else if(a.removed){const r=this.addComment(`Removed: "${a.value.trim()}"`);i.appendChild(this.createCommentRangeStart(r));const n=this.createDelElement(),s=this.createRunWithText(a.value,!0);n.appendChild(s),i.appendChild(n),i.appendChild(this.createCommentRangeEnd(r)),i.appendChild(this.createCommentReference(r))}else{const r=this.createRunWithText(a.value,!1,!1);i.appendChild(r)}}createDelElement(){const i=this.documentXml.createElementNS(ht.w,"w:del");return i.setAttribute("w:id",String(this.nextRevisionId++)),i.setAttribute("w:author",this.author),i.setAttribute("w:date",this.date),i}createRunWithText(i,t,d=!1){const a=this.documentXml.createElementNS(ht.w,"w:r"),r=this.documentXml.createElementNS(ht.w,"w:rPr");if(t){const s=this.documentXml.createElementNS(ht.w,"w:color");s.setAttribute("w:val","FF0000"),r.appendChild(s);const u=this.documentXml.createElementNS(ht.w,"w:strike");r.appendChild(u)}else if(d){const s=this.documentXml.createElementNS(ht.w,"w:highlight");s.setAttribute("w:val","yellow"),r.appendChild(s)}a.appendChild(r);const n=this.documentXml.createElementNS(ht.w,t?"w:delText":"w:t");return n.setAttribute("xml:space","preserve"),n.textContent=i,a.appendChild(n),a}applyInsertionFormatting(i){let t=i.getElementsByTagName("w:rPr")[0];t||(t=this.documentXml.createElementNS(ht.w,"w:rPr"),i.insertBefore(t,i.firstChild));let d=t.getElementsByTagName("w:highlight")[0];d||(d=this.documentXml.createElementNS(ht.w,"w:highlight"),t.appendChild(d)),d.setAttribute("w:val","yellow")}createCommentRangeStart(i){const t=this.documentXml.createElementNS(ht.w,"w:commentRangeStart");return t.setAttribute("w:id",String(i)),t}createCommentRangeEnd(i){const t=this.documentXml.createElementNS(ht.w,"w:commentRangeEnd");return t.setAttribute("w:id",String(i)),t}createCommentReference(i){const t=this.documentXml.createElementNS(ht.w,"w:r"),d=this.documentXml.createElementNS(ht.w,"w:commentReference");return d.setAttribute("w:id",String(i)),t.appendChild(d),t}addComment(i){const t=this.nextCommentId++;return this.comments.push({id:t,text:i}),t}async addCommentsToZip(){const i=this.buildCommentsXml();this.zip.file("word/comments.xml",i),await this.updateRelationships(),await this.updateContentTypes()}buildCommentsXml(){return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:comments xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main"
            xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"
            xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006">
${this.comments.map(t=>`
    <w:comment w:id="${t.id}" w:author="${this.author}" w:date="${this.date}">
      <w:p>
        <w:r>
          <w:t>${this.escapeXml(t.text)}</w:t>
        </w:r>
      </w:p>
    </w:comment>`).join("")}
</w:comments>`}async updateRelationships(){const i="word/_rels/document.xml.rels";let t=await this.zip.file(i)?.async("string");if(t||(t=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
</Relationships>`),t.includes("comments.xml"))return;const d=t.match(/rId(\d+)/g)||[];let a=0;for(const s of d){const u=parseInt(s.replace("rId",""),10);u>a&&(a=u)}const n=`<Relationship Id="${`rId${a+1}`}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments" Target="comments.xml"/>`;t=t.replace("</Relationships>",`  ${n}
</Relationships>`),this.zip.file(i,t)}async updateContentTypes(){const i="[Content_Types].xml";let t=await this.zip.file(i)?.async("string");if(!t||t.includes("/word/comments.xml"))return;t=t.replace("</Types>",`  <Override PartName="/word/comments.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml"/>
</Types>`),this.zip.file(i,t)}escapeXml(i){return i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}downloadBlob(i,t){const d=URL.createObjectURL(i),a=document.createElement("a");a.href=d,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(d)}getBaseName(i){return i.replace(/\.(docx?|DOCX?)$/,"")}}class se{generateReport(i,t,d,a,r,n){return{timestamp:new Date().toISOString(),originalFile:r,currentFile:n,parsing:this.generateParsingDebug(i,t),alignment:this.generateAlignmentDebug(a),diffs:this.generateDiffDebug(d)}}generateParsingDebug(i,t){return{original:{blockCount:i.blocks.length,blocks:i.blocks.map((d,a)=>this.blockToDebug(d,a))},current:{blockCount:t.blocks.length,blocks:t.blocks.map((d,a)=>this.blockToDebug(d,a))}}}blockToDebug(i,t){const d=i.text.trim()?i.text.trim().split(/\s+/).length:0,a=!!(i.formatting.bold||i.formatting.italic||i.formatting.underline||i.formatting.color||i.formatting.font||i.formatting.fontSize);return{index:t,type:i.type,textPreview:i.text.substring(0,100),textLength:i.text.length,wordCount:d,hasFormatting:a}}generateAlignmentDebug(i){let t=0,d=0,a=0,r=0;for(const n of i)switch(n.matchType){case"exact":t++;break;case"fuzzy":d++;break;case"delete":a++;break;case"insert":r++;break}return{exactMatches:t,fuzzyMatches:d,deletions:a,insertions:r,decisions:i}}generateDiffDebug(i){return i.blockDiffs.map(t=>this.blockDiffToDebug(t))}blockDiffToDebug(i){const t={type:i.type,changeId:i.changeId};if(i.originalBlock&&(t.originalText=i.originalBlock.text),i.currentBlock&&(t.currentText=i.currentBlock.text),i.wordDiff){let d=0,a=0,r=0;for(const n of i.wordDiff){const s=n.value.trim()?n.value.trim().split(/\s+/).length:0;n.added?d+=s:n.removed?a+=s:r+=s}t.wordDiffSummary={addedWords:d,removedWords:a,unchangedWords:r}}return t}exportToFile(i){const t=JSON.stringify(i,null,2),d=new Blob([t],{type:"application/json"}),a=URL.createObjectURL(d),r=document.createElement("a");r.href=a,r.download=`debug-report-${new Date().toISOString().replace(/[:.]/g,"-")}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)}}class ae{constructor(){et(this,"fileUpload");et(this,"parser");et(this,"diffEngine");et(this,"renderer",null);et(this,"navigator",null);et(this,"docxInPlaceExporter");et(this,"debugExporter");et(this,"originalFileName","");et(this,"currentFileName","");et(this,"debugMode",!1);et(this,"currentDiff",null);et(this,"originalAST",null);et(this,"currentAST",null);et(this,"alignmentDecisions",[]);et(this,"currentFileBuffer",null);this.fileUpload=new $t,this.parser=new qt,this.diffEngine=new ee,this.docxInPlaceExporter=new ie,this.debugExporter=new se,this.debugMode=this.checkDebugMode(),this.diffEngine.setDebugMode(this.debugMode),this.fileUpload.onFilesReady((i,t)=>{this.originalFileName=i.name,this.currentFileName=t.name,this.compareDocuments(i,t)}),this.setupDocxExportButton(),this.setupDebugExportButton()}checkDebugMode(){return new URLSearchParams(window.location.search).get("debug")==="true"}async compareDocuments(i,t){try{this.showProgress("Parsing documents..."),this.currentFileBuffer=await t.arrayBuffer();const[d,a]=await Promise.all([this.parser.parseFile(i),this.parser.parseFile(t)]);this.updateProgress(50,"Comparing documents...");const r=this.diffEngine.diffDocumentsWithDebug(d,a);this.currentDiff=r.diff,this.originalAST=d,this.currentAST=a,this.alignmentDecisions=r.alignmentDecisions,this.updateProgress(75,"Rendering comparison..."),this.renderComparison(r.diff),this.updateProgress(100,"Complete!"),setTimeout(()=>{this.hideProgress(),this.showComparison()},500)}catch(d){console.error("Error comparing documents:",d),alert("Error comparing documents: "+(d instanceof Error?d.message:"Unknown error")),this.hideProgress()}}renderComparison(i){this.renderer||(this.renderer=new re("pane-redlined-content")),this.renderer.renderRedlined(i);const t=this.renderer.getChangeElements();this.navigator?this.navigator.updateChangeElements(t):this.navigator=new ne(t,"prev-change","next-change","change-counter")}showProgress(i){const t=document.getElementById("progress");t&&(t.style.display="block"),this.updateProgress(0,i)}updateProgress(i,t){const d=document.getElementById("progress-fill"),a=document.getElementById("progress-text");d&&(d.style.width=i+"%"),a&&(a.textContent=t)}hideProgress(){const i=document.getElementById("progress");i&&(i.style.display="none")}showComparison(){const i=document.getElementById("comparison"),t=document.getElementById("controls");i&&(i.style.display="flex"),t&&(t.style.display="flex")}setupDocxExportButton(){const i=document.getElementById("export-docx");i&&i.addEventListener("click",()=>this.exportDocx())}setupDebugExportButton(){const i=document.getElementById("export-debug");i&&i.addEventListener("click",()=>this.exportDebugReport())}async exportDocx(){const i=document.getElementById("export-docx");if(!this.currentDiff){alert("Please compare documents first before exporting.");return}if(!this.currentFileBuffer){alert("Current file buffer not available. Please try comparing documents again.");return}this.setButtonLoading(i,!0,"Exporting...");try{await new Promise(t=>setTimeout(t,10)),await this.docxInPlaceExporter.export(this.currentDiff,this.currentFileBuffer,this.originalFileName)}catch(t){console.error("DOCX export failed:",t),alert("Failed to export DOCX. Please try again.")}finally{this.setButtonLoading(i,!1,"Export DOCX")}}exportDebugReport(){if(!this.currentDiff||!this.originalAST||!this.currentAST){alert("Please compare documents first before exporting debug report.");return}const i=this.debugExporter.generateReport(this.originalAST,this.currentAST,this.currentDiff,this.alignmentDecisions,this.originalFileName,this.currentFileName);this.debugExporter.exportToFile(i)}setButtonLoading(i,t,d){i&&(t?(i.classList.add("exporting"),i.innerHTML=`<span class="spinner"></span>${d}`):(i.classList.remove("exporting"),i.textContent=d))}}new ae;
