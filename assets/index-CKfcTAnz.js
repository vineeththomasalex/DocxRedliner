var Wt=Object.defineProperty;var Zt=(U,i,t)=>i in U?Wt(U,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):U[i]=t;var tt=(U,i,t)=>Zt(U,typeof i!="symbol"?i+"":i,t);(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))u(a);new MutationObserver(a=>{for(const e of a)if(e.type==="childList")for(const r of e.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&u(r)}).observe(document,{childList:!0,subtree:!0});function t(a){const e={};return a.integrity&&(e.integrity=a.integrity),a.referrerPolicy&&(e.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?e.credentials="include":a.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function u(a){if(a.ep)return;a.ep=!0;const e=t(a);fetch(a.href,e)}})();class $t{constructor(){tt(this,"originalFile",null);tt(this,"currentFile",null);tt(this,"onBothFilesReady",null);this.initializeUploadHandlers()}initializeUploadHandlers(){const i=document.getElementById("original-upload"),t=document.getElementById("current-upload"),u=i.parentElement?.querySelector(".upload-label"),a=t.parentElement?.querySelector(".upload-label");i.addEventListener("change",e=>{const r=e.target.files?.[0];r&&this.handleOriginalFile(r)}),t.addEventListener("change",e=>{const r=e.target.files?.[0];r&&this.handleCurrentFile(r)}),u&&this.setupDragAndDrop(u,e=>this.handleOriginalFile(e)),a&&this.setupDragAndDrop(a,e=>this.handleCurrentFile(e))}setupDragAndDrop(i,t){i.addEventListener("dragover",u=>{u.preventDefault(),i.classList.add("drag-over")}),i.addEventListener("dragleave",()=>{i.classList.remove("drag-over")}),i.addEventListener("drop",u=>{u.preventDefault(),i.classList.remove("drag-over");const a=u.dataTransfer?.files[0];a&&a.name.endsWith(".docx")?t(a):alert("Please drop a .docx file")})}handleOriginalFile(i){this.originalFile=i,this.updateFileDisplay("original",i.name),this.checkBothFilesReady()}handleCurrentFile(i){this.currentFile=i,this.updateFileDisplay("current",i.name),this.checkBothFilesReady()}updateFileDisplay(i,t){const u=document.getElementById(`${i}-name`),a=document.getElementById(`${i}-upload`)?.parentElement?.querySelector(".upload-label");u&&(u.textContent=t),a&&a.classList.add("has-file")}checkBothFilesReady(){this.originalFile&&this.currentFile&&this.onBothFilesReady&&this.onBothFilesReady(this.originalFile,this.currentFile)}onFilesReady(i){this.onBothFilesReady=i}reset(){this.originalFile=null,this.currentFile=null;const i=document.getElementById("original-upload"),t=document.getElementById("current-upload");i&&(i.value=""),t&&(t.value=""),["original","current"].forEach(u=>{const a=document.getElementById(`${u}-name`),e=document.getElementById(`${u}-upload`)?.parentElement?.querySelector(".upload-label");a&&(a.textContent=""),e&&e.classList.remove("has-file")})}}var Et=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ht(U){return U&&U.__esModule&&Object.prototype.hasOwnProperty.call(U,"default")?U.default:U}function Ct(U){throw new Error('Could not dynamically require "'+U+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var zt={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Pt;function Xt(){return Pt||(Pt=1,(function(U,i){(function(t){U.exports=t()})(function(){return(function t(u,a,e){function r(_,b){if(!a[_]){if(!u[_]){var m=typeof Ct=="function"&&Ct;if(!b&&m)return m(_,!0);if(s)return s(_,!0);var w=new Error("Cannot find module '"+_+"'");throw w.code="MODULE_NOT_FOUND",w}var c=a[_]={exports:{}};u[_][0].call(c.exports,function(g){var l=u[_][1][g];return r(l||g)},c,c.exports,t,u,a,e)}return a[_].exports}for(var s=typeof Ct=="function"&&Ct,d=0;d<e.length;d++)r(e[d]);return r})({1:[function(t,u,a){var e=t("./utils"),r=t("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(d){for(var _,b,m,w,c,g,l,f=[],h=0,v=d.length,k=v,C=e.getTypeOf(d)!=="string";h<d.length;)k=v-h,m=C?(_=d[h++],b=h<v?d[h++]:0,h<v?d[h++]:0):(_=d.charCodeAt(h++),b=h<v?d.charCodeAt(h++):0,h<v?d.charCodeAt(h++):0),w=_>>2,c=(3&_)<<4|b>>4,g=1<k?(15&b)<<2|m>>6:64,l=2<k?63&m:64,f.push(s.charAt(w)+s.charAt(c)+s.charAt(g)+s.charAt(l));return f.join("")},a.decode=function(d){var _,b,m,w,c,g,l=0,f=0,h="data:";if(d.substr(0,h.length)===h)throw new Error("Invalid base64 input, it looks like a data url.");var v,k=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===s.charAt(64)&&k--,d.charAt(d.length-2)===s.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(v=r.uint8array?new Uint8Array(0|k):new Array(0|k);l<d.length;)_=s.indexOf(d.charAt(l++))<<2|(w=s.indexOf(d.charAt(l++)))>>4,b=(15&w)<<4|(c=s.indexOf(d.charAt(l++)))>>2,m=(3&c)<<6|(g=s.indexOf(d.charAt(l++))),v[f++]=_,c!==64&&(v[f++]=b),g!==64&&(v[f++]=m);return v}},{"./support":30,"./utils":32}],2:[function(t,u,a){var e=t("./external"),r=t("./stream/DataWorker"),s=t("./stream/Crc32Probe"),d=t("./stream/DataLengthProbe");function _(b,m,w,c,g){this.compressedSize=b,this.uncompressedSize=m,this.crc32=w,this.compression=c,this.compressedContent=g}_.prototype={getContentWorker:function(){var b=new r(e.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),m=this;return b.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),b},getCompressedWorker:function(){return new r(e.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},_.createWorkerFrom=function(b,m,w){return b.pipe(new s).pipe(new d("uncompressedSize")).pipe(m.compressWorker(w)).pipe(new d("compressedSize")).withStreamInfo("compression",m)},u.exports=_},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,u,a){var e=t("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new e("STORE compression")},uncompressWorker:function(){return new e("STORE decompression")}},a.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,u,a){var e=t("./utils"),r=(function(){for(var s,d=[],_=0;_<256;_++){s=_;for(var b=0;b<8;b++)s=1&s?3988292384^s>>>1:s>>>1;d[_]=s}return d})();u.exports=function(s,d){return s!==void 0&&s.length?e.getTypeOf(s)!=="string"?(function(_,b,m,w){var c=r,g=w+m;_^=-1;for(var l=w;l<g;l++)_=_>>>8^c[255&(_^b[l])];return-1^_})(0|d,s,s.length,0):(function(_,b,m,w){var c=r,g=w+m;_^=-1;for(var l=w;l<g;l++)_=_>>>8^c[255&(_^b.charCodeAt(l))];return-1^_})(0|d,s,s.length,0):0}},{"./utils":32}],5:[function(t,u,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(t,u,a){var e=null;e=typeof Promise<"u"?Promise:t("lie"),u.exports={Promise:e}},{lie:37}],7:[function(t,u,a){var e=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",r=t("pako"),s=t("./utils"),d=t("./stream/GenericWorker"),_=e?"uint8array":"array";function b(m,w){d.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=w,this.meta={}}a.magic="\b\0",s.inherits(b,d),b.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(_,m.data),!1)},b.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},b.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},b.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(w){m.push({data:w,meta:m.meta})}},a.compressWorker=function(m){return new b("Deflate",m)},a.uncompressWorker=function(){return new b("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,u,a){function e(c,g){var l,f="";for(l=0;l<g;l++)f+=String.fromCharCode(255&c),c>>>=8;return f}function r(c,g,l,f,h,v){var k,C,S=c.file,F=c.compression,O=v!==_.utf8encode,j=s.transformTo("string",v(S.name)),T=s.transformTo("string",_.utf8encode(S.name)),Z=S.comment,K=s.transformTo("string",v(Z)),x=s.transformTo("string",_.utf8encode(Z)),R=T.length!==S.name.length,o=x.length!==Z.length,D="",Q="",M="",et=S.dir,W=S.date,J={crc32:0,compressedSize:0,uncompressedSize:0};g&&!l||(J.crc32=c.crc32,J.compressedSize=c.compressedSize,J.uncompressedSize=c.uncompressedSize);var A=0;g&&(A|=8),O||!R&&!o||(A|=2048);var z=0,Y=0;et&&(z|=16),h==="UNIX"?(Y=798,z|=(function(X,at){var ht=X;return X||(ht=at?16893:33204),(65535&ht)<<16})(S.unixPermissions,et)):(Y=20,z|=(function(X){return 63&(X||0)})(S.dosPermissions)),k=W.getUTCHours(),k<<=6,k|=W.getUTCMinutes(),k<<=5,k|=W.getUTCSeconds()/2,C=W.getUTCFullYear()-1980,C<<=4,C|=W.getUTCMonth()+1,C<<=5,C|=W.getUTCDate(),R&&(Q=e(1,1)+e(b(j),4)+T,D+="up"+e(Q.length,2)+Q),o&&(M=e(1,1)+e(b(K),4)+x,D+="uc"+e(M.length,2)+M);var q="";return q+=`
\0`,q+=e(A,2),q+=F.magic,q+=e(k,2),q+=e(C,2),q+=e(J.crc32,4),q+=e(J.compressedSize,4),q+=e(J.uncompressedSize,4),q+=e(j.length,2),q+=e(D.length,2),{fileRecord:m.LOCAL_FILE_HEADER+q+j+D,dirRecord:m.CENTRAL_FILE_HEADER+e(Y,2)+q+e(K.length,2)+"\0\0\0\0"+e(z,4)+e(f,4)+j+D+K}}var s=t("../utils"),d=t("../stream/GenericWorker"),_=t("../utf8"),b=t("../crc32"),m=t("../signature");function w(c,g,l,f){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=l,this.encodeFileName=f,this.streamFiles=c,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(w,d),w.prototype.push=function(c){var g=c.meta.percent||0,l=this.entriesCount,f=this._sources.length;this.accumulate?this.contentBuffer.push(c):(this.bytesWritten+=c.data.length,d.prototype.push.call(this,{data:c.data,meta:{currentFile:this.currentFile,percent:l?(g+100*(l-f-1))/l:100}}))},w.prototype.openedSource=function(c){this.currentSourceOffset=this.bytesWritten,this.currentFile=c.file.name;var g=this.streamFiles&&!c.file.dir;if(g){var l=r(c,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:l.fileRecord,meta:{percent:0}})}else this.accumulate=!0},w.prototype.closedSource=function(c){this.accumulate=!1;var g=this.streamFiles&&!c.file.dir,l=r(c,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(l.dirRecord),g)this.push({data:(function(f){return m.DATA_DESCRIPTOR+e(f.crc32,4)+e(f.compressedSize,4)+e(f.uncompressedSize,4)})(c),meta:{percent:100}});else for(this.push({data:l.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},w.prototype.flush=function(){for(var c=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var l=this.bytesWritten-c,f=(function(h,v,k,C,S){var F=s.transformTo("string",S(C));return m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+e(h,2)+e(h,2)+e(v,4)+e(k,4)+e(F.length,2)+F})(this.dirRecords.length,l,c,this.zipComment,this.encodeFileName);this.push({data:f,meta:{percent:100}})},w.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},w.prototype.registerPrevious=function(c){this._sources.push(c);var g=this;return c.on("data",function(l){g.processChunk(l)}),c.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),c.on("error",function(l){g.error(l)}),this},w.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},w.prototype.error=function(c){var g=this._sources;if(!d.prototype.error.call(this,c))return!1;for(var l=0;l<g.length;l++)try{g[l].error(c)}catch{}return!0},w.prototype.lock=function(){d.prototype.lock.call(this);for(var c=this._sources,g=0;g<c.length;g++)c[g].lock()},u.exports=w},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,u,a){var e=t("../compressions"),r=t("./ZipFileWorker");a.generateWorker=function(s,d,_){var b=new r(d.streamFiles,_,d.platform,d.encodeFileName),m=0;try{s.forEach(function(w,c){m++;var g=(function(v,k){var C=v||k,S=e[C];if(!S)throw new Error(C+" is not a valid compression method !");return S})(c.options.compression,d.compression),l=c.options.compressionOptions||d.compressionOptions||{},f=c.dir,h=c.date;c._compressWorker(g,l).withStreamInfo("file",{name:w,dir:f,date:h,comment:c.comment||"",unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions}).pipe(b)}),b.entriesCount=m}catch(w){b.error(w)}return b}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,u,a){function e(){if(!(this instanceof e))return new e;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var r=new e;for(var s in this)typeof this[s]!="function"&&(r[s]=this[s]);return r}}(e.prototype=t("./object")).loadAsync=t("./load"),e.support=t("./support"),e.defaults=t("./defaults"),e.version="3.10.1",e.loadAsync=function(r,s){return new e().loadAsync(r,s)},e.external=t("./external"),u.exports=e},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,u,a){var e=t("./utils"),r=t("./external"),s=t("./utf8"),d=t("./zipEntries"),_=t("./stream/Crc32Probe"),b=t("./nodejsUtils");function m(w){return new r.Promise(function(c,g){var l=w.decompressed.getContentWorker().pipe(new _);l.on("error",function(f){g(f)}).on("end",function(){l.streamInfo.crc32!==w.decompressed.crc32?g(new Error("Corrupted zip : CRC32 mismatch")):c()}).resume()})}u.exports=function(w,c){var g=this;return c=e.extend(c||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),b.isNode&&b.isStream(w)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):e.prepareContent("the loaded zip file",w,!0,c.optimizedBinaryString,c.base64).then(function(l){var f=new d(c);return f.load(l),f}).then(function(l){var f=[r.Promise.resolve(l)],h=l.files;if(c.checkCRC32)for(var v=0;v<h.length;v++)f.push(m(h[v]));return r.Promise.all(f)}).then(function(l){for(var f=l.shift(),h=f.files,v=0;v<h.length;v++){var k=h[v],C=k.fileNameStr,S=e.resolve(k.fileNameStr);g.file(S,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:c.createFolders}),k.dir||(g.file(S).unsafeOriginalName=C)}return f.zipComment.length&&(g.comment=f.zipComment),g})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,u,a){var e=t("../utils"),r=t("../stream/GenericWorker");function s(d,_){r.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(_)}e.inherits(s,r),s.prototype._bindStream=function(d){var _=this;(this._stream=d).pause(),d.on("data",function(b){_.push({data:b,meta:{percent:0}})}).on("error",function(b){_.isPaused?this.generatedError=b:_.error(b)}).on("end",function(){_.isPaused?_._upstreamEnded=!0:_.end()})},s.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},u.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,u,a){var e=t("readable-stream").Readable;function r(s,d,_){e.call(this,d),this._helper=s;var b=this;s.on("data",function(m,w){b.push(m)||b._helper.pause(),_&&_(w)}).on("error",function(m){b.emit("error",m)}).on("end",function(){b.push(null)})}t("../utils").inherits(r,e),r.prototype._read=function(){this._helper.resume()},u.exports=r},{"../utils":32,"readable-stream":16}],14:[function(t,u,a){u.exports={isNode:typeof Buffer<"u",newBufferFrom:function(e,r){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,r);if(typeof e=="number")throw new Error('The "data" argument must not be a number');return new Buffer(e,r)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var r=new Buffer(e);return r.fill(0),r},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&typeof e.on=="function"&&typeof e.pause=="function"&&typeof e.resume=="function"}}},{}],15:[function(t,u,a){function e(S,F,O){var j,T=s.getTypeOf(F),Z=s.extend(O||{},b);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(S=h(S)),Z.createFolders&&(j=f(S))&&v.call(this,j,!0);var K=T==="string"&&Z.binary===!1&&Z.base64===!1;O&&O.binary!==void 0||(Z.binary=!K),(F instanceof m&&F.uncompressedSize===0||Z.dir||!F||F.length===0)&&(Z.base64=!1,Z.binary=!0,F="",Z.compression="STORE",T="string");var x=null;x=F instanceof m||F instanceof d?F:g.isNode&&g.isStream(F)?new l(S,F):s.prepareContent(S,F,Z.binary,Z.optimizedBinaryString,Z.base64);var R=new w(S,x,Z);this.files[S]=R}var r=t("./utf8"),s=t("./utils"),d=t("./stream/GenericWorker"),_=t("./stream/StreamHelper"),b=t("./defaults"),m=t("./compressedObject"),w=t("./zipObject"),c=t("./generate"),g=t("./nodejsUtils"),l=t("./nodejs/NodejsStreamInputAdapter"),f=function(S){S.slice(-1)==="/"&&(S=S.substring(0,S.length-1));var F=S.lastIndexOf("/");return 0<F?S.substring(0,F):""},h=function(S){return S.slice(-1)!=="/"&&(S+="/"),S},v=function(S,F){return F=F!==void 0?F:b.createFolders,S=h(S),this.files[S]||e.call(this,S,null,{dir:!0,createFolders:F}),this.files[S]};function k(S){return Object.prototype.toString.call(S)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(S){var F,O,j;for(F in this.files)j=this.files[F],(O=F.slice(this.root.length,F.length))&&F.slice(0,this.root.length)===this.root&&S(O,j)},filter:function(S){var F=[];return this.forEach(function(O,j){S(O,j)&&F.push(j)}),F},file:function(S,F,O){if(arguments.length!==1)return S=this.root+S,e.call(this,S,F,O),this;if(k(S)){var j=S;return this.filter(function(Z,K){return!K.dir&&j.test(Z)})}var T=this.files[this.root+S];return T&&!T.dir?T:null},folder:function(S){if(!S)return this;if(k(S))return this.filter(function(T,Z){return Z.dir&&S.test(T)});var F=this.root+S,O=v.call(this,F),j=this.clone();return j.root=O.name,j},remove:function(S){S=this.root+S;var F=this.files[S];if(F||(S.slice(-1)!=="/"&&(S+="/"),F=this.files[S]),F&&!F.dir)delete this.files[S];else for(var O=this.filter(function(T,Z){return Z.name.slice(0,S.length)===S}),j=0;j<O.length;j++)delete this.files[O[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(S){var F,O={};try{if((O=s.extend(S||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=O.type.toLowerCase(),O.compression=O.compression.toUpperCase(),O.type==="binarystring"&&(O.type="string"),!O.type)throw new Error("No output type specified.");s.checkSupport(O.type),O.platform!=="darwin"&&O.platform!=="freebsd"&&O.platform!=="linux"&&O.platform!=="sunos"||(O.platform="UNIX"),O.platform==="win32"&&(O.platform="DOS");var j=O.comment||this.comment||"";F=c.generateWorker(this,O,j)}catch(T){(F=new d("error")).error(T)}return new _(F,O.type||"string",O.mimeType)},generateAsync:function(S,F){return this.generateInternalStream(S).accumulate(F)},generateNodeStream:function(S,F){return(S=S||{}).type||(S.type="nodebuffer"),this.generateInternalStream(S).toNodejsStream(F)}};u.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,u,a){u.exports=t("stream")},{stream:void 0}],17:[function(t,u,a){var e=t("./DataReader");function r(s){e.call(this,s);for(var d=0;d<this.data.length;d++)s[d]=255&s[d]}t("../utils").inherits(r,e),r.prototype.byteAt=function(s){return this.data[this.zero+s]},r.prototype.lastIndexOfSignature=function(s){for(var d=s.charCodeAt(0),_=s.charCodeAt(1),b=s.charCodeAt(2),m=s.charCodeAt(3),w=this.length-4;0<=w;--w)if(this.data[w]===d&&this.data[w+1]===_&&this.data[w+2]===b&&this.data[w+3]===m)return w-this.zero;return-1},r.prototype.readAndCheckSignature=function(s){var d=s.charCodeAt(0),_=s.charCodeAt(1),b=s.charCodeAt(2),m=s.charCodeAt(3),w=this.readData(4);return d===w[0]&&_===w[1]&&b===w[2]&&m===w[3]},r.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,d},u.exports=r},{"../utils":32,"./DataReader":18}],18:[function(t,u,a){var e=t("../utils");function r(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var d,_=0;for(this.checkOffset(s),d=this.index+s-1;d>=this.index;d--)_=(_<<8)+this.byteAt(d);return this.index+=s,_},readString:function(s){return e.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},u.exports=r},{"../utils":32}],19:[function(t,u,a){var e=t("./Uint8ArrayReader");function r(s){e.call(this,s)}t("../utils").inherits(r,e),r.prototype.readData=function(s){this.checkOffset(s);var d=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,d},u.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,u,a){var e=t("./DataReader");function r(s){e.call(this,s)}t("../utils").inherits(r,e),r.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},r.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},r.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},r.prototype.readData=function(s){this.checkOffset(s);var d=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,d},u.exports=r},{"../utils":32,"./DataReader":18}],21:[function(t,u,a){var e=t("./ArrayReader");function r(s){e.call(this,s)}t("../utils").inherits(r,e),r.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,d},u.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(t,u,a){var e=t("../utils"),r=t("../support"),s=t("./ArrayReader"),d=t("./StringReader"),_=t("./NodeBufferReader"),b=t("./Uint8ArrayReader");u.exports=function(m){var w=e.getTypeOf(m);return e.checkSupport(w),w!=="string"||r.uint8array?w==="nodebuffer"?new _(m):r.uint8array?new b(e.transformTo("uint8array",m)):new s(e.transformTo("array",m)):new d(m)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,u,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,u,a){var e=t("./GenericWorker"),r=t("../utils");function s(d){e.call(this,"ConvertWorker to "+d),this.destType=d}r.inherits(s,e),s.prototype.processChunk=function(d){this.push({data:r.transformTo(this.destType,d.data),meta:d.meta})},u.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(t,u,a){var e=t("./GenericWorker"),r=t("../crc32");function s(){e.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(s,e),s.prototype.processChunk=function(d){this.streamInfo.crc32=r(d.data,this.streamInfo.crc32||0),this.push(d)},u.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,u,a){var e=t("../utils"),r=t("./GenericWorker");function s(d){r.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}e.inherits(s,r),s.prototype.processChunk=function(d){if(d){var _=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=_+d.data.length}r.prototype.processChunk.call(this,d)},u.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(t,u,a){var e=t("../utils"),r=t("./GenericWorker");function s(d){r.call(this,"DataWorker");var _=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(b){_.dataIsReady=!0,_.data=b,_.max=b&&b.length||0,_.type=e.getTypeOf(b),_.isPaused||_._tickAndRepeat()},function(b){_.error(b)})}e.inherits(s,r),s.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,e.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(e.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,_=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,_);break;case"uint8array":d=this.data.subarray(this.index,_);break;case"array":case"nodebuffer":d=this.data.slice(this.index,_)}return this.index=_,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},u.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(t,u,a){function e(r){this.name=r||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}e.prototype={push:function(r){this.emit("data",r)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(r){this.emit("error",r)}return!0},error:function(r){return!this.isFinished&&(this.isPaused?this.generatedError=r:(this.isFinished=!0,this.emit("error",r),this.previous&&this.previous.error(r),this.cleanUp()),!0)},on:function(r,s){return this._listeners[r].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(r,s){if(this._listeners[r])for(var d=0;d<this._listeners[r].length;d++)this._listeners[r][d].call(this,s)},pipe:function(r){return r.registerPrevious(this)},registerPrevious:function(r){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=r.streamInfo,this.mergeStreamInfo(),this.previous=r;var s=this;return r.on("data",function(d){s.processChunk(d)}),r.on("end",function(){s.end()}),r.on("error",function(d){s.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var r=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),r=!0),this.previous&&this.previous.resume(),!r},flush:function(){},processChunk:function(r){this.push(r)},withStreamInfo:function(r,s){return this.extraStreamInfo[r]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var r in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,r)&&(this.streamInfo[r]=this.extraStreamInfo[r])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var r="Worker "+this.name;return this.previous?this.previous+" -> "+r:r}},u.exports=e},{}],29:[function(t,u,a){var e=t("../utils"),r=t("./ConvertWorker"),s=t("./GenericWorker"),d=t("../base64"),_=t("../support"),b=t("../external"),m=null;if(_.nodestream)try{m=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function w(g,l){return new b.Promise(function(f,h){var v=[],k=g._internalType,C=g._outputType,S=g._mimeType;g.on("data",function(F,O){v.push(F),l&&l(O)}).on("error",function(F){v=[],h(F)}).on("end",function(){try{var F=(function(O,j,T){switch(O){case"blob":return e.newBlob(e.transformTo("arraybuffer",j),T);case"base64":return d.encode(j);default:return e.transformTo(O,j)}})(C,(function(O,j){var T,Z=0,K=null,x=0;for(T=0;T<j.length;T++)x+=j[T].length;switch(O){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(K=new Uint8Array(x),T=0;T<j.length;T++)K.set(j[T],Z),Z+=j[T].length;return K;case"nodebuffer":return Buffer.concat(j);default:throw new Error("concat : unsupported type '"+O+"'")}})(k,v),S);f(F)}catch(O){h(O)}v=[]}).resume()})}function c(g,l,f){var h=l;switch(l){case"blob":case"arraybuffer":h="uint8array";break;case"base64":h="string"}try{this._internalType=h,this._outputType=l,this._mimeType=f,e.checkSupport(h),this._worker=g.pipe(new r(h)),g.lock()}catch(v){this._worker=new s("error"),this._worker.error(v)}}c.prototype={accumulate:function(g){return w(this,g)},on:function(g,l){var f=this;return g==="data"?this._worker.on(g,function(h){l.call(f,h.data,h.meta)}):this._worker.on(g,function(){e.delay(l,arguments,f)}),this},resume:function(){return e.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(e.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},g)}},u.exports=c},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,u,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var e=new ArrayBuffer(0);try{a.blob=new Blob([e],{type:"application/zip"}).size===0}catch{try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(e),a.blob=r.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!t("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(t,u,a){for(var e=t("./utils"),r=t("./support"),s=t("./nodejsUtils"),d=t("./stream/GenericWorker"),_=new Array(256),b=0;b<256;b++)_[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;_[254]=_[254]=1;function m(){d.call(this,"utf-8 decode"),this.leftOver=null}function w(){d.call(this,"utf-8 encode")}a.utf8encode=function(c){return r.nodebuffer?s.newBufferFrom(c,"utf-8"):(function(g){var l,f,h,v,k,C=g.length,S=0;for(v=0;v<C;v++)(64512&(f=g.charCodeAt(v)))==55296&&v+1<C&&(64512&(h=g.charCodeAt(v+1)))==56320&&(f=65536+(f-55296<<10)+(h-56320),v++),S+=f<128?1:f<2048?2:f<65536?3:4;for(l=r.uint8array?new Uint8Array(S):new Array(S),v=k=0;k<S;v++)(64512&(f=g.charCodeAt(v)))==55296&&v+1<C&&(64512&(h=g.charCodeAt(v+1)))==56320&&(f=65536+(f-55296<<10)+(h-56320),v++),f<128?l[k++]=f:(f<2048?l[k++]=192|f>>>6:(f<65536?l[k++]=224|f>>>12:(l[k++]=240|f>>>18,l[k++]=128|f>>>12&63),l[k++]=128|f>>>6&63),l[k++]=128|63&f);return l})(c)},a.utf8decode=function(c){return r.nodebuffer?e.transformTo("nodebuffer",c).toString("utf-8"):(function(g){var l,f,h,v,k=g.length,C=new Array(2*k);for(l=f=0;l<k;)if((h=g[l++])<128)C[f++]=h;else if(4<(v=_[h]))C[f++]=65533,l+=v-1;else{for(h&=v===2?31:v===3?15:7;1<v&&l<k;)h=h<<6|63&g[l++],v--;1<v?C[f++]=65533:h<65536?C[f++]=h:(h-=65536,C[f++]=55296|h>>10&1023,C[f++]=56320|1023&h)}return C.length!==f&&(C.subarray?C=C.subarray(0,f):C.length=f),e.applyFromCharCode(C)})(c=e.transformTo(r.uint8array?"uint8array":"array",c))},e.inherits(m,d),m.prototype.processChunk=function(c){var g=e.transformTo(r.uint8array?"uint8array":"array",c.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var l=g;(g=new Uint8Array(l.length+this.leftOver.length)).set(this.leftOver,0),g.set(l,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var f=(function(v,k){var C;for((k=k||v.length)>v.length&&(k=v.length),C=k-1;0<=C&&(192&v[C])==128;)C--;return C<0||C===0?k:C+_[v[C]]>k?C:k})(g),h=g;f!==g.length&&(r.uint8array?(h=g.subarray(0,f),this.leftOver=g.subarray(f,g.length)):(h=g.slice(0,f),this.leftOver=g.slice(f,g.length))),this.push({data:a.utf8decode(h),meta:c.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=m,e.inherits(w,d),w.prototype.processChunk=function(c){this.push({data:a.utf8encode(c.data),meta:c.meta})},a.Utf8EncodeWorker=w},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,u,a){var e=t("./support"),r=t("./base64"),s=t("./nodejsUtils"),d=t("./external");function _(l){return l}function b(l,f){for(var h=0;h<l.length;++h)f[h]=255&l.charCodeAt(h);return f}t("setimmediate"),a.newBlob=function(l,f){a.checkSupport("blob");try{return new Blob([l],{type:f})}catch{try{var h=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return h.append(l),h.getBlob(f)}catch{throw new Error("Bug : can't construct the Blob.")}}};var m={stringifyByChunk:function(l,f,h){var v=[],k=0,C=l.length;if(C<=h)return String.fromCharCode.apply(null,l);for(;k<C;)f==="array"||f==="nodebuffer"?v.push(String.fromCharCode.apply(null,l.slice(k,Math.min(k+h,C)))):v.push(String.fromCharCode.apply(null,l.subarray(k,Math.min(k+h,C)))),k+=h;return v.join("")},stringifyByChar:function(l){for(var f="",h=0;h<l.length;h++)f+=String.fromCharCode(l[h]);return f},applyCanBeUsed:{uint8array:(function(){try{return e.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return e.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}})()}};function w(l){var f=65536,h=a.getTypeOf(l),v=!0;if(h==="uint8array"?v=m.applyCanBeUsed.uint8array:h==="nodebuffer"&&(v=m.applyCanBeUsed.nodebuffer),v)for(;1<f;)try{return m.stringifyByChunk(l,h,f)}catch{f=Math.floor(f/2)}return m.stringifyByChar(l)}function c(l,f){for(var h=0;h<l.length;h++)f[h]=l[h];return f}a.applyFromCharCode=w;var g={};g.string={string:_,array:function(l){return b(l,new Array(l.length))},arraybuffer:function(l){return g.string.uint8array(l).buffer},uint8array:function(l){return b(l,new Uint8Array(l.length))},nodebuffer:function(l){return b(l,s.allocBuffer(l.length))}},g.array={string:w,array:_,arraybuffer:function(l){return new Uint8Array(l).buffer},uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return s.newBufferFrom(l)}},g.arraybuffer={string:function(l){return w(new Uint8Array(l))},array:function(l){return c(new Uint8Array(l),new Array(l.byteLength))},arraybuffer:_,uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return s.newBufferFrom(new Uint8Array(l))}},g.uint8array={string:w,array:function(l){return c(l,new Array(l.length))},arraybuffer:function(l){return l.buffer},uint8array:_,nodebuffer:function(l){return s.newBufferFrom(l)}},g.nodebuffer={string:w,array:function(l){return c(l,new Array(l.length))},arraybuffer:function(l){return g.nodebuffer.uint8array(l).buffer},uint8array:function(l){return c(l,new Uint8Array(l.length))},nodebuffer:_},a.transformTo=function(l,f){if(f=f||"",!l)return f;a.checkSupport(l);var h=a.getTypeOf(f);return g[h][l](f)},a.resolve=function(l){for(var f=l.split("/"),h=[],v=0;v<f.length;v++){var k=f[v];k==="."||k===""&&v!==0&&v!==f.length-1||(k===".."?h.pop():h.push(k))}return h.join("/")},a.getTypeOf=function(l){return typeof l=="string"?"string":Object.prototype.toString.call(l)==="[object Array]"?"array":e.nodebuffer&&s.isBuffer(l)?"nodebuffer":e.uint8array&&l instanceof Uint8Array?"uint8array":e.arraybuffer&&l instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(l){if(!e[l.toLowerCase()])throw new Error(l+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(l){var f,h,v="";for(h=0;h<(l||"").length;h++)v+="\\x"+((f=l.charCodeAt(h))<16?"0":"")+f.toString(16).toUpperCase();return v},a.delay=function(l,f,h){setImmediate(function(){l.apply(h||null,f||[])})},a.inherits=function(l,f){function h(){}h.prototype=f.prototype,l.prototype=new h},a.extend=function(){var l,f,h={};for(l=0;l<arguments.length;l++)for(f in arguments[l])Object.prototype.hasOwnProperty.call(arguments[l],f)&&h[f]===void 0&&(h[f]=arguments[l][f]);return h},a.prepareContent=function(l,f,h,v,k){return d.Promise.resolve(f).then(function(C){return e.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new d.Promise(function(S,F){var O=new FileReader;O.onload=function(j){S(j.target.result)},O.onerror=function(j){F(j.target.error)},O.readAsArrayBuffer(C)}):C}).then(function(C){var S=a.getTypeOf(C);return S?(S==="arraybuffer"?C=a.transformTo("uint8array",C):S==="string"&&(k?C=r.decode(C):h&&v!==!0&&(C=(function(F){return b(F,e.uint8array?new Uint8Array(F.length):new Array(F.length))})(C))),C):d.Promise.reject(new Error("Can't read the data of '"+l+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,u,a){var e=t("./reader/readerFor"),r=t("./utils"),s=t("./signature"),d=t("./zipEntry"),_=t("./support");function b(m){this.files=[],this.loadOptions=m}b.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var w=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(w)+", expected "+r.pretty(m)+")")}},isSignature:function(m,w){var c=this.reader.index;this.reader.setIndex(m);var g=this.reader.readString(4)===w;return this.reader.setIndex(c),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),w=_.uint8array?"uint8array":"array",c=r.transformTo(w,m);this.zipComment=this.loadOptions.decodeFileName(c)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m,w,c,g=this.zip64EndOfCentralSize-44;0<g;)m=this.reader.readInt(2),w=this.reader.readInt(4),c=this.reader.readData(w),this.zip64ExtensibleData[m]={id:m,length:w,value:c}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,w;for(m=0;m<this.files.length;m++)w=this.files[m],this.reader.setIndex(w.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),w.readLocalPart(this.reader),w.handleUTF8(),w.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(m=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(m<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(m);var w=m;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(m=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var c=this.centralDirOffset+this.centralDirSize;this.zip64&&(c+=20,c+=12+this.zip64EndOfCentralSize);var g=w-c;if(0<g)this.isSignature(w,s.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw new Error("Corrupted zip: missing "+Math.abs(g)+" bytes.")},prepareReader:function(m){this.reader=e(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},u.exports=b},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,u,a){var e=t("./reader/readerFor"),r=t("./utils"),s=t("./compressedObject"),d=t("./crc32"),_=t("./utf8"),b=t("./compressions"),m=t("./support");function w(c,g){this.options=c,this.loadOptions=g}w.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(c){var g,l;if(c.skip(22),this.fileNameLength=c.readInt(2),l=c.readInt(2),this.fileName=c.readData(this.fileNameLength),c.skip(l),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((g=(function(f){for(var h in b)if(Object.prototype.hasOwnProperty.call(b,h)&&b[h].magic===f)return b[h];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,g,c.readData(this.compressedSize))},readCentralPart:function(c){this.versionMadeBy=c.readInt(2),c.skip(2),this.bitFlag=c.readInt(2),this.compressionMethod=c.readString(2),this.date=c.readDate(),this.crc32=c.readInt(4),this.compressedSize=c.readInt(4),this.uncompressedSize=c.readInt(4);var g=c.readInt(2);if(this.extraFieldsLength=c.readInt(2),this.fileCommentLength=c.readInt(2),this.diskNumberStart=c.readInt(2),this.internalFileAttributes=c.readInt(2),this.externalFileAttributes=c.readInt(4),this.localHeaderOffset=c.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");c.skip(g),this.readExtraFields(c),this.parseZIP64ExtraField(c),this.fileComment=c.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var c=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),c==0&&(this.dosPermissions=63&this.externalFileAttributes),c==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var c=e(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=c.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=c.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=c.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=c.readInt(4))}},readExtraFields:function(c){var g,l,f,h=c.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});c.index+4<h;)g=c.readInt(2),l=c.readInt(2),f=c.readData(l),this.extraFields[g]={id:g,length:l,value:f};c.setIndex(h)},handleUTF8:function(){var c=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=_.utf8decode(this.fileName),this.fileCommentStr=_.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var l=r.transformTo(c,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(l)}var f=this.findExtraFieldUnicodeComment();if(f!==null)this.fileCommentStr=f;else{var h=r.transformTo(c,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(h)}}},findExtraFieldUnicodePath:function(){var c=this.extraFields[28789];if(c){var g=e(c.value);return g.readInt(1)!==1||d(this.fileName)!==g.readInt(4)?null:_.utf8decode(g.readData(c.length-5))}return null},findExtraFieldUnicodeComment:function(){var c=this.extraFields[25461];if(c){var g=e(c.value);return g.readInt(1)!==1||d(this.fileComment)!==g.readInt(4)?null:_.utf8decode(g.readData(c.length-5))}return null}},u.exports=w},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,u,a){function e(g,l,f){this.name=g,this.dir=f.dir,this.date=f.date,this.comment=f.comment,this.unixPermissions=f.unixPermissions,this.dosPermissions=f.dosPermissions,this._data=l,this._dataBinary=f.binary,this.options={compression:f.compression,compressionOptions:f.compressionOptions}}var r=t("./stream/StreamHelper"),s=t("./stream/DataWorker"),d=t("./utf8"),_=t("./compressedObject"),b=t("./stream/GenericWorker");e.prototype={internalStream:function(g){var l=null,f="string";try{if(!g)throw new Error("No output type specified.");var h=(f=g.toLowerCase())==="string"||f==="text";f!=="binarystring"&&f!=="text"||(f="string"),l=this._decompressWorker();var v=!this._dataBinary;v&&!h&&(l=l.pipe(new d.Utf8EncodeWorker)),!v&&h&&(l=l.pipe(new d.Utf8DecodeWorker))}catch(k){(l=new b("error")).error(k)}return new r(l,f,"")},async:function(g,l){return this.internalStream(g).accumulate(l)},nodeStream:function(g,l){return this.internalStream(g||"nodebuffer").toNodejsStream(l)},_compressWorker:function(g,l){if(this._data instanceof _&&this._data.compression.magic===g.magic)return this._data.getCompressedWorker();var f=this._decompressWorker();return this._dataBinary||(f=f.pipe(new d.Utf8EncodeWorker)),_.createWorkerFrom(f,g,l)},_decompressWorker:function(){return this._data instanceof _?this._data.getContentWorker():this._data instanceof b?this._data:new s(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],w=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},c=0;c<m.length;c++)e.prototype[m[c]]=w;u.exports=e},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,u,a){(function(e){var r,s,d=e.MutationObserver||e.WebKitMutationObserver;if(d){var _=0,b=new d(g),m=e.document.createTextNode("");b.observe(m,{characterData:!0}),r=function(){m.data=_=++_%2}}else if(e.setImmediate||e.MessageChannel===void 0)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var l=e.document.createElement("script");l.onreadystatechange=function(){g(),l.onreadystatechange=null,l.parentNode.removeChild(l),l=null},e.document.documentElement.appendChild(l)}:function(){setTimeout(g,0)};else{var w=new e.MessageChannel;w.port1.onmessage=g,r=function(){w.port2.postMessage(0)}}var c=[];function g(){var l,f;s=!0;for(var h=c.length;h;){for(f=c,c=[],l=-1;++l<h;)f[l]();h=c.length}s=!1}u.exports=function(l){c.push(l)!==1||s||r()}}).call(this,typeof Et<"u"?Et:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,u,a){var e=t("immediate");function r(){}var s={},d=["REJECTED"],_=["FULFILLED"],b=["PENDING"];function m(h){if(typeof h!="function")throw new TypeError("resolver must be a function");this.state=b,this.queue=[],this.outcome=void 0,h!==r&&l(this,h)}function w(h,v,k){this.promise=h,typeof v=="function"&&(this.onFulfilled=v,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function c(h,v,k){e(function(){var C;try{C=v(k)}catch(S){return s.reject(h,S)}C===h?s.reject(h,new TypeError("Cannot resolve promise with itself")):s.resolve(h,C)})}function g(h){var v=h&&h.then;if(h&&(typeof h=="object"||typeof h=="function")&&typeof v=="function")return function(){v.apply(h,arguments)}}function l(h,v){var k=!1;function C(O){k||(k=!0,s.reject(h,O))}function S(O){k||(k=!0,s.resolve(h,O))}var F=f(function(){v(S,C)});F.status==="error"&&C(F.value)}function f(h,v){var k={};try{k.value=h(v),k.status="success"}catch(C){k.status="error",k.value=C}return k}(u.exports=m).prototype.finally=function(h){if(typeof h!="function")return this;var v=this.constructor;return this.then(function(k){return v.resolve(h()).then(function(){return k})},function(k){return v.resolve(h()).then(function(){throw k})})},m.prototype.catch=function(h){return this.then(null,h)},m.prototype.then=function(h,v){if(typeof h!="function"&&this.state===_||typeof v!="function"&&this.state===d)return this;var k=new this.constructor(r);return this.state!==b?c(k,this.state===_?h:v,this.outcome):this.queue.push(new w(k,h,v)),k},w.prototype.callFulfilled=function(h){s.resolve(this.promise,h)},w.prototype.otherCallFulfilled=function(h){c(this.promise,this.onFulfilled,h)},w.prototype.callRejected=function(h){s.reject(this.promise,h)},w.prototype.otherCallRejected=function(h){c(this.promise,this.onRejected,h)},s.resolve=function(h,v){var k=f(g,v);if(k.status==="error")return s.reject(h,k.value);var C=k.value;if(C)l(h,C);else{h.state=_,h.outcome=v;for(var S=-1,F=h.queue.length;++S<F;)h.queue[S].callFulfilled(v)}return h},s.reject=function(h,v){h.state=d,h.outcome=v;for(var k=-1,C=h.queue.length;++k<C;)h.queue[k].callRejected(v);return h},m.resolve=function(h){return h instanceof this?h:s.resolve(new this(r),h)},m.reject=function(h){var v=new this(r);return s.reject(v,h)},m.all=function(h){var v=this;if(Object.prototype.toString.call(h)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=h.length,C=!1;if(!k)return this.resolve([]);for(var S=new Array(k),F=0,O=-1,j=new this(r);++O<k;)T(h[O],O);return j;function T(Z,K){v.resolve(Z).then(function(x){S[K]=x,++F!==k||C||(C=!0,s.resolve(j,S))},function(x){C||(C=!0,s.reject(j,x))})}},m.race=function(h){var v=this;if(Object.prototype.toString.call(h)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=h.length,C=!1;if(!k)return this.resolve([]);for(var S=-1,F=new this(r);++S<k;)O=h[S],v.resolve(O).then(function(j){C||(C=!0,s.resolve(F,j))},function(j){C||(C=!0,s.reject(F,j))});var O;return F}},{immediate:36}],38:[function(t,u,a){var e={};(0,t("./lib/utils/common").assign)(e,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),u.exports=e},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,u,a){var e=t("./zlib/deflate"),r=t("./utils/common"),s=t("./utils/strings"),d=t("./zlib/messages"),_=t("./zlib/zstream"),b=Object.prototype.toString,m=0,w=-1,c=0,g=8;function l(h){if(!(this instanceof l))return new l(h);this.options=r.assign({level:w,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:c,to:""},h||{});var v=this.options;v.raw&&0<v.windowBits?v.windowBits=-v.windowBits:v.gzip&&0<v.windowBits&&v.windowBits<16&&(v.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var k=e.deflateInit2(this.strm,v.level,v.method,v.windowBits,v.memLevel,v.strategy);if(k!==m)throw new Error(d[k]);if(v.header&&e.deflateSetHeader(this.strm,v.header),v.dictionary){var C;if(C=typeof v.dictionary=="string"?s.string2buf(v.dictionary):b.call(v.dictionary)==="[object ArrayBuffer]"?new Uint8Array(v.dictionary):v.dictionary,(k=e.deflateSetDictionary(this.strm,C))!==m)throw new Error(d[k]);this._dict_set=!0}}function f(h,v){var k=new l(v);if(k.push(h,!0),k.err)throw k.msg||d[k.err];return k.result}l.prototype.push=function(h,v){var k,C,S=this.strm,F=this.options.chunkSize;if(this.ended)return!1;C=v===~~v?v:v===!0?4:0,typeof h=="string"?S.input=s.string2buf(h):b.call(h)==="[object ArrayBuffer]"?S.input=new Uint8Array(h):S.input=h,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new r.Buf8(F),S.next_out=0,S.avail_out=F),(k=e.deflate(S,C))!==1&&k!==m)return this.onEnd(k),!(this.ended=!0);S.avail_out!==0&&(S.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(r.shrinkBuf(S.output,S.next_out))):this.onData(r.shrinkBuf(S.output,S.next_out)))}while((0<S.avail_in||S.avail_out===0)&&k!==1);return C===4?(k=e.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===m):C!==2||(this.onEnd(m),!(S.avail_out=0))},l.prototype.onData=function(h){this.chunks.push(h)},l.prototype.onEnd=function(h){h===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg},a.Deflate=l,a.deflate=f,a.deflateRaw=function(h,v){return(v=v||{}).raw=!0,f(h,v)},a.gzip=function(h,v){return(v=v||{}).gzip=!0,f(h,v)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,u,a){var e=t("./zlib/inflate"),r=t("./utils/common"),s=t("./utils/strings"),d=t("./zlib/constants"),_=t("./zlib/messages"),b=t("./zlib/zstream"),m=t("./zlib/gzheader"),w=Object.prototype.toString;function c(l){if(!(this instanceof c))return new c(l);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},l||{});var f=this.options;f.raw&&0<=f.windowBits&&f.windowBits<16&&(f.windowBits=-f.windowBits,f.windowBits===0&&(f.windowBits=-15)),!(0<=f.windowBits&&f.windowBits<16)||l&&l.windowBits||(f.windowBits+=32),15<f.windowBits&&f.windowBits<48&&(15&f.windowBits)==0&&(f.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var h=e.inflateInit2(this.strm,f.windowBits);if(h!==d.Z_OK)throw new Error(_[h]);this.header=new m,e.inflateGetHeader(this.strm,this.header)}function g(l,f){var h=new c(f);if(h.push(l,!0),h.err)throw h.msg||_[h.err];return h.result}c.prototype.push=function(l,f){var h,v,k,C,S,F,O=this.strm,j=this.options.chunkSize,T=this.options.dictionary,Z=!1;if(this.ended)return!1;v=f===~~f?f:f===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof l=="string"?O.input=s.binstring2buf(l):w.call(l)==="[object ArrayBuffer]"?O.input=new Uint8Array(l):O.input=l,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new r.Buf8(j),O.next_out=0,O.avail_out=j),(h=e.inflate(O,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&T&&(F=typeof T=="string"?s.string2buf(T):w.call(T)==="[object ArrayBuffer]"?new Uint8Array(T):T,h=e.inflateSetDictionary(this.strm,F)),h===d.Z_BUF_ERROR&&Z===!0&&(h=d.Z_OK,Z=!1),h!==d.Z_STREAM_END&&h!==d.Z_OK)return this.onEnd(h),!(this.ended=!0);O.next_out&&(O.avail_out!==0&&h!==d.Z_STREAM_END&&(O.avail_in!==0||v!==d.Z_FINISH&&v!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=s.utf8border(O.output,O.next_out),C=O.next_out-k,S=s.buf2string(O.output,k),O.next_out=C,O.avail_out=j-C,C&&r.arraySet(O.output,O.output,k,C,0),this.onData(S)):this.onData(r.shrinkBuf(O.output,O.next_out)))),O.avail_in===0&&O.avail_out===0&&(Z=!0)}while((0<O.avail_in||O.avail_out===0)&&h!==d.Z_STREAM_END);return h===d.Z_STREAM_END&&(v=d.Z_FINISH),v===d.Z_FINISH?(h=e.inflateEnd(this.strm),this.onEnd(h),this.ended=!0,h===d.Z_OK):v!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(O.avail_out=0))},c.prototype.onData=function(l){this.chunks.push(l)},c.prototype.onEnd=function(l){l===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=l,this.msg=this.strm.msg},a.Inflate=c,a.inflate=g,a.inflateRaw=function(l,f){return(f=f||{}).raw=!0,g(l,f)},a.ungzip=g},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,u,a){var e=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(d){for(var _=Array.prototype.slice.call(arguments,1);_.length;){var b=_.shift();if(b){if(typeof b!="object")throw new TypeError(b+"must be non-object");for(var m in b)b.hasOwnProperty(m)&&(d[m]=b[m])}}return d},a.shrinkBuf=function(d,_){return d.length===_?d:d.subarray?d.subarray(0,_):(d.length=_,d)};var r={arraySet:function(d,_,b,m,w){if(_.subarray&&d.subarray)d.set(_.subarray(b,b+m),w);else for(var c=0;c<m;c++)d[w+c]=_[b+c]},flattenChunks:function(d){var _,b,m,w,c,g;for(_=m=0,b=d.length;_<b;_++)m+=d[_].length;for(g=new Uint8Array(m),_=w=0,b=d.length;_<b;_++)c=d[_],g.set(c,w),w+=c.length;return g}},s={arraySet:function(d,_,b,m,w){for(var c=0;c<m;c++)d[w+c]=_[b+c]},flattenChunks:function(d){return[].concat.apply([],d)}};a.setTyped=function(d){d?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,r)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,s))},a.setTyped(e)},{}],42:[function(t,u,a){var e=t("./common"),r=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var d=new e.Buf8(256),_=0;_<256;_++)d[_]=252<=_?6:248<=_?5:240<=_?4:224<=_?3:192<=_?2:1;function b(m,w){if(w<65537&&(m.subarray&&s||!m.subarray&&r))return String.fromCharCode.apply(null,e.shrinkBuf(m,w));for(var c="",g=0;g<w;g++)c+=String.fromCharCode(m[g]);return c}d[254]=d[254]=1,a.string2buf=function(m){var w,c,g,l,f,h=m.length,v=0;for(l=0;l<h;l++)(64512&(c=m.charCodeAt(l)))==55296&&l+1<h&&(64512&(g=m.charCodeAt(l+1)))==56320&&(c=65536+(c-55296<<10)+(g-56320),l++),v+=c<128?1:c<2048?2:c<65536?3:4;for(w=new e.Buf8(v),l=f=0;f<v;l++)(64512&(c=m.charCodeAt(l)))==55296&&l+1<h&&(64512&(g=m.charCodeAt(l+1)))==56320&&(c=65536+(c-55296<<10)+(g-56320),l++),c<128?w[f++]=c:(c<2048?w[f++]=192|c>>>6:(c<65536?w[f++]=224|c>>>12:(w[f++]=240|c>>>18,w[f++]=128|c>>>12&63),w[f++]=128|c>>>6&63),w[f++]=128|63&c);return w},a.buf2binstring=function(m){return b(m,m.length)},a.binstring2buf=function(m){for(var w=new e.Buf8(m.length),c=0,g=w.length;c<g;c++)w[c]=m.charCodeAt(c);return w},a.buf2string=function(m,w){var c,g,l,f,h=w||m.length,v=new Array(2*h);for(c=g=0;c<h;)if((l=m[c++])<128)v[g++]=l;else if(4<(f=d[l]))v[g++]=65533,c+=f-1;else{for(l&=f===2?31:f===3?15:7;1<f&&c<h;)l=l<<6|63&m[c++],f--;1<f?v[g++]=65533:l<65536?v[g++]=l:(l-=65536,v[g++]=55296|l>>10&1023,v[g++]=56320|1023&l)}return b(v,g)},a.utf8border=function(m,w){var c;for((w=w||m.length)>m.length&&(w=m.length),c=w-1;0<=c&&(192&m[c])==128;)c--;return c<0||c===0?w:c+d[m[c]]>w?c:w}},{"./common":41}],43:[function(t,u,a){u.exports=function(e,r,s,d){for(var _=65535&e|0,b=e>>>16&65535|0,m=0;s!==0;){for(s-=m=2e3<s?2e3:s;b=b+(_=_+r[d++]|0)|0,--m;);_%=65521,b%=65521}return _|b<<16|0}},{}],44:[function(t,u,a){u.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,u,a){var e=(function(){for(var r,s=[],d=0;d<256;d++){r=d;for(var _=0;_<8;_++)r=1&r?3988292384^r>>>1:r>>>1;s[d]=r}return s})();u.exports=function(r,s,d,_){var b=e,m=_+d;r^=-1;for(var w=_;w<m;w++)r=r>>>8^b[255&(r^s[w])];return-1^r}},{}],46:[function(t,u,a){var e,r=t("../utils/common"),s=t("./trees"),d=t("./adler32"),_=t("./crc32"),b=t("./messages"),m=0,w=4,c=0,g=-2,l=-1,f=4,h=2,v=8,k=9,C=286,S=30,F=19,O=2*C+1,j=15,T=3,Z=258,K=Z+T+1,x=42,R=113,o=1,D=2,Q=3,M=4;function et(n,P){return n.msg=b[P],P}function W(n){return(n<<1)-(4<n?9:0)}function J(n){for(var P=n.length;0<=--P;)n[P]=0}function A(n){var P=n.state,B=P.pending;B>n.avail_out&&(B=n.avail_out),B!==0&&(r.arraySet(n.output,P.pending_buf,P.pending_out,B,n.next_out),n.next_out+=B,P.pending_out+=B,n.total_out+=B,n.avail_out-=B,P.pending-=B,P.pending===0&&(P.pending_out=0))}function z(n,P){s._tr_flush_block(n,0<=n.block_start?n.block_start:-1,n.strstart-n.block_start,P),n.block_start=n.strstart,A(n.strm)}function Y(n,P){n.pending_buf[n.pending++]=P}function q(n,P){n.pending_buf[n.pending++]=P>>>8&255,n.pending_buf[n.pending++]=255&P}function X(n,P){var B,y,p=n.max_chain_length,E=n.strstart,L=n.prev_length,N=n.nice_match,I=n.strstart>n.w_size-K?n.strstart-(n.w_size-K):0,$=n.window,G=n.w_mask,H=n.prev,V=n.strstart+Z,st=$[E+L-1],rt=$[E+L];n.prev_length>=n.good_match&&(p>>=2),N>n.lookahead&&(N=n.lookahead);do if($[(B=P)+L]===rt&&$[B+L-1]===st&&$[B]===$[E]&&$[++B]===$[E+1]){E+=2,B++;do;while($[++E]===$[++B]&&$[++E]===$[++B]&&$[++E]===$[++B]&&$[++E]===$[++B]&&$[++E]===$[++B]&&$[++E]===$[++B]&&$[++E]===$[++B]&&$[++E]===$[++B]&&E<V);if(y=Z-(V-E),E=V-Z,L<y){if(n.match_start=P,N<=(L=y))break;st=$[E+L-1],rt=$[E+L]}}while((P=H[P&G])>I&&--p!=0);return L<=n.lookahead?L:n.lookahead}function at(n){var P,B,y,p,E,L,N,I,$,G,H=n.w_size;do{if(p=n.window_size-n.lookahead-n.strstart,n.strstart>=H+(H-K)){for(r.arraySet(n.window,n.window,H,H,0),n.match_start-=H,n.strstart-=H,n.block_start-=H,P=B=n.hash_size;y=n.head[--P],n.head[P]=H<=y?y-H:0,--B;);for(P=B=H;y=n.prev[--P],n.prev[P]=H<=y?y-H:0,--B;);p+=H}if(n.strm.avail_in===0)break;if(L=n.strm,N=n.window,I=n.strstart+n.lookahead,$=p,G=void 0,G=L.avail_in,$<G&&(G=$),B=G===0?0:(L.avail_in-=G,r.arraySet(N,L.input,L.next_in,G,I),L.state.wrap===1?L.adler=d(L.adler,N,G,I):L.state.wrap===2&&(L.adler=_(L.adler,N,G,I)),L.next_in+=G,L.total_in+=G,G),n.lookahead+=B,n.lookahead+n.insert>=T)for(E=n.strstart-n.insert,n.ins_h=n.window[E],n.ins_h=(n.ins_h<<n.hash_shift^n.window[E+1])&n.hash_mask;n.insert&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[E+T-1])&n.hash_mask,n.prev[E&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=E,E++,n.insert--,!(n.lookahead+n.insert<T)););}while(n.lookahead<K&&n.strm.avail_in!==0)}function ht(n,P){for(var B,y;;){if(n.lookahead<K){if(at(n),n.lookahead<K&&P===m)return o;if(n.lookahead===0)break}if(B=0,n.lookahead>=T&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+T-1])&n.hash_mask,B=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),B!==0&&n.strstart-B<=n.w_size-K&&(n.match_length=X(n,B)),n.match_length>=T)if(y=s._tr_tally(n,n.strstart-n.match_start,n.match_length-T),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=T){for(n.match_length--;n.strstart++,n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+T-1])&n.hash_mask,B=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart,--n.match_length!=0;);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+1])&n.hash_mask;else y=s._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(y&&(z(n,!1),n.strm.avail_out===0))return o}return n.insert=n.strstart<T-1?n.strstart:T-1,P===w?(z(n,!0),n.strm.avail_out===0?Q:M):n.last_lit&&(z(n,!1),n.strm.avail_out===0)?o:D}function nt(n,P){for(var B,y,p;;){if(n.lookahead<K){if(at(n),n.lookahead<K&&P===m)return o;if(n.lookahead===0)break}if(B=0,n.lookahead>=T&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+T-1])&n.hash_mask,B=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=T-1,B!==0&&n.prev_length<n.max_lazy_match&&n.strstart-B<=n.w_size-K&&(n.match_length=X(n,B),n.match_length<=5&&(n.strategy===1||n.match_length===T&&4096<n.strstart-n.match_start)&&(n.match_length=T-1)),n.prev_length>=T&&n.match_length<=n.prev_length){for(p=n.strstart+n.lookahead-T,y=s._tr_tally(n,n.strstart-1-n.prev_match,n.prev_length-T),n.lookahead-=n.prev_length-1,n.prev_length-=2;++n.strstart<=p&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+T-1])&n.hash_mask,B=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),--n.prev_length!=0;);if(n.match_available=0,n.match_length=T-1,n.strstart++,y&&(z(n,!1),n.strm.avail_out===0))return o}else if(n.match_available){if((y=s._tr_tally(n,0,n.window[n.strstart-1]))&&z(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return o}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(y=s._tr_tally(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<T-1?n.strstart:T-1,P===w?(z(n,!0),n.strm.avail_out===0?Q:M):n.last_lit&&(z(n,!1),n.strm.avail_out===0)?o:D}function it(n,P,B,y,p){this.good_length=n,this.max_lazy=P,this.nice_length=B,this.max_chain=y,this.func=p}function dt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*O),this.dyn_dtree=new r.Buf16(2*(2*S+1)),this.bl_tree=new r.Buf16(2*(2*F+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(j+1),this.heap=new r.Buf16(2*C+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*C+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ot(n){var P;return n&&n.state?(n.total_in=n.total_out=0,n.data_type=h,(P=n.state).pending=0,P.pending_out=0,P.wrap<0&&(P.wrap=-P.wrap),P.status=P.wrap?x:R,n.adler=P.wrap===2?0:1,P.last_flush=m,s._tr_init(P),c):et(n,g)}function pt(n){var P=ot(n);return P===c&&(function(B){B.window_size=2*B.w_size,J(B.head),B.max_lazy_match=e[B.level].max_lazy,B.good_match=e[B.level].good_length,B.nice_match=e[B.level].nice_length,B.max_chain_length=e[B.level].max_chain,B.strstart=0,B.block_start=0,B.lookahead=0,B.insert=0,B.match_length=B.prev_length=T-1,B.match_available=0,B.ins_h=0})(n.state),P}function ft(n,P,B,y,p,E){if(!n)return g;var L=1;if(P===l&&(P=6),y<0?(L=0,y=-y):15<y&&(L=2,y-=16),p<1||k<p||B!==v||y<8||15<y||P<0||9<P||E<0||f<E)return et(n,g);y===8&&(y=9);var N=new dt;return(n.state=N).strm=n,N.wrap=L,N.gzhead=null,N.w_bits=y,N.w_size=1<<N.w_bits,N.w_mask=N.w_size-1,N.hash_bits=p+7,N.hash_size=1<<N.hash_bits,N.hash_mask=N.hash_size-1,N.hash_shift=~~((N.hash_bits+T-1)/T),N.window=new r.Buf8(2*N.w_size),N.head=new r.Buf16(N.hash_size),N.prev=new r.Buf16(N.w_size),N.lit_bufsize=1<<p+6,N.pending_buf_size=4*N.lit_bufsize,N.pending_buf=new r.Buf8(N.pending_buf_size),N.d_buf=1*N.lit_bufsize,N.l_buf=3*N.lit_bufsize,N.level=P,N.strategy=E,N.method=B,pt(n)}e=[new it(0,0,0,0,function(n,P){var B=65535;for(B>n.pending_buf_size-5&&(B=n.pending_buf_size-5);;){if(n.lookahead<=1){if(at(n),n.lookahead===0&&P===m)return o;if(n.lookahead===0)break}n.strstart+=n.lookahead,n.lookahead=0;var y=n.block_start+B;if((n.strstart===0||n.strstart>=y)&&(n.lookahead=n.strstart-y,n.strstart=y,z(n,!1),n.strm.avail_out===0)||n.strstart-n.block_start>=n.w_size-K&&(z(n,!1),n.strm.avail_out===0))return o}return n.insert=0,P===w?(z(n,!0),n.strm.avail_out===0?Q:M):(n.strstart>n.block_start&&(z(n,!1),n.strm.avail_out),o)}),new it(4,4,8,4,ht),new it(4,5,16,8,ht),new it(4,6,32,32,ht),new it(4,4,16,16,nt),new it(8,16,32,32,nt),new it(8,16,128,128,nt),new it(8,32,128,256,nt),new it(32,128,258,1024,nt),new it(32,258,258,4096,nt)],a.deflateInit=function(n,P){return ft(n,P,v,15,8,0)},a.deflateInit2=ft,a.deflateReset=pt,a.deflateResetKeep=ot,a.deflateSetHeader=function(n,P){return n&&n.state?n.state.wrap!==2?g:(n.state.gzhead=P,c):g},a.deflate=function(n,P){var B,y,p,E;if(!n||!n.state||5<P||P<0)return n?et(n,g):g;if(y=n.state,!n.output||!n.input&&n.avail_in!==0||y.status===666&&P!==w)return et(n,n.avail_out===0?-5:g);if(y.strm=n,B=y.last_flush,y.last_flush=P,y.status===x)if(y.wrap===2)n.adler=0,Y(y,31),Y(y,139),Y(y,8),y.gzhead?(Y(y,(y.gzhead.text?1:0)+(y.gzhead.hcrc?2:0)+(y.gzhead.extra?4:0)+(y.gzhead.name?8:0)+(y.gzhead.comment?16:0)),Y(y,255&y.gzhead.time),Y(y,y.gzhead.time>>8&255),Y(y,y.gzhead.time>>16&255),Y(y,y.gzhead.time>>24&255),Y(y,y.level===9?2:2<=y.strategy||y.level<2?4:0),Y(y,255&y.gzhead.os),y.gzhead.extra&&y.gzhead.extra.length&&(Y(y,255&y.gzhead.extra.length),Y(y,y.gzhead.extra.length>>8&255)),y.gzhead.hcrc&&(n.adler=_(n.adler,y.pending_buf,y.pending,0)),y.gzindex=0,y.status=69):(Y(y,0),Y(y,0),Y(y,0),Y(y,0),Y(y,0),Y(y,y.level===9?2:2<=y.strategy||y.level<2?4:0),Y(y,3),y.status=R);else{var L=v+(y.w_bits-8<<4)<<8;L|=(2<=y.strategy||y.level<2?0:y.level<6?1:y.level===6?2:3)<<6,y.strstart!==0&&(L|=32),L+=31-L%31,y.status=R,q(y,L),y.strstart!==0&&(q(y,n.adler>>>16),q(y,65535&n.adler)),n.adler=1}if(y.status===69)if(y.gzhead.extra){for(p=y.pending;y.gzindex<(65535&y.gzhead.extra.length)&&(y.pending!==y.pending_buf_size||(y.gzhead.hcrc&&y.pending>p&&(n.adler=_(n.adler,y.pending_buf,y.pending-p,p)),A(n),p=y.pending,y.pending!==y.pending_buf_size));)Y(y,255&y.gzhead.extra[y.gzindex]),y.gzindex++;y.gzhead.hcrc&&y.pending>p&&(n.adler=_(n.adler,y.pending_buf,y.pending-p,p)),y.gzindex===y.gzhead.extra.length&&(y.gzindex=0,y.status=73)}else y.status=73;if(y.status===73)if(y.gzhead.name){p=y.pending;do{if(y.pending===y.pending_buf_size&&(y.gzhead.hcrc&&y.pending>p&&(n.adler=_(n.adler,y.pending_buf,y.pending-p,p)),A(n),p=y.pending,y.pending===y.pending_buf_size)){E=1;break}E=y.gzindex<y.gzhead.name.length?255&y.gzhead.name.charCodeAt(y.gzindex++):0,Y(y,E)}while(E!==0);y.gzhead.hcrc&&y.pending>p&&(n.adler=_(n.adler,y.pending_buf,y.pending-p,p)),E===0&&(y.gzindex=0,y.status=91)}else y.status=91;if(y.status===91)if(y.gzhead.comment){p=y.pending;do{if(y.pending===y.pending_buf_size&&(y.gzhead.hcrc&&y.pending>p&&(n.adler=_(n.adler,y.pending_buf,y.pending-p,p)),A(n),p=y.pending,y.pending===y.pending_buf_size)){E=1;break}E=y.gzindex<y.gzhead.comment.length?255&y.gzhead.comment.charCodeAt(y.gzindex++):0,Y(y,E)}while(E!==0);y.gzhead.hcrc&&y.pending>p&&(n.adler=_(n.adler,y.pending_buf,y.pending-p,p)),E===0&&(y.status=103)}else y.status=103;if(y.status===103&&(y.gzhead.hcrc?(y.pending+2>y.pending_buf_size&&A(n),y.pending+2<=y.pending_buf_size&&(Y(y,255&n.adler),Y(y,n.adler>>8&255),n.adler=0,y.status=R)):y.status=R),y.pending!==0){if(A(n),n.avail_out===0)return y.last_flush=-1,c}else if(n.avail_in===0&&W(P)<=W(B)&&P!==w)return et(n,-5);if(y.status===666&&n.avail_in!==0)return et(n,-5);if(n.avail_in!==0||y.lookahead!==0||P!==m&&y.status!==666){var N=y.strategy===2?(function(I,$){for(var G;;){if(I.lookahead===0&&(at(I),I.lookahead===0)){if($===m)return o;break}if(I.match_length=0,G=s._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++,G&&(z(I,!1),I.strm.avail_out===0))return o}return I.insert=0,$===w?(z(I,!0),I.strm.avail_out===0?Q:M):I.last_lit&&(z(I,!1),I.strm.avail_out===0)?o:D})(y,P):y.strategy===3?(function(I,$){for(var G,H,V,st,rt=I.window;;){if(I.lookahead<=Z){if(at(I),I.lookahead<=Z&&$===m)return o;if(I.lookahead===0)break}if(I.match_length=0,I.lookahead>=T&&0<I.strstart&&(H=rt[V=I.strstart-1])===rt[++V]&&H===rt[++V]&&H===rt[++V]){st=I.strstart+Z;do;while(H===rt[++V]&&H===rt[++V]&&H===rt[++V]&&H===rt[++V]&&H===rt[++V]&&H===rt[++V]&&H===rt[++V]&&H===rt[++V]&&V<st);I.match_length=Z-(st-V),I.match_length>I.lookahead&&(I.match_length=I.lookahead)}if(I.match_length>=T?(G=s._tr_tally(I,1,I.match_length-T),I.lookahead-=I.match_length,I.strstart+=I.match_length,I.match_length=0):(G=s._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++),G&&(z(I,!1),I.strm.avail_out===0))return o}return I.insert=0,$===w?(z(I,!0),I.strm.avail_out===0?Q:M):I.last_lit&&(z(I,!1),I.strm.avail_out===0)?o:D})(y,P):e[y.level].func(y,P);if(N!==Q&&N!==M||(y.status=666),N===o||N===Q)return n.avail_out===0&&(y.last_flush=-1),c;if(N===D&&(P===1?s._tr_align(y):P!==5&&(s._tr_stored_block(y,0,0,!1),P===3&&(J(y.head),y.lookahead===0&&(y.strstart=0,y.block_start=0,y.insert=0))),A(n),n.avail_out===0))return y.last_flush=-1,c}return P!==w?c:y.wrap<=0?1:(y.wrap===2?(Y(y,255&n.adler),Y(y,n.adler>>8&255),Y(y,n.adler>>16&255),Y(y,n.adler>>24&255),Y(y,255&n.total_in),Y(y,n.total_in>>8&255),Y(y,n.total_in>>16&255),Y(y,n.total_in>>24&255)):(q(y,n.adler>>>16),q(y,65535&n.adler)),A(n),0<y.wrap&&(y.wrap=-y.wrap),y.pending!==0?c:1)},a.deflateEnd=function(n){var P;return n&&n.state?(P=n.state.status)!==x&&P!==69&&P!==73&&P!==91&&P!==103&&P!==R&&P!==666?et(n,g):(n.state=null,P===R?et(n,-3):c):g},a.deflateSetDictionary=function(n,P){var B,y,p,E,L,N,I,$,G=P.length;if(!n||!n.state||(E=(B=n.state).wrap)===2||E===1&&B.status!==x||B.lookahead)return g;for(E===1&&(n.adler=d(n.adler,P,G,0)),B.wrap=0,G>=B.w_size&&(E===0&&(J(B.head),B.strstart=0,B.block_start=0,B.insert=0),$=new r.Buf8(B.w_size),r.arraySet($,P,G-B.w_size,B.w_size,0),P=$,G=B.w_size),L=n.avail_in,N=n.next_in,I=n.input,n.avail_in=G,n.next_in=0,n.input=P,at(B);B.lookahead>=T;){for(y=B.strstart,p=B.lookahead-(T-1);B.ins_h=(B.ins_h<<B.hash_shift^B.window[y+T-1])&B.hash_mask,B.prev[y&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=y,y++,--p;);B.strstart=y,B.lookahead=T-1,at(B)}return B.strstart+=B.lookahead,B.block_start=B.strstart,B.insert=B.lookahead,B.lookahead=0,B.match_length=B.prev_length=T-1,B.match_available=0,n.next_in=N,n.input=I,n.avail_in=L,B.wrap=E,c},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,u,a){u.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,u,a){u.exports=function(e,r){var s,d,_,b,m,w,c,g,l,f,h,v,k,C,S,F,O,j,T,Z,K,x,R,o,D;s=e.state,d=e.next_in,o=e.input,_=d+(e.avail_in-5),b=e.next_out,D=e.output,m=b-(r-e.avail_out),w=b+(e.avail_out-257),c=s.dmax,g=s.wsize,l=s.whave,f=s.wnext,h=s.window,v=s.hold,k=s.bits,C=s.lencode,S=s.distcode,F=(1<<s.lenbits)-1,O=(1<<s.distbits)-1;t:do{k<15&&(v+=o[d++]<<k,k+=8,v+=o[d++]<<k,k+=8),j=C[v&F];e:for(;;){if(v>>>=T=j>>>24,k-=T,(T=j>>>16&255)===0)D[b++]=65535&j;else{if(!(16&T)){if((64&T)==0){j=C[(65535&j)+(v&(1<<T)-1)];continue e}if(32&T){s.mode=12;break t}e.msg="invalid literal/length code",s.mode=30;break t}Z=65535&j,(T&=15)&&(k<T&&(v+=o[d++]<<k,k+=8),Z+=v&(1<<T)-1,v>>>=T,k-=T),k<15&&(v+=o[d++]<<k,k+=8,v+=o[d++]<<k,k+=8),j=S[v&O];n:for(;;){if(v>>>=T=j>>>24,k-=T,!(16&(T=j>>>16&255))){if((64&T)==0){j=S[(65535&j)+(v&(1<<T)-1)];continue n}e.msg="invalid distance code",s.mode=30;break t}if(K=65535&j,k<(T&=15)&&(v+=o[d++]<<k,(k+=8)<T&&(v+=o[d++]<<k,k+=8)),c<(K+=v&(1<<T)-1)){e.msg="invalid distance too far back",s.mode=30;break t}if(v>>>=T,k-=T,(T=b-m)<K){if(l<(T=K-T)&&s.sane){e.msg="invalid distance too far back",s.mode=30;break t}if(R=h,(x=0)===f){if(x+=g-T,T<Z){for(Z-=T;D[b++]=h[x++],--T;);x=b-K,R=D}}else if(f<T){if(x+=g+f-T,(T-=f)<Z){for(Z-=T;D[b++]=h[x++],--T;);if(x=0,f<Z){for(Z-=T=f;D[b++]=h[x++],--T;);x=b-K,R=D}}}else if(x+=f-T,T<Z){for(Z-=T;D[b++]=h[x++],--T;);x=b-K,R=D}for(;2<Z;)D[b++]=R[x++],D[b++]=R[x++],D[b++]=R[x++],Z-=3;Z&&(D[b++]=R[x++],1<Z&&(D[b++]=R[x++]))}else{for(x=b-K;D[b++]=D[x++],D[b++]=D[x++],D[b++]=D[x++],2<(Z-=3););Z&&(D[b++]=D[x++],1<Z&&(D[b++]=D[x++]))}break}}break}}while(d<_&&b<w);d-=Z=k>>3,v&=(1<<(k-=Z<<3))-1,e.next_in=d,e.next_out=b,e.avail_in=d<_?_-d+5:5-(d-_),e.avail_out=b<w?w-b+257:257-(b-w),s.hold=v,s.bits=k}},{}],49:[function(t,u,a){var e=t("../utils/common"),r=t("./adler32"),s=t("./crc32"),d=t("./inffast"),_=t("./inftrees"),b=1,m=2,w=0,c=-2,g=1,l=852,f=592;function h(x){return(x>>>24&255)+(x>>>8&65280)+((65280&x)<<8)+((255&x)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(x){var R;return x&&x.state?(R=x.state,x.total_in=x.total_out=R.total=0,x.msg="",R.wrap&&(x.adler=1&R.wrap),R.mode=g,R.last=0,R.havedict=0,R.dmax=32768,R.head=null,R.hold=0,R.bits=0,R.lencode=R.lendyn=new e.Buf32(l),R.distcode=R.distdyn=new e.Buf32(f),R.sane=1,R.back=-1,w):c}function C(x){var R;return x&&x.state?((R=x.state).wsize=0,R.whave=0,R.wnext=0,k(x)):c}function S(x,R){var o,D;return x&&x.state?(D=x.state,R<0?(o=0,R=-R):(o=1+(R>>4),R<48&&(R&=15)),R&&(R<8||15<R)?c:(D.window!==null&&D.wbits!==R&&(D.window=null),D.wrap=o,D.wbits=R,C(x))):c}function F(x,R){var o,D;return x?(D=new v,(x.state=D).window=null,(o=S(x,R))!==w&&(x.state=null),o):c}var O,j,T=!0;function Z(x){if(T){var R;for(O=new e.Buf32(512),j=new e.Buf32(32),R=0;R<144;)x.lens[R++]=8;for(;R<256;)x.lens[R++]=9;for(;R<280;)x.lens[R++]=7;for(;R<288;)x.lens[R++]=8;for(_(b,x.lens,0,288,O,0,x.work,{bits:9}),R=0;R<32;)x.lens[R++]=5;_(m,x.lens,0,32,j,0,x.work,{bits:5}),T=!1}x.lencode=O,x.lenbits=9,x.distcode=j,x.distbits=5}function K(x,R,o,D){var Q,M=x.state;return M.window===null&&(M.wsize=1<<M.wbits,M.wnext=0,M.whave=0,M.window=new e.Buf8(M.wsize)),D>=M.wsize?(e.arraySet(M.window,R,o-M.wsize,M.wsize,0),M.wnext=0,M.whave=M.wsize):(D<(Q=M.wsize-M.wnext)&&(Q=D),e.arraySet(M.window,R,o-D,Q,M.wnext),(D-=Q)?(e.arraySet(M.window,R,o-D,D,0),M.wnext=D,M.whave=M.wsize):(M.wnext+=Q,M.wnext===M.wsize&&(M.wnext=0),M.whave<M.wsize&&(M.whave+=Q))),0}a.inflateReset=C,a.inflateReset2=S,a.inflateResetKeep=k,a.inflateInit=function(x){return F(x,15)},a.inflateInit2=F,a.inflate=function(x,R){var o,D,Q,M,et,W,J,A,z,Y,q,X,at,ht,nt,it,dt,ot,pt,ft,n,P,B,y,p=0,E=new e.Buf8(4),L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!x||!x.state||!x.output||!x.input&&x.avail_in!==0)return c;(o=x.state).mode===12&&(o.mode=13),et=x.next_out,Q=x.output,J=x.avail_out,M=x.next_in,D=x.input,W=x.avail_in,A=o.hold,z=o.bits,Y=W,q=J,P=w;t:for(;;)switch(o.mode){case g:if(o.wrap===0){o.mode=13;break}for(;z<16;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}if(2&o.wrap&&A===35615){E[o.check=0]=255&A,E[1]=A>>>8&255,o.check=s(o.check,E,2,0),z=A=0,o.mode=2;break}if(o.flags=0,o.head&&(o.head.done=!1),!(1&o.wrap)||(((255&A)<<8)+(A>>8))%31){x.msg="incorrect header check",o.mode=30;break}if((15&A)!=8){x.msg="unknown compression method",o.mode=30;break}if(z-=4,n=8+(15&(A>>>=4)),o.wbits===0)o.wbits=n;else if(n>o.wbits){x.msg="invalid window size",o.mode=30;break}o.dmax=1<<n,x.adler=o.check=1,o.mode=512&A?10:12,z=A=0;break;case 2:for(;z<16;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}if(o.flags=A,(255&o.flags)!=8){x.msg="unknown compression method",o.mode=30;break}if(57344&o.flags){x.msg="unknown header flags set",o.mode=30;break}o.head&&(o.head.text=A>>8&1),512&o.flags&&(E[0]=255&A,E[1]=A>>>8&255,o.check=s(o.check,E,2,0)),z=A=0,o.mode=3;case 3:for(;z<32;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}o.head&&(o.head.time=A),512&o.flags&&(E[0]=255&A,E[1]=A>>>8&255,E[2]=A>>>16&255,E[3]=A>>>24&255,o.check=s(o.check,E,4,0)),z=A=0,o.mode=4;case 4:for(;z<16;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}o.head&&(o.head.xflags=255&A,o.head.os=A>>8),512&o.flags&&(E[0]=255&A,E[1]=A>>>8&255,o.check=s(o.check,E,2,0)),z=A=0,o.mode=5;case 5:if(1024&o.flags){for(;z<16;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}o.length=A,o.head&&(o.head.extra_len=A),512&o.flags&&(E[0]=255&A,E[1]=A>>>8&255,o.check=s(o.check,E,2,0)),z=A=0}else o.head&&(o.head.extra=null);o.mode=6;case 6:if(1024&o.flags&&(W<(X=o.length)&&(X=W),X&&(o.head&&(n=o.head.extra_len-o.length,o.head.extra||(o.head.extra=new Array(o.head.extra_len)),e.arraySet(o.head.extra,D,M,X,n)),512&o.flags&&(o.check=s(o.check,D,X,M)),W-=X,M+=X,o.length-=X),o.length))break t;o.length=0,o.mode=7;case 7:if(2048&o.flags){if(W===0)break t;for(X=0;n=D[M+X++],o.head&&n&&o.length<65536&&(o.head.name+=String.fromCharCode(n)),n&&X<W;);if(512&o.flags&&(o.check=s(o.check,D,X,M)),W-=X,M+=X,n)break t}else o.head&&(o.head.name=null);o.length=0,o.mode=8;case 8:if(4096&o.flags){if(W===0)break t;for(X=0;n=D[M+X++],o.head&&n&&o.length<65536&&(o.head.comment+=String.fromCharCode(n)),n&&X<W;);if(512&o.flags&&(o.check=s(o.check,D,X,M)),W-=X,M+=X,n)break t}else o.head&&(o.head.comment=null);o.mode=9;case 9:if(512&o.flags){for(;z<16;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}if(A!==(65535&o.check)){x.msg="header crc mismatch",o.mode=30;break}z=A=0}o.head&&(o.head.hcrc=o.flags>>9&1,o.head.done=!0),x.adler=o.check=0,o.mode=12;break;case 10:for(;z<32;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}x.adler=o.check=h(A),z=A=0,o.mode=11;case 11:if(o.havedict===0)return x.next_out=et,x.avail_out=J,x.next_in=M,x.avail_in=W,o.hold=A,o.bits=z,2;x.adler=o.check=1,o.mode=12;case 12:if(R===5||R===6)break t;case 13:if(o.last){A>>>=7&z,z-=7&z,o.mode=27;break}for(;z<3;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}switch(o.last=1&A,z-=1,3&(A>>>=1)){case 0:o.mode=14;break;case 1:if(Z(o),o.mode=20,R!==6)break;A>>>=2,z-=2;break t;case 2:o.mode=17;break;case 3:x.msg="invalid block type",o.mode=30}A>>>=2,z-=2;break;case 14:for(A>>>=7&z,z-=7&z;z<32;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}if((65535&A)!=(A>>>16^65535)){x.msg="invalid stored block lengths",o.mode=30;break}if(o.length=65535&A,z=A=0,o.mode=15,R===6)break t;case 15:o.mode=16;case 16:if(X=o.length){if(W<X&&(X=W),J<X&&(X=J),X===0)break t;e.arraySet(Q,D,M,X,et),W-=X,M+=X,J-=X,et+=X,o.length-=X;break}o.mode=12;break;case 17:for(;z<14;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}if(o.nlen=257+(31&A),A>>>=5,z-=5,o.ndist=1+(31&A),A>>>=5,z-=5,o.ncode=4+(15&A),A>>>=4,z-=4,286<o.nlen||30<o.ndist){x.msg="too many length or distance symbols",o.mode=30;break}o.have=0,o.mode=18;case 18:for(;o.have<o.ncode;){for(;z<3;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}o.lens[L[o.have++]]=7&A,A>>>=3,z-=3}for(;o.have<19;)o.lens[L[o.have++]]=0;if(o.lencode=o.lendyn,o.lenbits=7,B={bits:o.lenbits},P=_(0,o.lens,0,19,o.lencode,0,o.work,B),o.lenbits=B.bits,P){x.msg="invalid code lengths set",o.mode=30;break}o.have=0,o.mode=19;case 19:for(;o.have<o.nlen+o.ndist;){for(;it=(p=o.lencode[A&(1<<o.lenbits)-1])>>>16&255,dt=65535&p,!((nt=p>>>24)<=z);){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}if(dt<16)A>>>=nt,z-=nt,o.lens[o.have++]=dt;else{if(dt===16){for(y=nt+2;z<y;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}if(A>>>=nt,z-=nt,o.have===0){x.msg="invalid bit length repeat",o.mode=30;break}n=o.lens[o.have-1],X=3+(3&A),A>>>=2,z-=2}else if(dt===17){for(y=nt+3;z<y;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}z-=nt,n=0,X=3+(7&(A>>>=nt)),A>>>=3,z-=3}else{for(y=nt+7;z<y;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}z-=nt,n=0,X=11+(127&(A>>>=nt)),A>>>=7,z-=7}if(o.have+X>o.nlen+o.ndist){x.msg="invalid bit length repeat",o.mode=30;break}for(;X--;)o.lens[o.have++]=n}}if(o.mode===30)break;if(o.lens[256]===0){x.msg="invalid code -- missing end-of-block",o.mode=30;break}if(o.lenbits=9,B={bits:o.lenbits},P=_(b,o.lens,0,o.nlen,o.lencode,0,o.work,B),o.lenbits=B.bits,P){x.msg="invalid literal/lengths set",o.mode=30;break}if(o.distbits=6,o.distcode=o.distdyn,B={bits:o.distbits},P=_(m,o.lens,o.nlen,o.ndist,o.distcode,0,o.work,B),o.distbits=B.bits,P){x.msg="invalid distances set",o.mode=30;break}if(o.mode=20,R===6)break t;case 20:o.mode=21;case 21:if(6<=W&&258<=J){x.next_out=et,x.avail_out=J,x.next_in=M,x.avail_in=W,o.hold=A,o.bits=z,d(x,q),et=x.next_out,Q=x.output,J=x.avail_out,M=x.next_in,D=x.input,W=x.avail_in,A=o.hold,z=o.bits,o.mode===12&&(o.back=-1);break}for(o.back=0;it=(p=o.lencode[A&(1<<o.lenbits)-1])>>>16&255,dt=65535&p,!((nt=p>>>24)<=z);){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}if(it&&(240&it)==0){for(ot=nt,pt=it,ft=dt;it=(p=o.lencode[ft+((A&(1<<ot+pt)-1)>>ot)])>>>16&255,dt=65535&p,!(ot+(nt=p>>>24)<=z);){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}A>>>=ot,z-=ot,o.back+=ot}if(A>>>=nt,z-=nt,o.back+=nt,o.length=dt,it===0){o.mode=26;break}if(32&it){o.back=-1,o.mode=12;break}if(64&it){x.msg="invalid literal/length code",o.mode=30;break}o.extra=15&it,o.mode=22;case 22:if(o.extra){for(y=o.extra;z<y;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}o.length+=A&(1<<o.extra)-1,A>>>=o.extra,z-=o.extra,o.back+=o.extra}o.was=o.length,o.mode=23;case 23:for(;it=(p=o.distcode[A&(1<<o.distbits)-1])>>>16&255,dt=65535&p,!((nt=p>>>24)<=z);){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}if((240&it)==0){for(ot=nt,pt=it,ft=dt;it=(p=o.distcode[ft+((A&(1<<ot+pt)-1)>>ot)])>>>16&255,dt=65535&p,!(ot+(nt=p>>>24)<=z);){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}A>>>=ot,z-=ot,o.back+=ot}if(A>>>=nt,z-=nt,o.back+=nt,64&it){x.msg="invalid distance code",o.mode=30;break}o.offset=dt,o.extra=15&it,o.mode=24;case 24:if(o.extra){for(y=o.extra;z<y;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}o.offset+=A&(1<<o.extra)-1,A>>>=o.extra,z-=o.extra,o.back+=o.extra}if(o.offset>o.dmax){x.msg="invalid distance too far back",o.mode=30;break}o.mode=25;case 25:if(J===0)break t;if(X=q-J,o.offset>X){if((X=o.offset-X)>o.whave&&o.sane){x.msg="invalid distance too far back",o.mode=30;break}at=X>o.wnext?(X-=o.wnext,o.wsize-X):o.wnext-X,X>o.length&&(X=o.length),ht=o.window}else ht=Q,at=et-o.offset,X=o.length;for(J<X&&(X=J),J-=X,o.length-=X;Q[et++]=ht[at++],--X;);o.length===0&&(o.mode=21);break;case 26:if(J===0)break t;Q[et++]=o.length,J--,o.mode=21;break;case 27:if(o.wrap){for(;z<32;){if(W===0)break t;W--,A|=D[M++]<<z,z+=8}if(q-=J,x.total_out+=q,o.total+=q,q&&(x.adler=o.check=o.flags?s(o.check,Q,q,et-q):r(o.check,Q,q,et-q)),q=J,(o.flags?A:h(A))!==o.check){x.msg="incorrect data check",o.mode=30;break}z=A=0}o.mode=28;case 28:if(o.wrap&&o.flags){for(;z<32;){if(W===0)break t;W--,A+=D[M++]<<z,z+=8}if(A!==(4294967295&o.total)){x.msg="incorrect length check",o.mode=30;break}z=A=0}o.mode=29;case 29:P=1;break t;case 30:P=-3;break t;case 31:return-4;case 32:default:return c}return x.next_out=et,x.avail_out=J,x.next_in=M,x.avail_in=W,o.hold=A,o.bits=z,(o.wsize||q!==x.avail_out&&o.mode<30&&(o.mode<27||R!==4))&&K(x,x.output,x.next_out,q-x.avail_out)?(o.mode=31,-4):(Y-=x.avail_in,q-=x.avail_out,x.total_in+=Y,x.total_out+=q,o.total+=q,o.wrap&&q&&(x.adler=o.check=o.flags?s(o.check,Q,q,x.next_out-q):r(o.check,Q,q,x.next_out-q)),x.data_type=o.bits+(o.last?64:0)+(o.mode===12?128:0)+(o.mode===20||o.mode===15?256:0),(Y==0&&q===0||R===4)&&P===w&&(P=-5),P)},a.inflateEnd=function(x){if(!x||!x.state)return c;var R=x.state;return R.window&&(R.window=null),x.state=null,w},a.inflateGetHeader=function(x,R){var o;return x&&x.state?(2&(o=x.state).wrap)==0?c:((o.head=R).done=!1,w):c},a.inflateSetDictionary=function(x,R){var o,D=R.length;return x&&x.state?(o=x.state).wrap!==0&&o.mode!==11?c:o.mode===11&&r(1,R,D,0)!==o.check?-3:K(x,R,D,D)?(o.mode=31,-4):(o.havedict=1,w):c},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,u,a){var e=t("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],_=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];u.exports=function(b,m,w,c,g,l,f,h){var v,k,C,S,F,O,j,T,Z,K=h.bits,x=0,R=0,o=0,D=0,Q=0,M=0,et=0,W=0,J=0,A=0,z=null,Y=0,q=new e.Buf16(16),X=new e.Buf16(16),at=null,ht=0;for(x=0;x<=15;x++)q[x]=0;for(R=0;R<c;R++)q[m[w+R]]++;for(Q=K,D=15;1<=D&&q[D]===0;D--);if(D<Q&&(Q=D),D===0)return g[l++]=20971520,g[l++]=20971520,h.bits=1,0;for(o=1;o<D&&q[o]===0;o++);for(Q<o&&(Q=o),x=W=1;x<=15;x++)if(W<<=1,(W-=q[x])<0)return-1;if(0<W&&(b===0||D!==1))return-1;for(X[1]=0,x=1;x<15;x++)X[x+1]=X[x]+q[x];for(R=0;R<c;R++)m[w+R]!==0&&(f[X[m[w+R]]++]=R);if(O=b===0?(z=at=f,19):b===1?(z=r,Y-=257,at=s,ht-=257,256):(z=d,at=_,-1),x=o,F=l,et=R=A=0,C=-1,S=(J=1<<(M=Q))-1,b===1&&852<J||b===2&&592<J)return 1;for(;;){for(j=x-et,Z=f[R]<O?(T=0,f[R]):f[R]>O?(T=at[ht+f[R]],z[Y+f[R]]):(T=96,0),v=1<<x-et,o=k=1<<M;g[F+(A>>et)+(k-=v)]=j<<24|T<<16|Z|0,k!==0;);for(v=1<<x-1;A&v;)v>>=1;if(v!==0?(A&=v-1,A+=v):A=0,R++,--q[x]==0){if(x===D)break;x=m[w+f[R]]}if(Q<x&&(A&S)!==C){for(et===0&&(et=Q),F+=o,W=1<<(M=x-et);M+et<D&&!((W-=q[M+et])<=0);)M++,W<<=1;if(J+=1<<M,b===1&&852<J||b===2&&592<J)return 1;g[C=A&S]=Q<<24|M<<16|F-l|0}}return A!==0&&(g[F+A]=x-et<<24|64<<16|0),h.bits=Q,0}},{"../utils/common":41}],51:[function(t,u,a){u.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,u,a){var e=t("../utils/common"),r=0,s=1;function d(p){for(var E=p.length;0<=--E;)p[E]=0}var _=0,b=29,m=256,w=m+1+b,c=30,g=19,l=2*w+1,f=15,h=16,v=7,k=256,C=16,S=17,F=18,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=new Array(2*(w+2));d(K);var x=new Array(2*c);d(x);var R=new Array(512);d(R);var o=new Array(256);d(o);var D=new Array(b);d(D);var Q,M,et,W=new Array(c);function J(p,E,L,N,I){this.static_tree=p,this.extra_bits=E,this.extra_base=L,this.elems=N,this.max_length=I,this.has_stree=p&&p.length}function A(p,E){this.dyn_tree=p,this.max_code=0,this.stat_desc=E}function z(p){return p<256?R[p]:R[256+(p>>>7)]}function Y(p,E){p.pending_buf[p.pending++]=255&E,p.pending_buf[p.pending++]=E>>>8&255}function q(p,E,L){p.bi_valid>h-L?(p.bi_buf|=E<<p.bi_valid&65535,Y(p,p.bi_buf),p.bi_buf=E>>h-p.bi_valid,p.bi_valid+=L-h):(p.bi_buf|=E<<p.bi_valid&65535,p.bi_valid+=L)}function X(p,E,L){q(p,L[2*E],L[2*E+1])}function at(p,E){for(var L=0;L|=1&p,p>>>=1,L<<=1,0<--E;);return L>>>1}function ht(p,E,L){var N,I,$=new Array(f+1),G=0;for(N=1;N<=f;N++)$[N]=G=G+L[N-1]<<1;for(I=0;I<=E;I++){var H=p[2*I+1];H!==0&&(p[2*I]=at($[H]++,H))}}function nt(p){var E;for(E=0;E<w;E++)p.dyn_ltree[2*E]=0;for(E=0;E<c;E++)p.dyn_dtree[2*E]=0;for(E=0;E<g;E++)p.bl_tree[2*E]=0;p.dyn_ltree[2*k]=1,p.opt_len=p.static_len=0,p.last_lit=p.matches=0}function it(p){8<p.bi_valid?Y(p,p.bi_buf):0<p.bi_valid&&(p.pending_buf[p.pending++]=p.bi_buf),p.bi_buf=0,p.bi_valid=0}function dt(p,E,L,N){var I=2*E,$=2*L;return p[I]<p[$]||p[I]===p[$]&&N[E]<=N[L]}function ot(p,E,L){for(var N=p.heap[L],I=L<<1;I<=p.heap_len&&(I<p.heap_len&&dt(E,p.heap[I+1],p.heap[I],p.depth)&&I++,!dt(E,N,p.heap[I],p.depth));)p.heap[L]=p.heap[I],L=I,I<<=1;p.heap[L]=N}function pt(p,E,L){var N,I,$,G,H=0;if(p.last_lit!==0)for(;N=p.pending_buf[p.d_buf+2*H]<<8|p.pending_buf[p.d_buf+2*H+1],I=p.pending_buf[p.l_buf+H],H++,N===0?X(p,I,E):(X(p,($=o[I])+m+1,E),(G=O[$])!==0&&q(p,I-=D[$],G),X(p,$=z(--N),L),(G=j[$])!==0&&q(p,N-=W[$],G)),H<p.last_lit;);X(p,k,E)}function ft(p,E){var L,N,I,$=E.dyn_tree,G=E.stat_desc.static_tree,H=E.stat_desc.has_stree,V=E.stat_desc.elems,st=-1;for(p.heap_len=0,p.heap_max=l,L=0;L<V;L++)$[2*L]!==0?(p.heap[++p.heap_len]=st=L,p.depth[L]=0):$[2*L+1]=0;for(;p.heap_len<2;)$[2*(I=p.heap[++p.heap_len]=st<2?++st:0)]=1,p.depth[I]=0,p.opt_len--,H&&(p.static_len-=G[2*I+1]);for(E.max_code=st,L=p.heap_len>>1;1<=L;L--)ot(p,$,L);for(I=V;L=p.heap[1],p.heap[1]=p.heap[p.heap_len--],ot(p,$,1),N=p.heap[1],p.heap[--p.heap_max]=L,p.heap[--p.heap_max]=N,$[2*I]=$[2*L]+$[2*N],p.depth[I]=(p.depth[L]>=p.depth[N]?p.depth[L]:p.depth[N])+1,$[2*L+1]=$[2*N+1]=I,p.heap[1]=I++,ot(p,$,1),2<=p.heap_len;);p.heap[--p.heap_max]=p.heap[1],(function(rt,ut){var _t,mt,vt,lt,xt,It,gt=ut.dyn_tree,Ot=ut.max_code,Ut=ut.stat_desc.static_tree,jt=ut.stat_desc.has_stree,Mt=ut.stat_desc.extra_bits,Rt=ut.stat_desc.extra_base,wt=ut.stat_desc.max_length,kt=0;for(lt=0;lt<=f;lt++)rt.bl_count[lt]=0;for(gt[2*rt.heap[rt.heap_max]+1]=0,_t=rt.heap_max+1;_t<l;_t++)wt<(lt=gt[2*gt[2*(mt=rt.heap[_t])+1]+1]+1)&&(lt=wt,kt++),gt[2*mt+1]=lt,Ot<mt||(rt.bl_count[lt]++,xt=0,Rt<=mt&&(xt=Mt[mt-Rt]),It=gt[2*mt],rt.opt_len+=It*(lt+xt),jt&&(rt.static_len+=It*(Ut[2*mt+1]+xt)));if(kt!==0){do{for(lt=wt-1;rt.bl_count[lt]===0;)lt--;rt.bl_count[lt]--,rt.bl_count[lt+1]+=2,rt.bl_count[wt]--,kt-=2}while(0<kt);for(lt=wt;lt!==0;lt--)for(mt=rt.bl_count[lt];mt!==0;)Ot<(vt=rt.heap[--_t])||(gt[2*vt+1]!==lt&&(rt.opt_len+=(lt-gt[2*vt+1])*gt[2*vt],gt[2*vt+1]=lt),mt--)}})(p,E),ht($,st,p.bl_count)}function n(p,E,L){var N,I,$=-1,G=E[1],H=0,V=7,st=4;for(G===0&&(V=138,st=3),E[2*(L+1)+1]=65535,N=0;N<=L;N++)I=G,G=E[2*(N+1)+1],++H<V&&I===G||(H<st?p.bl_tree[2*I]+=H:I!==0?(I!==$&&p.bl_tree[2*I]++,p.bl_tree[2*C]++):H<=10?p.bl_tree[2*S]++:p.bl_tree[2*F]++,$=I,st=(H=0)===G?(V=138,3):I===G?(V=6,3):(V=7,4))}function P(p,E,L){var N,I,$=-1,G=E[1],H=0,V=7,st=4;for(G===0&&(V=138,st=3),N=0;N<=L;N++)if(I=G,G=E[2*(N+1)+1],!(++H<V&&I===G)){if(H<st)for(;X(p,I,p.bl_tree),--H!=0;);else I!==0?(I!==$&&(X(p,I,p.bl_tree),H--),X(p,C,p.bl_tree),q(p,H-3,2)):H<=10?(X(p,S,p.bl_tree),q(p,H-3,3)):(X(p,F,p.bl_tree),q(p,H-11,7));$=I,st=(H=0)===G?(V=138,3):I===G?(V=6,3):(V=7,4)}}d(W);var B=!1;function y(p,E,L,N){q(p,(_<<1)+(N?1:0),3),(function(I,$,G,H){it(I),Y(I,G),Y(I,~G),e.arraySet(I.pending_buf,I.window,$,G,I.pending),I.pending+=G})(p,E,L)}a._tr_init=function(p){B||((function(){var E,L,N,I,$,G=new Array(f+1);for(I=N=0;I<b-1;I++)for(D[I]=N,E=0;E<1<<O[I];E++)o[N++]=I;for(o[N-1]=I,I=$=0;I<16;I++)for(W[I]=$,E=0;E<1<<j[I];E++)R[$++]=I;for($>>=7;I<c;I++)for(W[I]=$<<7,E=0;E<1<<j[I]-7;E++)R[256+$++]=I;for(L=0;L<=f;L++)G[L]=0;for(E=0;E<=143;)K[2*E+1]=8,E++,G[8]++;for(;E<=255;)K[2*E+1]=9,E++,G[9]++;for(;E<=279;)K[2*E+1]=7,E++,G[7]++;for(;E<=287;)K[2*E+1]=8,E++,G[8]++;for(ht(K,w+1,G),E=0;E<c;E++)x[2*E+1]=5,x[2*E]=at(E,5);Q=new J(K,O,m+1,w,f),M=new J(x,j,0,c,f),et=new J(new Array(0),T,0,g,v)})(),B=!0),p.l_desc=new A(p.dyn_ltree,Q),p.d_desc=new A(p.dyn_dtree,M),p.bl_desc=new A(p.bl_tree,et),p.bi_buf=0,p.bi_valid=0,nt(p)},a._tr_stored_block=y,a._tr_flush_block=function(p,E,L,N){var I,$,G=0;0<p.level?(p.strm.data_type===2&&(p.strm.data_type=(function(H){var V,st=4093624447;for(V=0;V<=31;V++,st>>>=1)if(1&st&&H.dyn_ltree[2*V]!==0)return r;if(H.dyn_ltree[18]!==0||H.dyn_ltree[20]!==0||H.dyn_ltree[26]!==0)return s;for(V=32;V<m;V++)if(H.dyn_ltree[2*V]!==0)return s;return r})(p)),ft(p,p.l_desc),ft(p,p.d_desc),G=(function(H){var V;for(n(H,H.dyn_ltree,H.l_desc.max_code),n(H,H.dyn_dtree,H.d_desc.max_code),ft(H,H.bl_desc),V=g-1;3<=V&&H.bl_tree[2*Z[V]+1]===0;V--);return H.opt_len+=3*(V+1)+5+5+4,V})(p),I=p.opt_len+3+7>>>3,($=p.static_len+3+7>>>3)<=I&&(I=$)):I=$=L+5,L+4<=I&&E!==-1?y(p,E,L,N):p.strategy===4||$===I?(q(p,2+(N?1:0),3),pt(p,K,x)):(q(p,4+(N?1:0),3),(function(H,V,st,rt){var ut;for(q(H,V-257,5),q(H,st-1,5),q(H,rt-4,4),ut=0;ut<rt;ut++)q(H,H.bl_tree[2*Z[ut]+1],3);P(H,H.dyn_ltree,V-1),P(H,H.dyn_dtree,st-1)})(p,p.l_desc.max_code+1,p.d_desc.max_code+1,G+1),pt(p,p.dyn_ltree,p.dyn_dtree)),nt(p),N&&it(p)},a._tr_tally=function(p,E,L){return p.pending_buf[p.d_buf+2*p.last_lit]=E>>>8&255,p.pending_buf[p.d_buf+2*p.last_lit+1]=255&E,p.pending_buf[p.l_buf+p.last_lit]=255&L,p.last_lit++,E===0?p.dyn_ltree[2*L]++:(p.matches++,E--,p.dyn_ltree[2*(o[L]+m+1)]++,p.dyn_dtree[2*z(E)]++),p.last_lit===p.lit_bufsize-1},a._tr_align=function(p){q(p,2,3),X(p,k,K),(function(E){E.bi_valid===16?(Y(E,E.bi_buf),E.bi_buf=0,E.bi_valid=0):8<=E.bi_valid&&(E.pending_buf[E.pending++]=255&E.bi_buf,E.bi_buf>>=8,E.bi_valid-=8)})(p)}},{"../utils/common":41}],53:[function(t,u,a){u.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,u,a){(function(e){(function(r,s){if(!r.setImmediate){var d,_,b,m,w=1,c={},g=!1,l=r.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(r);f=f&&f.setTimeout?f:r,d={}.toString.call(r.process)==="[object process]"?function(C){process.nextTick(function(){v(C)})}:(function(){if(r.postMessage&&!r.importScripts){var C=!0,S=r.onmessage;return r.onmessage=function(){C=!1},r.postMessage("","*"),r.onmessage=S,C}})()?(m="setImmediate$"+Math.random()+"$",r.addEventListener?r.addEventListener("message",k,!1):r.attachEvent("onmessage",k),function(C){r.postMessage(m+C,"*")}):r.MessageChannel?((b=new MessageChannel).port1.onmessage=function(C){v(C.data)},function(C){b.port2.postMessage(C)}):l&&"onreadystatechange"in l.createElement("script")?(_=l.documentElement,function(C){var S=l.createElement("script");S.onreadystatechange=function(){v(C),S.onreadystatechange=null,_.removeChild(S),S=null},_.appendChild(S)}):function(C){setTimeout(v,0,C)},f.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var S=new Array(arguments.length-1),F=0;F<S.length;F++)S[F]=arguments[F+1];var O={callback:C,args:S};return c[w]=O,d(w),w++},f.clearImmediate=h}function h(C){delete c[C]}function v(C){if(g)setTimeout(v,0,C);else{var S=c[C];if(S){g=!0;try{(function(F){var O=F.callback,j=F.args;switch(j.length){case 0:O();break;case 1:O(j[0]);break;case 2:O(j[0],j[1]);break;case 3:O(j[0],j[1],j[2]);break;default:O.apply(s,j)}})(S)}finally{h(C),g=!1}}}}function k(C){C.source===r&&typeof C.data=="string"&&C.data.indexOf(m)===0&&v(+C.data.slice(m.length))}})(typeof self>"u"?e===void 0?this:e:self)}).call(this,typeof Et<"u"?Et:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(zt)),zt.exports}var qt=Xt();const Lt=Ht(qt);class Gt{constructor(){tt(this,"scriptLoaded",!1);this.ensureScriptLoaded()}ensureScriptLoaded(){if(this.scriptLoaded)return;if(typeof window.officeParser<"u"){this.scriptLoaded=!0;return}if(document.querySelector('script[src="/officeparser.browser.js"]')){this.scriptLoaded=!0;return}throw new Error('officeparser.browser.js not loaded. Add <script src="/officeparser.browser.js"><\/script> to index.html')}async parseFile(i){this.ensureScriptLoaded();const t=await i.arrayBuffer(),u=await window.officeParser.parseOffice(t),a=await this.extractSectionProperties(t),e=this.normalizeAST(u);return e.sectionProperties=a,e}async extractSectionProperties(i){try{const u=await(await Lt.loadAsync(i)).file("word/document.xml")?.async("string");if(!u)return{};const r=new DOMParser().parseFromString(u,"application/xml").getElementsByTagName("w:sectPr");if(r.length===0)return{};const d=r[r.length-1].getElementsByTagName("w:cols");if(d.length===0)return{};const _=d[0],b=_.getAttribute("w:num"),m=_.getAttribute("w:space"),w={};return b&&(w.columnCount=parseInt(b,10)),m&&(w.columnSpace=parseInt(m,10)),w}catch(t){return console.warn("Failed to extract section properties:",t),{}}}normalizeAST(i){const t=[],u={author:i.author||void 0,title:i.title||void 0,created:i.created?new Date(i.created):void 0,modified:i.modified?new Date(i.modified):void 0};return Array.isArray(i.content)&&i.content.forEach((a,e)=>{if(a.type&&a.type!=="paragraph"&&a.type!=="heading"&&a.type!=="table"&&console.log(`[DocxParser] Unhandled item type at index ${e}:`,a.type,a),a.type==="paragraph"||a.type==="heading"){const r=this.normalizeParagraph(a,e);r&&t.push(r)}else if(a.type==="table"){const r=this.normalizeTable(a,e);r&&t.push(r)}else(a.type==="page-break"||a.type==="break")&&t.push({id:`page-break-${e}`,type:"page-break",text:"",runs:[],formatting:{}})}),{metadata:u,blocks:t}}normalizeParagraph(i,t){let u="paragraph";if(i.style){const r=i.style.toLowerCase();r.includes("heading1")||r.includes("heading 1")?u="heading1":r.includes("heading2")||r.includes("heading 2")?u="heading2":(r.includes("heading3")||r.includes("heading 3"))&&(u="heading3")}let a=i.text||"";const e=[];if(Array.isArray(i.runs)&&i.runs.length>0&&(i.runs.forEach(r=>{const s=r.text||"";s&&e.push({text:s,formatting:this.extractFormatting(r)})}),a=e.map(r=>r.text).join("").trim().replace(/\s+/g," ")),e.length===0&&a){const r=a.trim().replace(/\s+/g," ");e.push({text:r,formatting:this.extractFormatting(i)}),a=r}return a.trim()?{id:this.generateBlockId(a,t),type:u,text:a.trim().replace(/\s+/g," "),runs:e,formatting:this.extractFormatting(i)}:null}normalizeTable(i,t){let u="";if(Array.isArray(i.rows)&&i.rows.forEach(e=>{if(Array.isArray(e.cells)){const r=e.cells.map(s=>s.text||"").filter(s=>s.trim());r.length>0&&(u+=r.join(" | ")+`
`)}}),!u.trim())return null;const a=u.trim().replace(/\s+/g," ");return{id:this.generateBlockId(a,t),type:"table",text:a,runs:[{text:a,formatting:{}}],formatting:{}}}extractFormatting(i){const t={};return i.bold===!0&&(t.bold=!0),i.italic===!0&&(t.italic=!0),i.underline===!0&&(t.underline=!0),i.color&&(t.color=i.color),i.font&&(t.font=i.font),i.fontSize&&(t.fontSize=i.fontSize),t}generateBlockId(i,t){const u=this.simpleHash(i.substring(0,100));return`block-${t}-${u}`}simpleHash(i){let t=0;for(let u=0;u<i.length;u++){const a=i.charCodeAt(u);t=(t<<5)-t+a,t=t&t}return Math.abs(t).toString(36)}terminate(){}}function yt(){}yt.prototype={diff:function(i,t){var u,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},e=a.callback;typeof a=="function"&&(e=a,a={}),this.options=a;var r=this;function s(C){return e?(setTimeout(function(){e(void 0,C)},0),!0):C}i=this.castInput(i),t=this.castInput(t),i=this.removeEmpty(this.tokenize(i)),t=this.removeEmpty(this.tokenize(t));var d=t.length,_=i.length,b=1,m=d+_;a.maxEditLength&&(m=Math.min(m,a.maxEditLength));var w=(u=a.timeout)!==null&&u!==void 0?u:1/0,c=Date.now()+w,g=[{oldPos:-1,lastComponent:void 0}],l=this.extractCommon(g[0],t,i,0);if(g[0].oldPos+1>=_&&l+1>=d)return s([{value:this.join(t),count:t.length}]);var f=-1/0,h=1/0;function v(){for(var C=Math.max(f,-b);C<=Math.min(h,b);C+=2){var S=void 0,F=g[C-1],O=g[C+1];F&&(g[C-1]=void 0);var j=!1;if(O){var T=O.oldPos-C;j=O&&0<=T&&T<d}var Z=F&&F.oldPos+1<_;if(!j&&!Z){g[C]=void 0;continue}if(!Z||j&&F.oldPos+1<O.oldPos?S=r.addToPath(O,!0,void 0,0):S=r.addToPath(F,void 0,!0,1),l=r.extractCommon(S,t,i,C),S.oldPos+1>=_&&l+1>=d)return s(Vt(r,S.lastComponent,t,i,r.useLongestToken));g[C]=S,S.oldPos+1>=_&&(h=Math.min(h,C-1)),l+1>=d&&(f=Math.max(f,C+1))}b++}if(e)(function C(){setTimeout(function(){if(b>m||Date.now()>c)return e();v()||C()},0)})();else for(;b<=m&&Date.now()<=c;){var k=v();if(k)return k}},addToPath:function(i,t,u,a){var e=i.lastComponent;return e&&e.added===t&&e.removed===u?{oldPos:i.oldPos+a,lastComponent:{count:e.count+1,added:t,removed:u,previousComponent:e.previousComponent}}:{oldPos:i.oldPos+a,lastComponent:{count:1,added:t,removed:u,previousComponent:e}}},extractCommon:function(i,t,u,a){for(var e=t.length,r=u.length,s=i.oldPos,d=s-a,_=0;d+1<e&&s+1<r&&this.equals(t[d+1],u[s+1]);)d++,s++,_++;return _&&(i.lastComponent={count:_,previousComponent:i.lastComponent}),i.oldPos=s,d},equals:function(i,t){return this.options.comparator?this.options.comparator(i,t):i===t||this.options.ignoreCase&&i.toLowerCase()===t.toLowerCase()},removeEmpty:function(i){for(var t=[],u=0;u<i.length;u++)i[u]&&t.push(i[u]);return t},castInput:function(i){return i},tokenize:function(i){return i.split("")},join:function(i){return i.join("")}};function Vt(U,i,t,u,a){for(var e=[],r;i;)e.push(i),r=i.previousComponent,delete i.previousComponent,i=r;e.reverse();for(var s=0,d=e.length,_=0,b=0;s<d;s++){var m=e[s];if(m.removed){if(m.value=U.join(u.slice(b,b+m.count)),b+=m.count,s&&e[s-1].added){var c=e[s-1];e[s-1]=e[s],e[s]=c}}else{if(!m.added&&a){var w=t.slice(_,_+m.count);w=w.map(function(l,f){var h=u[b+f];return h.length>l.length?h:l}),m.value=U.join(w)}else m.value=U.join(t.slice(_,_+m.count));_+=m.count,m.added||(b+=m.count)}}var g=e[d-1];return d>1&&typeof g.value=="string"&&(g.added||g.removed)&&U.equals("",g.value)&&(e[d-2].value+=g.value,e.pop()),e}function Yt(U,i){if(typeof U=="function")i.callback=U;else if(U)for(var t in U)U.hasOwnProperty(t)&&(i[t]=U[t]);return i}var Ft=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,Dt=/\S/,Tt=new yt;Tt.equals=function(U,i){return this.options.ignoreCase&&(U=U.toLowerCase(),i=i.toLowerCase()),U===i||this.options.ignoreWhitespace&&!Dt.test(U)&&!Dt.test(i)};Tt.tokenize=function(U){for(var i=U.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),t=0;t<i.length-1;t++)!i[t+1]&&i[t+2]&&Ft.test(i[t])&&Ft.test(i[t+2])&&(i[t]+=i[t+2],i.splice(t+1,2),t--);return i};function Kt(U,i,t){return t=Yt(t,{ignoreWhitespace:!0}),Tt.diff(U,i,t)}var Nt=new yt;Nt.tokenize=function(U){this.options.stripTrailingCr&&(U=U.replace(/\r\n/g,`
`));var i=[],t=U.split(/(\n|\r\n)/);t[t.length-1]||t.pop();for(var u=0;u<t.length;u++){var a=t[u];u%2&&!this.options.newlineIsToken?i[i.length-1]+=a:(this.options.ignoreWhitespace&&(a=a.trim()),i.push(a))}return i};var Jt=new yt;Jt.tokenize=function(U){return U.split(/(\S.+?[.!?])(?=\s+|$)/)};var Qt=new yt;Qt.tokenize=function(U){return U.split(/([{}:;,]|\s+)/)};function St(U){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?St=function(i){return typeof i}:St=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},St(U)}var te=Object.prototype.toString,bt=new yt;bt.useLongestToken=!0;bt.tokenize=Nt.tokenize;bt.castInput=function(U){var i=this.options,t=i.undefinedReplacement,u=i.stringifyReplacer,a=u===void 0?function(e,r){return typeof r>"u"?t:r}:u;return typeof U=="string"?U:JSON.stringify(At(U,null,null,a),a,"  ")};bt.equals=function(U,i){return yt.prototype.equals.call(bt,U.replace(/,([\r\n])/g,"$1"),i.replace(/,([\r\n])/g,"$1"))};function At(U,i,t,u,a){i=i||[],t=t||[],u&&(U=u(a,U));var e;for(e=0;e<i.length;e+=1)if(i[e]===U)return t[e];var r;if(te.call(U)==="[object Array]"){for(i.push(U),r=new Array(U.length),t.push(r),e=0;e<U.length;e+=1)r[e]=At(U[e],i,t,u,a);return i.pop(),t.pop(),r}if(U&&U.toJSON&&(U=U.toJSON()),St(U)==="object"&&U!==null){i.push(U),r={},t.push(r);var s=[],d;for(d in U)U.hasOwnProperty(d)&&s.push(d);for(s.sort(),e=0;e<s.length;e+=1)d=s[e],r[d]=At(U[d],i,t,u,d);i.pop(),t.pop()}else r=U;return r}var Bt=new yt;Bt.tokenize=function(U){return U.slice()};Bt.join=Bt.removeEmpty=function(U){return U};class ee{constructor(){}diffDocuments(i,t){const u=this.alignBlocks(i.blocks,t.blocks),a=[];let e=0;return u.forEach(([r,s])=>{if(!r&&s)a.push({type:"insert",currentBlock:s,changeId:`change-${e++}`});else if(r&&!s)a.push({type:"delete",originalBlock:r,changeId:`change-${e++}`});else if(r&&s)if(r.text===s.text&&this.formatingsEqual(r.formatting,s.formatting))a.push({type:"unchanged",originalBlock:r,currentBlock:s});else{const d=Kt(r.text,s.text),_=this.diffFormatting(r,s,d),b=d.some(m=>m.added||m.removed)||_.some(m=>m.type==="format-change");a.push({type:b?"modify":"unchanged",originalBlock:r,currentBlock:s,wordDiff:d,formatDiff:_,changeId:b?`change-${e++}`:void 0})}}),{blockDiffs:a,totalChanges:e,sectionProperties:t.sectionProperties}}alignBlocks(i,t){const u=[],a=m=>m.trim().replace(/\s+/g," "),e=m=>a(m.text),r=(m,w)=>{const c=a(m.text),g=a(w.text);if(c===g)return 1;if(!c||!g)return 0;const l=c.split(/\s+/),f=g.split(/\s+/),h=new Set(l),v=new Set(f);let k=0;return h.forEach(C=>{v.has(C)&&k++}),2*k/(h.size+v.size)},s=new Map;t.forEach(m=>{const w=e(m);s.has(w)||s.set(w,[]),s.get(w).push(m)});const d=new Set,_=[];i.forEach((m,w)=>{const c=e(m),g=s.get(c)||[];let l=!1;for(let f=0;f<g.length;f++){const h=t.indexOf(g[f]);if(!d.has(h)){u.push([m,g[f]]),d.add(h),l=!0;break}}l||_.push({block:m,index:w})});const b=.5;return _.forEach(({block:m,index:w})=>{let c=null;if(t.forEach((g,l)=>{if(d.has(l))return;const f=r(m,g);f>=b&&(!c||f>c.similarity)&&(c={block:g,index:l,similarity:f})}),c){const g=c;u.push([m,g.block]),d.add(g.index)}else u.push([m,null])}),t.forEach((m,w)=>{d.has(w)||u.push([null,m])}),u.sort((m,w)=>{const c=m[0]?i.indexOf(m[0]):1/0,g=w[0]?i.indexOf(w[0]):1/0;if(c!==g)return c-g;const l=m[1]?t.indexOf(m[1]):1/0,f=w[1]?t.indexOf(w[1]):1/0;return l-f}),u}diffFormatting(i,t,u){const a=[];return u.forEach(e=>{if(e.added)a.push({type:"insert",text:e.value,formatting:t.formatting});else if(e.removed)a.push({type:"delete",text:e.value,formatting:i.formatting});else{const r=this.compareFormatting(i.formatting,t.formatting);r.changed?a.push({type:"format-change",text:e.value,from:i.formatting,to:t.formatting,changes:r.changes}):a.push({type:"unchanged",text:e.value,formatting:i.formatting})}}),a}compareFormatting(i,t){const u={};let a=!1;return["bold","italic","underline","color","font","fontSize"].forEach(r=>{i[r]!==t[r]&&(u[r]={from:i[r],to:t[r]},a=!0)}),{changed:a,changes:u}}formatingsEqual(i,t){return i.bold===t.bold&&i.italic===t.italic&&i.underline===t.underline&&i.color===t.color&&i.font===t.font&&i.fontSize===t.fontSize}}class ne{constructor(i,t){tt(this,"leftPane");tt(this,"rightPane");tt(this,"redlinedPane",null);tt(this,"changeElements",[]);const u=document.getElementById(i),a=document.getElementById(t);if(!u||!a)throw new Error("Panes not found");this.leftPane=u,this.rightPane=a;const e=document.getElementById("pane-redlined-content");this.redlinedPane=e}render(i){this.changeElements=[];const t=[],u=[];i.blockDiffs.forEach(a=>{const[e,r]=this.renderBlockDiff(a);t.push(e),u.push(r)}),this.applyColumnStyling(this.leftPane,i.sectionProperties),this.applyColumnStyling(this.rightPane,i.sectionProperties),this.leftPane.innerHTML=t.join(""),this.rightPane.innerHTML=u.join(""),this.collectChangeElements()}renderBlockDiff(i){const t=i.changeId?` data-change-id="${i.changeId}"`:"";switch(i.type){case"insert":return[this.renderPlaceholder(),this.renderBlock(i.currentBlock,"inserted",t)];case"delete":return[this.renderBlock(i.originalBlock,"deleted",t),this.renderPlaceholder()];case"modify":return[this.renderModifiedBlock(i,"original",t),this.renderModifiedBlock(i,"current",t)];case"unchanged":default:return[this.renderBlock(i.originalBlock,"unchanged",""),this.renderBlock(i.currentBlock,"unchanged","")]}}renderBlock(i,t,u){if(i.type==="page-break")return`<div class="block block-page-break ${t==="inserted"?"block-inserted":t==="deleted"?"block-deleted":"block-unchanged"}"${u}>
        <div class="page-break-indicator">
          <span> Page Break </span>
        </div>
      </div>`;const a=t==="inserted"?"block-inserted":t==="deleted"?"block-deleted":"block-unchanged",e=`para-${i.type}`;let r="";return i.runs&&i.runs.length>0?r=i.runs.map(s=>this.renderFormattedText(s.text,s.formatting)).join(""):r=this.escapeHtml(i.text),`<div class="block ${a} ${e}"${u}>${r}</div>`}renderModifiedBlock(i,t,u){if(!i.wordDiff||!i.formatDiff){const s=t==="original"?i.originalBlock:i.currentBlock;return this.renderBlock(s,"unchanged",u)}const a=t==="original"?i.originalBlock:i.currentBlock;let r=`<div class="block block-modified ${`para-${a.type}`}"${u}>`;return i.wordDiff.forEach((s,d)=>{const _=i.formatDiff[d];t==="original"?s.removed?r+=`<span class="diff-delete">${this.escapeHtml(s.value)}</span>`:s.added||(_?.type==="format-change"?r+=this.renderFormattedText(s.value,_.from,!0):r+=this.renderFormattedText(s.value,a.formatting)):s.added?r+=`<span class="diff-insert">${this.escapeHtml(s.value)}</span>`:s.removed||(_?.type==="format-change"?r+=this.renderFormattedText(s.value,_.to,!0,_):r+=this.renderFormattedText(s.value,a.formatting))}),r+="</div>",r}renderPlaceholder(){return'<div class="block block-placeholder"></div>'}renderFormattedText(i,t,u=!1,a){let e=this.escapeHtml(i);t.bold&&(e=`<strong>${e}</strong>`),t.italic&&(e=`<em>${e}</em>`),t.underline&&(e=`<u>${e}</u>`);const r=[];return t.color&&r.push(`color: ${t.color}`),t.font&&r.push(`font-family: ${t.font}`),t.fontSize&&r.push(`font-size: ${t.fontSize}pt`),r.length>0&&(e=`<span style="${r.join("; ")}">${e}</span>`),u&&a&&(e=`<span class="diff-format-change" title="${this.formatChangeTooltip(a)}">${e}</span>`),e}formatChangeTooltip(i){const t=[];return Object.entries(i.changes).forEach(([u,a])=>{const e=a.from===void 0?"none":a.from,r=a.to===void 0?"none":a.to;t.push(`${u}: ${e}  ${r}`)}),t.join(", ")}escapeHtml(i){const t=document.createElement("div");return t.textContent=i,t.innerHTML}collectChangeElements(){this.changeElements=Array.from(this.leftPane.querySelectorAll("[data-change-id]"))}getChangeElements(){return this.changeElements}renderRedlined(i){if(!this.redlinedPane)return;this.changeElements=[];const t=[];i.blockDiffs.forEach(u=>{t.push(this.renderRedlinedBlock(u))}),this.applyColumnStyling(this.redlinedPane,i.sectionProperties),this.redlinedPane.innerHTML=t.join(""),this.collectChangeElementsRedlined()}applyColumnStyling(i,t){if(t?.columnCount&&t.columnCount>1){const u=t.columnSpace?Math.round(t.columnSpace/1440*96):24;i.style.columnCount=String(t.columnCount),i.style.columnGap=`${u}px`}else i.style.columnCount="",i.style.columnGap=""}renderRedlinedBlock(i){const t=i.changeId?` data-change-id="${i.changeId}"`:"";switch(i.type){case"insert":return this.renderBlock(i.currentBlock,"inserted",t);case"delete":return this.renderBlock(i.originalBlock,"deleted",t);case"modify":return this.renderRedlinedModifiedBlock(i,t);case"unchanged":return this.renderBlock(i.currentBlock,"unchanged","");default:return""}}renderRedlinedModifiedBlock(i,t){if(!i.wordDiff)return this.renderBlock(i.currentBlock,"unchanged",t);const u=i.currentBlock;let e=`<div class="block block-modified ${`para-${u.type}`}"${t}>`;return i.wordDiff.forEach(r=>{if(r.removed){const s=i.originalBlock,d=this.renderFormattedText(r.value,s.formatting);e+=`<span class="diff-delete">${d}</span>`}else if(r.added){const s=this.renderFormattedText(r.value,u.formatting);e+=`<span class="diff-insert">${s}</span>`}else e+=this.renderFormattedText(r.value,u.formatting)}),e+="</div>",e}collectChangeElementsRedlined(){this.redlinedPane&&(this.changeElements=Array.from(this.redlinedPane.querySelectorAll("[data-change-id]")))}}class re{constructor(i,t){tt(this,"leftPane");tt(this,"rightPane");tt(this,"syncing",!1);const u=document.getElementById(i),a=document.getElementById(t);if(!u||!a)throw new Error("Panes not found");this.leftPane=u,this.rightPane=a,this.setupListeners()}setupListeners(){this.leftPane.addEventListener("scroll",()=>this.syncScroll("left"),{passive:!0}),this.rightPane.addEventListener("scroll",()=>this.syncScroll("right"),{passive:!0})}syncScroll(i){if(this.syncing)return;this.syncing=!0;const t=i==="left"?this.leftPane:this.rightPane,u=i==="left"?this.rightPane:this.leftPane,a=t.scrollHeight-t.clientHeight;if(a<=0){this.syncing=!1;return}const e=t.scrollTop/a,r=u.scrollHeight-u.clientHeight;u.scrollTop=e*r,setTimeout(()=>{this.syncing=!1},0)}}class ie{constructor(i,t,u,a){tt(this,"changeElements");tt(this,"currentIndex",-1);tt(this,"prevButton");tt(this,"nextButton");tt(this,"counterElement");this.changeElements=i;const e=document.getElementById(t),r=document.getElementById(u),s=document.getElementById(a);if(!e||!r||!s)throw new Error("Navigation elements not found");this.prevButton=e,this.nextButton=r,this.counterElement=s,this.setupListeners(),this.updateUI()}setupListeners(){this.prevButton.addEventListener("click",()=>this.goToPrevious()),this.nextButton.addEventListener("click",()=>this.goToNext()),document.addEventListener("keydown",i=>{i.key==="n"&&!this.isInputFocused()?(i.preventDefault(),this.goToNext()):i.key==="p"&&!this.isInputFocused()&&(i.preventDefault(),this.goToPrevious())})}isInputFocused(){const i=document.activeElement;return i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement}goToNext(){this.currentIndex<this.changeElements.length-1?this.navigateToIndex(this.currentIndex+1):this.changeElements.length>0&&this.navigateToIndex(0)}goToPrevious(){this.currentIndex>0?this.navigateToIndex(this.currentIndex-1):this.changeElements.length>0&&this.navigateToIndex(this.changeElements.length-1)}navigateToIndex(i){this.currentIndex>=0&&this.currentIndex<this.changeElements.length&&this.changeElements[this.currentIndex].classList.remove("change-highlight"),this.currentIndex=i;const t=this.changeElements[this.currentIndex];t.classList.add("change-highlight"),t.scrollIntoView({behavior:"smooth",block:"center"}),this.updateUI()}updateUI(){const i=this.changeElements.length;if(i===0)this.counterElement.textContent="No changes",this.prevButton.disabled=!0,this.nextButton.disabled=!0;else{const t=this.currentIndex+1;this.counterElement.textContent=`${t} of ${i} changes`,this.prevButton.disabled=!1,this.nextButton.disabled=!1}}reset(){this.changeElements.forEach(i=>i.classList.remove("change-highlight")),this.currentIndex=-1,this.updateUI()}updateChangeElements(i){this.changeElements=i,this.reset(),i.length>0?this.navigateToIndex(0):this.updateUI()}}class se{export(i,t,u,a){const e=this.generateStandaloneHtml(i,t,u,a);this.downloadHtml(e,"document-comparison.html")}generateStandaloneHtml(i,t,u,a){return`<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document Comparison - ${u} vs ${a}</title>
  <style>
    ${this.getInlineStyles()}
  </style>
</head>
<body>
  <div class="redliner-container">
    <header class="redliner-header">
      <h1>Document Comparison</h1>
      <div class="file-info">
        <span><strong>Original:</strong> ${this.escapeHtml(u)}</span>
        <span><strong>Current:</strong> ${this.escapeHtml(a)}</span>
      </div>
    </header>

    <div class="comparison-panes">
      <div class="pane pane-original">
        <div class="pane-header">Original</div>
        <div class="pane-content">
          ${i}
        </div>
      </div>
      <div class="pane-divider"></div>
      <div class="pane pane-current">
        <div class="pane-header">Current</div>
        <div class="pane-content">
          ${t}
        </div>
      </div>
    </div>
  </div>
</body>
</html>`}getInlineStyles(){return`
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
  color: #24292f;
  background-color: #f6f8fa;
  line-height: 1.5;
}

.redliner-container {
  width: 100%;
  height: 100vh;
  display: flex;
  flex-direction: column;
}

.redliner-header {
  background: white;
  border-bottom: 1px solid #d0d7de;
  padding: 20px;
}

.redliner-header h1 {
  font-size: 24px;
  margin-bottom: 10px;
}

.file-info {
  display: flex;
  gap: 30px;
  font-size: 14px;
  color: #57606a;
}

.comparison-panes {
  display: flex;
  flex: 1;
  overflow: hidden;
  background: white;
}

.pane {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.pane-header {
  padding: 12px 20px;
  background: #f6f8fa;
  border-bottom: 1px solid #d0d7de;
  font-weight: 600;
  font-size: 14px;
}

.pane-content {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
}

.pane-divider {
  width: 1px;
  background: #d0d7de;
}

.block {
  margin-bottom: 16px;
  line-height: 1.6;
  padding: 8px 0;
}

.block-inserted {
  background-color: #dafbe1;
  border-left: 3px solid #2da44e;
  padding-left: 8px;
  padding-top: 8px;
  padding-bottom: 8px;
}

.block-deleted {
  background-color: #ffdce0;
  border-left: 3px solid #cf222e;
  padding-left: 8px;
  padding-top: 8px;
  padding-bottom: 8px;
}

.block-modified {
  padding-left: 8px;
}

.block-placeholder {
  background-color: #f6f8fa;
  color: #8c959f;
  padding: 8px;
  font-style: italic;
}

.diff-insert {
  background-color: #acf2bd;
  padding: 2px 4px;
  border-radius: 3px;
}

.diff-delete {
  background-color: #ffccd7;
  text-decoration: line-through;
  padding: 2px 4px;
  border-radius: 3px;
}

.diff-format-change {
  border-left: 3px solid #0969da;
  padding-left: 6px;
}

.para-heading1 {
  font-size: 24px;
  font-weight: 700;
  margin: 20px 0 12px 0;
}

.para-heading2 {
  font-size: 20px;
  font-weight: 700;
  margin: 16px 0 10px 0;
}

.para-heading3 {
  font-size: 16px;
  font-weight: 700;
  margin: 14px 0 8px 0;
}

.para-normal,
.para-paragraph {
  font-size: 14px;
  margin: 8px 0;
}
    `}downloadHtml(i,t){const u=new Blob([i],{type:"text/html"}),a=URL.createObjectURL(u),e=document.createElement("a");e.href=a,e.download=t,document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(a)}escapeHtml(i){const t=document.createElement("div");return t.textContent=i,t.innerHTML}}const ct={w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"};class ae{constructor(){tt(this,"zip",null);tt(this,"documentXml",null);tt(this,"comments",[]);tt(this,"nextCommentId",0);tt(this,"nextRevisionId",0);tt(this,"author","Document Comparison");tt(this,"date",new Date().toISOString())}async export(i,t,u){this.zip=await Lt.loadAsync(t);const a=await this.zip.file("word/document.xml")?.async("string");if(!a)throw new Error("Invalid DOCX: missing word/document.xml");const e=new DOMParser;this.documentXml=e.parseFromString(a,"application/xml"),this.comments=[],this.nextCommentId=0,this.nextRevisionId=0,this.date=new Date().toISOString();const r=Array.from(this.documentXml.getElementsByTagName("w:p"));this.processBlockDiffs(i.blockDiffs,r);const d=new XMLSerializer().serializeToString(this.documentXml);this.zip.file("word/document.xml",d),this.comments.length>0&&await this.addCommentsToZip();const _=await this.zip.generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});this.downloadBlob(_,`${this.getBaseName(u)}_redlined.docx`)}processBlockDiffs(i,t){const u=new Set,a=new Map;for(const e of i){if(e.type==="delete")continue;const r=e.currentBlock;if(!r||r.type==="page-break")continue;const s=this.matchBlockToParagraph(r,t,u);s&&(u.add(s),a.set(e,s))}for(let e=0;e<i.length;e++){const r=i[e];if(r.type==="unchanged")continue;if(r.type==="delete"){const _=r.originalBlock;if(!_||_.type==="page-break")continue;let b=null;for(let m=e+1;m<i.length;m++){const w=i[m];if(w.type!=="delete"&&(b=a.get(w)||null,b))break}this.insertDeletedParagraph(_,b);continue}const s=a.get(r);if(!s)continue;const d=r.currentBlock;switch(r.type){case"insert":this.markParagraphAsInserted(s,d);break;case"modify":this.applyWordLevelChanges(s,r);break}}}matchBlockToParagraph(i,t,u){const a=this.normalizeText(i.text);for(const e of t){if(u.has(e))continue;if(this.normalizeText(this.getParagraphText(e))===a)return e}for(const e of t){if(u.has(e))continue;const r=this.normalizeText(this.getParagraphText(e));if(r.length>0&&a.length>0){if(r.includes(a)||a.includes(r))return e;const s=Math.min(r.length,a.length,30);if(s>10&&r.substring(0,s)===a.substring(0,s))return e}}return null}getParagraphText(i){const t=i.getElementsByTagName("w:t");let u="";for(let a=0;a<t.length;a++)u+=t[a].textContent||"";return u}normalizeText(i){return i.trim().replace(/\s+/g," ").toLowerCase()}markParagraphAsInserted(i,t){const u=this.addComment(`Added: New ${t.type}`),a=Array.from(i.getElementsByTagName("w:r"));if(a.length===0)return;const e=a[0],r=this.createInsElement(),s=this.createCommentRangeStart(u);e.parentNode?.insertBefore(s,e);for(const b of a)this.applyInsertionFormatting(b),r.appendChild(b.cloneNode(!0));e.parentNode?.insertBefore(r,e);for(const b of a)b.parentNode?.removeChild(b);const d=this.createCommentRangeEnd(u),_=this.createCommentReference(u);r.parentNode?.insertBefore(d,r.nextSibling),d.parentNode?.insertBefore(_,d.nextSibling)}insertDeletedParagraph(i,t){const u=this.documentXml?.getElementsByTagName("w:body")[0];if(!u)return;const a=this.addComment(`Removed: Deleted ${i.type}`),e=this.documentXml.createElementNS(ct.w,"w:p");e.appendChild(this.createCommentRangeStart(a));const r=this.createDelElement(),s=this.createRunWithText(i.text,!0);if(r.appendChild(s),e.appendChild(r),e.appendChild(this.createCommentRangeEnd(a)),e.appendChild(this.createCommentReference(a)),t)t.parentNode?.insertBefore(e,t);else{const d=u.getElementsByTagName("w:sectPr")[0];d?u.insertBefore(e,d):u.appendChild(e)}}applyWordLevelChanges(i,t){if(!t.wordDiff||t.wordDiff.length===0)return;const u=i.getElementsByTagName("w:pPr")[0];for(;i.firstChild;)i.removeChild(i.firstChild);u&&i.appendChild(u);for(const a of t.wordDiff)if(a.added){const e=this.addComment(`Added: "${a.value.trim()}"`);i.appendChild(this.createCommentRangeStart(e));const r=this.createInsElement(),s=this.createRunWithText(a.value,!1,!0);r.appendChild(s),i.appendChild(r),i.appendChild(this.createCommentRangeEnd(e)),i.appendChild(this.createCommentReference(e))}else if(a.removed){const e=this.addComment(`Removed: "${a.value.trim()}"`);i.appendChild(this.createCommentRangeStart(e));const r=this.createDelElement(),s=this.createRunWithText(a.value,!0);r.appendChild(s),i.appendChild(r),i.appendChild(this.createCommentRangeEnd(e)),i.appendChild(this.createCommentReference(e))}else{const e=this.createRunWithText(a.value,!1,!1);i.appendChild(e)}}createInsElement(){const i=this.documentXml.createElementNS(ct.w,"w:ins");return i.setAttribute("w:id",String(this.nextRevisionId++)),i.setAttribute("w:author",this.author),i.setAttribute("w:date",this.date),i}createDelElement(){const i=this.documentXml.createElementNS(ct.w,"w:del");return i.setAttribute("w:id",String(this.nextRevisionId++)),i.setAttribute("w:author",this.author),i.setAttribute("w:date",this.date),i}createRunWithText(i,t,u=!1){const a=this.documentXml.createElementNS(ct.w,"w:r"),e=this.documentXml.createElementNS(ct.w,"w:rPr");if(t){const s=this.documentXml.createElementNS(ct.w,"w:color");s.setAttribute("w:val","FF0000"),e.appendChild(s);const d=this.documentXml.createElementNS(ct.w,"w:strike");e.appendChild(d)}else if(u){const s=this.documentXml.createElementNS(ct.w,"w:color");s.setAttribute("w:val","00A651"),e.appendChild(s);const d=this.documentXml.createElementNS(ct.w,"w:u");d.setAttribute("w:val","single"),e.appendChild(d)}a.appendChild(e);const r=this.documentXml.createElementNS(ct.w,t?"w:delText":"w:t");return r.setAttribute("xml:space","preserve"),r.textContent=i,a.appendChild(r),a}applyInsertionFormatting(i){let t=i.getElementsByTagName("w:rPr")[0];t||(t=this.documentXml.createElementNS(ct.w,"w:rPr"),i.insertBefore(t,i.firstChild));let u=t.getElementsByTagName("w:color")[0];u||(u=this.documentXml.createElementNS(ct.w,"w:color"),t.appendChild(u)),u.setAttribute("w:val","00A651");let a=t.getElementsByTagName("w:u")[0];a||(a=this.documentXml.createElementNS(ct.w,"w:u"),t.appendChild(a)),a.setAttribute("w:val","single")}createCommentRangeStart(i){const t=this.documentXml.createElementNS(ct.w,"w:commentRangeStart");return t.setAttribute("w:id",String(i)),t}createCommentRangeEnd(i){const t=this.documentXml.createElementNS(ct.w,"w:commentRangeEnd");return t.setAttribute("w:id",String(i)),t}createCommentReference(i){const t=this.documentXml.createElementNS(ct.w,"w:r"),u=this.documentXml.createElementNS(ct.w,"w:commentReference");return u.setAttribute("w:id",String(i)),t.appendChild(u),t}addComment(i){const t=this.nextCommentId++;return this.comments.push({id:t,text:i}),t}async addCommentsToZip(){const i=this.buildCommentsXml();this.zip.file("word/comments.xml",i),await this.updateRelationships(),await this.updateContentTypes()}buildCommentsXml(){return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:comments xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main"
            xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"
            xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006">
${this.comments.map(t=>`
    <w:comment w:id="${t.id}" w:author="${this.author}" w:date="${this.date}">
      <w:p>
        <w:r>
          <w:t>${this.escapeXml(t.text)}</w:t>
        </w:r>
      </w:p>
    </w:comment>`).join("")}
</w:comments>`}async updateRelationships(){const i="word/_rels/document.xml.rels";let t=await this.zip.file(i)?.async("string");if(t||(t=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
</Relationships>`),t.includes("comments.xml"))return;const u=t.match(/rId(\d+)/g)||[];let a=0;for(const s of u){const d=parseInt(s.replace("rId",""),10);d>a&&(a=d)}const r=`<Relationship Id="${`rId${a+1}`}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments" Target="comments.xml"/>`;t=t.replace("</Relationships>",`  ${r}
</Relationships>`),this.zip.file(i,t)}async updateContentTypes(){const i="[Content_Types].xml";let t=await this.zip.file(i)?.async("string");if(!t||t.includes("/word/comments.xml"))return;t=t.replace("</Types>",`  <Override PartName="/word/comments.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml"/>
</Types>`),this.zip.file(i,t)}escapeXml(i){return i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}downloadBlob(i,t){const u=URL.createObjectURL(i),a=document.createElement("a");a.href=u,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(u)}getBaseName(i){return i.replace(/\.(docx?|DOCX?)$/,"")}}class oe{constructor(){tt(this,"fileUpload");tt(this,"parser");tt(this,"diffEngine");tt(this,"renderer",null);tt(this,"scrollSync",null);tt(this,"navigator",null);tt(this,"exporter");tt(this,"docxInPlaceExporter");tt(this,"originalFileName","");tt(this,"currentFileName","");tt(this,"currentDiff",null);tt(this,"originalAST",null);tt(this,"currentAST",null);tt(this,"currentFileBuffer",null);tt(this,"currentViewMode","side-by-side");this.fileUpload=new $t,this.parser=new Gt,this.diffEngine=new ee,this.exporter=new se,this.docxInPlaceExporter=new ae,this.fileUpload.onFilesReady((i,t)=>{this.originalFileName=i.name,this.currentFileName=t.name,this.compareDocuments(i,t)}),this.setupExportButton(),this.setupDocxExportButton(),this.setupViewToggle()}async compareDocuments(i,t){try{this.showProgress("Parsing documents..."),this.currentFileBuffer=await t.arrayBuffer();const[u,a]=await Promise.all([this.parser.parseFile(i),this.parser.parseFile(t)]);this.updateProgress(50,"Comparing documents...");const e=this.diffEngine.diffDocuments(u,a);this.currentDiff=e,this.originalAST=u,this.currentAST=a,this.updateProgress(75,"Rendering comparison..."),this.renderComparison(e),this.updateProgress(100,"Complete!"),setTimeout(()=>{this.hideProgress(),this.showComparison()},500)}catch(u){console.error("Error comparing documents:",u),alert("Error comparing documents: "+(u instanceof Error?u.message:"Unknown error")),this.hideProgress()}}renderComparison(i){this.renderer||(this.renderer=new ne("pane-original-content","pane-current-content")),this.currentViewMode==="redlined"?this.renderer.renderRedlined(i):this.renderer.render(i),this.scrollSync||(this.scrollSync=new re("pane-original-content","pane-current-content"));const t=this.renderer.getChangeElements();this.navigator?this.navigator.updateChangeElements(t):this.navigator=new ie(t,"prev-change","next-change","change-counter")}showProgress(i){const t=document.getElementById("progress");t&&(t.style.display="block"),this.updateProgress(0,i)}updateProgress(i,t){const u=document.getElementById("progress-fill"),a=document.getElementById("progress-text");u&&(u.style.width=i+"%"),a&&(a.textContent=t)}hideProgress(){const i=document.getElementById("progress");i&&(i.style.display="none")}showComparison(){const i=document.getElementById("comparison"),t=document.getElementById("controls");i&&(i.style.display="flex"),t&&(t.style.display="flex")}setupExportButton(){const i=document.getElementById("export-html");i&&i.addEventListener("click",()=>this.exportHtml())}async exportHtml(){const i=document.getElementById("export-html"),t=document.getElementById("pane-original-content"),u=document.getElementById("pane-current-content");if(!(!t||!u)){this.setButtonLoading(i,!0,"Exporting...");try{await new Promise(a=>setTimeout(a,10)),this.exporter.export(t.innerHTML,u.innerHTML,this.originalFileName,this.currentFileName)}finally{this.setButtonLoading(i,!1,"Export HTML")}}}setupDocxExportButton(){const i=document.getElementById("export-docx");i&&i.addEventListener("click",()=>this.exportDocx())}async exportDocx(){const i=document.getElementById("export-docx");if(!this.currentDiff){alert("Please compare documents first before exporting.");return}if(!this.currentFileBuffer){alert("Current file buffer not available. Please try comparing documents again.");return}this.setButtonLoading(i,!0,"Exporting...");try{await new Promise(t=>setTimeout(t,10)),await this.docxInPlaceExporter.export(this.currentDiff,this.currentFileBuffer,this.originalFileName)}catch(t){console.error("DOCX export failed:",t),alert("Failed to export DOCX. Please try again.")}finally{this.setButtonLoading(i,!1,"Export DOCX")}}setButtonLoading(i,t,u){i&&(t?(i.classList.add("exporting"),i.innerHTML=`<span class="spinner"></span>${u}`):(i.classList.remove("exporting"),i.textContent=u))}setupViewToggle(){const i=document.getElementById("redline-toggle");i&&i.addEventListener("change",()=>this.switchViewMode(i.checked))}switchViewMode(i){if(this.currentViewMode=i?"redlined":"side-by-side",this.currentDiff&&this.renderer){i?(this.showRedlinedView(),this.renderer.renderRedlined(this.currentDiff)):(this.showSideBySideView(),this.renderer.render(this.currentDiff));const t=this.renderer.getChangeElements();this.navigator&&this.navigator.updateChangeElements(t)}}showSideBySideView(){const i=document.getElementById("pane-original-content"),t=document.getElementById("pane-current-content"),u=document.getElementById("pane-redlined-content"),a=document.querySelector(".pane-divider");i?.parentElement&&(i.parentElement.style.display="flex"),t?.parentElement&&(t.parentElement.style.display="flex"),a&&(a.style.display="block"),u?.parentElement&&(u.parentElement.style.display="none")}showRedlinedView(){const i=document.getElementById("pane-original-content"),t=document.getElementById("pane-current-content"),u=document.getElementById("pane-redlined-content"),a=document.querySelector(".pane-divider");i?.parentElement&&(i.parentElement.style.display="none"),t?.parentElement&&(t.parentElement.style.display="none"),a&&(a.style.display="none"),u?.parentElement&&(u.parentElement.style.display="flex")}}new oe;
