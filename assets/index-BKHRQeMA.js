var $t=Object.defineProperty;var Xt=(j,r,t)=>r in j?$t(j,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):j[r]=t;var tt=(j,r,t)=>Xt(j,typeof r!="symbol"?r+"":r,t);(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))c(a);new MutationObserver(a=>{for(const e of a)if(e.type==="childList")for(const n of e.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&c(n)}).observe(document,{childList:!0,subtree:!0});function t(a){const e={};return a.integrity&&(e.integrity=a.integrity),a.referrerPolicy&&(e.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?e.credentials="include":a.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function c(a){if(a.ep)return;a.ep=!0;const e=t(a);fetch(a.href,e)}})();class Ht{constructor(){tt(this,"originalFile",null);tt(this,"currentFile",null);tt(this,"onFileChangeCallback",null);this.initializeUploadHandlers()}initializeUploadHandlers(){const r=document.getElementById("original-upload"),t=document.getElementById("current-upload"),c=r.parentElement?.querySelector(".upload-label"),a=t.parentElement?.querySelector(".upload-label");r.addEventListener("change",e=>{const n=e.target.files?.[0];n&&this.handleOriginalFile(n)}),t.addEventListener("change",e=>{const n=e.target.files?.[0];n&&this.handleCurrentFile(n)}),c&&this.setupDragAndDrop(c,e=>this.handleOriginalFile(e)),a&&this.setupDragAndDrop(a,e=>this.handleCurrentFile(e))}setupDragAndDrop(r,t){r.addEventListener("dragover",c=>{c.preventDefault(),r.classList.add("drag-over")}),r.addEventListener("dragleave",()=>{r.classList.remove("drag-over")}),r.addEventListener("drop",c=>{c.preventDefault(),r.classList.remove("drag-over");const a=c.dataTransfer?.files[0];a&&a.name.endsWith(".docx")?t(a):alert("Please drop a .docx file")})}handleOriginalFile(r){this.originalFile=r,this.updateFileDisplay("original",r.name),this.notifyFileChange()}handleCurrentFile(r){this.currentFile=r,this.updateFileDisplay("current",r.name),this.notifyFileChange()}updateFileDisplay(r,t){const c=document.getElementById(`${r}-name`),a=document.getElementById(`${r}-upload`)?.parentElement?.querySelector(".upload-label");c&&(c.textContent=t),a&&a.classList.add("has-file")}notifyFileChange(){this.onFileChangeCallback&&this.onFileChangeCallback(!!this.originalFile,!!this.currentFile)}onFileChange(r){this.onFileChangeCallback=r}areBothFilesReady(){return!!this.originalFile&&!!this.currentFile}getFiles(){return!this.originalFile||!this.currentFile?null:{original:this.originalFile,current:this.currentFile}}onFilesReady(r){console.warn("onFilesReady is deprecated. Use onFileChange() and getFiles() instead.")}reset(){this.originalFile=null,this.currentFile=null;const r=document.getElementById("original-upload"),t=document.getElementById("current-upload");r&&(r.value=""),t&&(t.value=""),["original","current"].forEach(c=>{const a=document.getElementById(`${c}-name`),e=document.getElementById(`${c}-upload`)?.parentElement?.querySelector(".upload-label");a&&(a.textContent=""),e&&e.classList.remove("has-file")}),this.notifyFileChange()}}var Ct=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gt(j){return j&&j.__esModule&&Object.prototype.hasOwnProperty.call(j,"default")?j.default:j}function Et(j){throw new Error('Could not dynamically require "'+j+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var zt={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Nt;function qt(){return Nt||(Nt=1,(function(j,r){(function(t){j.exports=t()})(function(){return(function t(c,a,e){function n(d,w){if(!a[d]){if(!c[d]){var m=typeof Et=="function"&&Et;if(!w&&m)return m(d,!0);if(i)return i(d,!0);var v=new Error("Cannot find module '"+d+"'");throw v.code="MODULE_NOT_FOUND",v}var u=a[d]={exports:{}};c[d][0].call(u.exports,function(g){var h=c[d][1][g];return n(h||g)},u,u.exports,t,c,a,e)}return a[d].exports}for(var i=typeof Et=="function"&&Et,o=0;o<e.length;o++)n(e[o]);return n})({1:[function(t,c,a){var e=t("./utils"),n=t("./support"),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(o){for(var d,w,m,v,u,g,h,f=[],p=0,b=o.length,k=b,C=e.getTypeOf(o)!=="string";p<o.length;)k=b-p,m=C?(d=o[p++],w=p<b?o[p++]:0,p<b?o[p++]:0):(d=o.charCodeAt(p++),w=p<b?o.charCodeAt(p++):0,p<b?o.charCodeAt(p++):0),v=d>>2,u=(3&d)<<4|w>>4,g=1<k?(15&w)<<2|m>>6:64,h=2<k?63&m:64,f.push(i.charAt(v)+i.charAt(u)+i.charAt(g)+i.charAt(h));return f.join("")},a.decode=function(o){var d,w,m,v,u,g,h=0,f=0,p="data:";if(o.substr(0,p.length)===p)throw new Error("Invalid base64 input, it looks like a data url.");var b,k=3*(o=o.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(o.charAt(o.length-1)===i.charAt(64)&&k--,o.charAt(o.length-2)===i.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(b=n.uint8array?new Uint8Array(0|k):new Array(0|k);h<o.length;)d=i.indexOf(o.charAt(h++))<<2|(v=i.indexOf(o.charAt(h++)))>>4,w=(15&v)<<4|(u=i.indexOf(o.charAt(h++)))>>2,m=(3&u)<<6|(g=i.indexOf(o.charAt(h++))),b[f++]=d,u!==64&&(b[f++]=w),g!==64&&(b[f++]=m);return b}},{"./support":30,"./utils":32}],2:[function(t,c,a){var e=t("./external"),n=t("./stream/DataWorker"),i=t("./stream/Crc32Probe"),o=t("./stream/DataLengthProbe");function d(w,m,v,u,g){this.compressedSize=w,this.uncompressedSize=m,this.crc32=v,this.compression=u,this.compressedContent=g}d.prototype={getContentWorker:function(){var w=new n(e.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),m=this;return w.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),w},getCompressedWorker:function(){return new n(e.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(w,m,v){return w.pipe(new i).pipe(new o("uncompressedSize")).pipe(m.compressWorker(v)).pipe(new o("compressedSize")).withStreamInfo("compression",m)},c.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,c,a){var e=t("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new e("STORE compression")},uncompressWorker:function(){return new e("STORE decompression")}},a.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,c,a){var e=t("./utils"),n=(function(){for(var i,o=[],d=0;d<256;d++){i=d;for(var w=0;w<8;w++)i=1&i?3988292384^i>>>1:i>>>1;o[d]=i}return o})();c.exports=function(i,o){return i!==void 0&&i.length?e.getTypeOf(i)!=="string"?(function(d,w,m,v){var u=n,g=v+m;d^=-1;for(var h=v;h<g;h++)d=d>>>8^u[255&(d^w[h])];return-1^d})(0|o,i,i.length,0):(function(d,w,m,v){var u=n,g=v+m;d^=-1;for(var h=v;h<g;h++)d=d>>>8^u[255&(d^w.charCodeAt(h))];return-1^d})(0|o,i,i.length,0):0}},{"./utils":32}],5:[function(t,c,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(t,c,a){var e=null;e=typeof Promise<"u"?Promise:t("lie"),c.exports={Promise:e}},{lie:37}],7:[function(t,c,a){var e=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",n=t("pako"),i=t("./utils"),o=t("./stream/GenericWorker"),d=e?"uint8array":"array";function w(m,v){o.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=v,this.meta={}}a.magic="\b\0",i.inherits(w,o),w.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(i.transformTo(d,m.data),!1)},w.prototype.flush=function(){o.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},w.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},w.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(v){m.push({data:v,meta:m.meta})}},a.compressWorker=function(m){return new w("Deflate",m)},a.uncompressWorker=function(){return new w("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,c,a){function e(u,g){var h,f="";for(h=0;h<g;h++)f+=String.fromCharCode(255&u),u>>>=8;return f}function n(u,g,h,f,p,b){var k,C,E=u.file,F=u.compression,B=b!==d.utf8encode,U=i.transformTo("string",b(E.name)),R=i.transformTo("string",d.utf8encode(E.name)),Z=E.comment,V=i.transformTo("string",b(Z)),x=i.transformTo("string",d.utf8encode(Z)),D=R.length!==E.name.length,l=x.length!==Z.length,N="",Q="",W="",et=E.dir,M=E.date,J={crc32:0,compressedSize:0,uncompressedSize:0};g&&!h||(J.crc32=u.crc32,J.compressedSize=u.compressedSize,J.uncompressedSize=u.uncompressedSize);var z=0;g&&(z|=8),B||!D&&!l||(z|=2048);var I=0,K=0;et&&(I|=16),p==="UNIX"?(K=798,I|=(function(H,ot){var ht=H;return H||(ht=ot?16893:33204),(65535&ht)<<16})(E.unixPermissions,et)):(K=20,I|=(function(H){return 63&(H||0)})(E.dosPermissions)),k=M.getUTCHours(),k<<=6,k|=M.getUTCMinutes(),k<<=5,k|=M.getUTCSeconds()/2,C=M.getUTCFullYear()-1980,C<<=4,C|=M.getUTCMonth()+1,C<<=5,C|=M.getUTCDate(),D&&(Q=e(1,1)+e(w(U),4)+R,N+="up"+e(Q.length,2)+Q),l&&(W=e(1,1)+e(w(V),4)+x,N+="uc"+e(W.length,2)+W);var G="";return G+=`
\0`,G+=e(z,2),G+=F.magic,G+=e(k,2),G+=e(C,2),G+=e(J.crc32,4),G+=e(J.compressedSize,4),G+=e(J.uncompressedSize,4),G+=e(U.length,2),G+=e(N.length,2),{fileRecord:m.LOCAL_FILE_HEADER+G+U+N,dirRecord:m.CENTRAL_FILE_HEADER+e(K,2)+G+e(V.length,2)+"\0\0\0\0"+e(I,4)+e(f,4)+U+N+V}}var i=t("../utils"),o=t("../stream/GenericWorker"),d=t("../utf8"),w=t("../crc32"),m=t("../signature");function v(u,g,h,f){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=h,this.encodeFileName=f,this.streamFiles=u,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}i.inherits(v,o),v.prototype.push=function(u){var g=u.meta.percent||0,h=this.entriesCount,f=this._sources.length;this.accumulate?this.contentBuffer.push(u):(this.bytesWritten+=u.data.length,o.prototype.push.call(this,{data:u.data,meta:{currentFile:this.currentFile,percent:h?(g+100*(h-f-1))/h:100}}))},v.prototype.openedSource=function(u){this.currentSourceOffset=this.bytesWritten,this.currentFile=u.file.name;var g=this.streamFiles&&!u.file.dir;if(g){var h=n(u,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:h.fileRecord,meta:{percent:0}})}else this.accumulate=!0},v.prototype.closedSource=function(u){this.accumulate=!1;var g=this.streamFiles&&!u.file.dir,h=n(u,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(h.dirRecord),g)this.push({data:(function(f){return m.DATA_DESCRIPTOR+e(f.crc32,4)+e(f.compressedSize,4)+e(f.uncompressedSize,4)})(u),meta:{percent:100}});else for(this.push({data:h.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},v.prototype.flush=function(){for(var u=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var h=this.bytesWritten-u,f=(function(p,b,k,C,E){var F=i.transformTo("string",E(C));return m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+e(p,2)+e(p,2)+e(b,4)+e(k,4)+e(F.length,2)+F})(this.dirRecords.length,h,u,this.zipComment,this.encodeFileName);this.push({data:f,meta:{percent:100}})},v.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},v.prototype.registerPrevious=function(u){this._sources.push(u);var g=this;return u.on("data",function(h){g.processChunk(h)}),u.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),u.on("error",function(h){g.error(h)}),this},v.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},v.prototype.error=function(u){var g=this._sources;if(!o.prototype.error.call(this,u))return!1;for(var h=0;h<g.length;h++)try{g[h].error(u)}catch{}return!0},v.prototype.lock=function(){o.prototype.lock.call(this);for(var u=this._sources,g=0;g<u.length;g++)u[g].lock()},c.exports=v},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,c,a){var e=t("../compressions"),n=t("./ZipFileWorker");a.generateWorker=function(i,o,d){var w=new n(o.streamFiles,d,o.platform,o.encodeFileName),m=0;try{i.forEach(function(v,u){m++;var g=(function(b,k){var C=b||k,E=e[C];if(!E)throw new Error(C+" is not a valid compression method !");return E})(u.options.compression,o.compression),h=u.options.compressionOptions||o.compressionOptions||{},f=u.dir,p=u.date;u._compressWorker(g,h).withStreamInfo("file",{name:v,dir:f,date:p,comment:u.comment||"",unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions}).pipe(w)}),w.entriesCount=m}catch(v){w.error(v)}return w}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,c,a){function e(){if(!(this instanceof e))return new e;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var n=new e;for(var i in this)typeof this[i]!="function"&&(n[i]=this[i]);return n}}(e.prototype=t("./object")).loadAsync=t("./load"),e.support=t("./support"),e.defaults=t("./defaults"),e.version="3.10.1",e.loadAsync=function(n,i){return new e().loadAsync(n,i)},e.external=t("./external"),c.exports=e},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,c,a){var e=t("./utils"),n=t("./external"),i=t("./utf8"),o=t("./zipEntries"),d=t("./stream/Crc32Probe"),w=t("./nodejsUtils");function m(v){return new n.Promise(function(u,g){var h=v.decompressed.getContentWorker().pipe(new d);h.on("error",function(f){g(f)}).on("end",function(){h.streamInfo.crc32!==v.decompressed.crc32?g(new Error("Corrupted zip : CRC32 mismatch")):u()}).resume()})}c.exports=function(v,u){var g=this;return u=e.extend(u||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:i.utf8decode}),w.isNode&&w.isStream(v)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):e.prepareContent("the loaded zip file",v,!0,u.optimizedBinaryString,u.base64).then(function(h){var f=new o(u);return f.load(h),f}).then(function(h){var f=[n.Promise.resolve(h)],p=h.files;if(u.checkCRC32)for(var b=0;b<p.length;b++)f.push(m(p[b]));return n.Promise.all(f)}).then(function(h){for(var f=h.shift(),p=f.files,b=0;b<p.length;b++){var k=p[b],C=k.fileNameStr,E=e.resolve(k.fileNameStr);g.file(E,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:u.createFolders}),k.dir||(g.file(E).unsafeOriginalName=C)}return f.zipComment.length&&(g.comment=f.zipComment),g})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,c,a){var e=t("../utils"),n=t("../stream/GenericWorker");function i(o,d){n.call(this,"Nodejs stream input adapter for "+o),this._upstreamEnded=!1,this._bindStream(d)}e.inherits(i,n),i.prototype._bindStream=function(o){var d=this;(this._stream=o).pause(),o.on("data",function(w){d.push({data:w,meta:{percent:0}})}).on("error",function(w){d.isPaused?this.generatedError=w:d.error(w)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},i.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},i.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},c.exports=i},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,c,a){var e=t("readable-stream").Readable;function n(i,o,d){e.call(this,o),this._helper=i;var w=this;i.on("data",function(m,v){w.push(m)||w._helper.pause(),d&&d(v)}).on("error",function(m){w.emit("error",m)}).on("end",function(){w.push(null)})}t("../utils").inherits(n,e),n.prototype._read=function(){this._helper.resume()},c.exports=n},{"../utils":32,"readable-stream":16}],14:[function(t,c,a){c.exports={isNode:typeof Buffer<"u",newBufferFrom:function(e,n){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,n);if(typeof e=="number")throw new Error('The "data" argument must not be a number');return new Buffer(e,n)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var n=new Buffer(e);return n.fill(0),n},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&typeof e.on=="function"&&typeof e.pause=="function"&&typeof e.resume=="function"}}},{}],15:[function(t,c,a){function e(E,F,B){var U,R=i.getTypeOf(F),Z=i.extend(B||{},w);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(E=p(E)),Z.createFolders&&(U=f(E))&&b.call(this,U,!0);var V=R==="string"&&Z.binary===!1&&Z.base64===!1;B&&B.binary!==void 0||(Z.binary=!V),(F instanceof m&&F.uncompressedSize===0||Z.dir||!F||F.length===0)&&(Z.base64=!1,Z.binary=!0,F="",Z.compression="STORE",R="string");var x=null;x=F instanceof m||F instanceof o?F:g.isNode&&g.isStream(F)?new h(E,F):i.prepareContent(E,F,Z.binary,Z.optimizedBinaryString,Z.base64);var D=new v(E,x,Z);this.files[E]=D}var n=t("./utf8"),i=t("./utils"),o=t("./stream/GenericWorker"),d=t("./stream/StreamHelper"),w=t("./defaults"),m=t("./compressedObject"),v=t("./zipObject"),u=t("./generate"),g=t("./nodejsUtils"),h=t("./nodejs/NodejsStreamInputAdapter"),f=function(E){E.slice(-1)==="/"&&(E=E.substring(0,E.length-1));var F=E.lastIndexOf("/");return 0<F?E.substring(0,F):""},p=function(E){return E.slice(-1)!=="/"&&(E+="/"),E},b=function(E,F){return F=F!==void 0?F:w.createFolders,E=p(E),this.files[E]||e.call(this,E,null,{dir:!0,createFolders:F}),this.files[E]};function k(E){return Object.prototype.toString.call(E)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(E){var F,B,U;for(F in this.files)U=this.files[F],(B=F.slice(this.root.length,F.length))&&F.slice(0,this.root.length)===this.root&&E(B,U)},filter:function(E){var F=[];return this.forEach(function(B,U){E(B,U)&&F.push(U)}),F},file:function(E,F,B){if(arguments.length!==1)return E=this.root+E,e.call(this,E,F,B),this;if(k(E)){var U=E;return this.filter(function(Z,V){return!V.dir&&U.test(Z)})}var R=this.files[this.root+E];return R&&!R.dir?R:null},folder:function(E){if(!E)return this;if(k(E))return this.filter(function(R,Z){return Z.dir&&E.test(R)});var F=this.root+E,B=b.call(this,F),U=this.clone();return U.root=B.name,U},remove:function(E){E=this.root+E;var F=this.files[E];if(F||(E.slice(-1)!=="/"&&(E+="/"),F=this.files[E]),F&&!F.dir)delete this.files[E];else for(var B=this.filter(function(R,Z){return Z.name.slice(0,E.length)===E}),U=0;U<B.length;U++)delete this.files[B[U].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(E){var F,B={};try{if((B=i.extend(E||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=B.type.toLowerCase(),B.compression=B.compression.toUpperCase(),B.type==="binarystring"&&(B.type="string"),!B.type)throw new Error("No output type specified.");i.checkSupport(B.type),B.platform!=="darwin"&&B.platform!=="freebsd"&&B.platform!=="linux"&&B.platform!=="sunos"||(B.platform="UNIX"),B.platform==="win32"&&(B.platform="DOS");var U=B.comment||this.comment||"";F=u.generateWorker(this,B,U)}catch(R){(F=new o("error")).error(R)}return new d(F,B.type||"string",B.mimeType)},generateAsync:function(E,F){return this.generateInternalStream(E).accumulate(F)},generateNodeStream:function(E,F){return(E=E||{}).type||(E.type="nodebuffer"),this.generateInternalStream(E).toNodejsStream(F)}};c.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,c,a){c.exports=t("stream")},{stream:void 0}],17:[function(t,c,a){var e=t("./DataReader");function n(i){e.call(this,i);for(var o=0;o<this.data.length;o++)i[o]=255&i[o]}t("../utils").inherits(n,e),n.prototype.byteAt=function(i){return this.data[this.zero+i]},n.prototype.lastIndexOfSignature=function(i){for(var o=i.charCodeAt(0),d=i.charCodeAt(1),w=i.charCodeAt(2),m=i.charCodeAt(3),v=this.length-4;0<=v;--v)if(this.data[v]===o&&this.data[v+1]===d&&this.data[v+2]===w&&this.data[v+3]===m)return v-this.zero;return-1},n.prototype.readAndCheckSignature=function(i){var o=i.charCodeAt(0),d=i.charCodeAt(1),w=i.charCodeAt(2),m=i.charCodeAt(3),v=this.readData(4);return o===v[0]&&d===v[1]&&w===v[2]&&m===v[3]},n.prototype.readData=function(i){if(this.checkOffset(i),i===0)return[];var o=this.data.slice(this.zero+this.index,this.zero+this.index+i);return this.index+=i,o},c.exports=n},{"../utils":32,"./DataReader":18}],18:[function(t,c,a){var e=t("../utils");function n(i){this.data=i,this.length=i.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(i){this.checkIndex(this.index+i)},checkIndex:function(i){if(this.length<this.zero+i||i<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+i+"). Corrupted zip ?")},setIndex:function(i){this.checkIndex(i),this.index=i},skip:function(i){this.setIndex(this.index+i)},byteAt:function(){},readInt:function(i){var o,d=0;for(this.checkOffset(i),o=this.index+i-1;o>=this.index;o--)d=(d<<8)+this.byteAt(o);return this.index+=i,d},readString:function(i){return e.transformTo("string",this.readData(i))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var i=this.readInt(4);return new Date(Date.UTC(1980+(i>>25&127),(i>>21&15)-1,i>>16&31,i>>11&31,i>>5&63,(31&i)<<1))}},c.exports=n},{"../utils":32}],19:[function(t,c,a){var e=t("./Uint8ArrayReader");function n(i){e.call(this,i)}t("../utils").inherits(n,e),n.prototype.readData=function(i){this.checkOffset(i);var o=this.data.slice(this.zero+this.index,this.zero+this.index+i);return this.index+=i,o},c.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,c,a){var e=t("./DataReader");function n(i){e.call(this,i)}t("../utils").inherits(n,e),n.prototype.byteAt=function(i){return this.data.charCodeAt(this.zero+i)},n.prototype.lastIndexOfSignature=function(i){return this.data.lastIndexOf(i)-this.zero},n.prototype.readAndCheckSignature=function(i){return i===this.readData(4)},n.prototype.readData=function(i){this.checkOffset(i);var o=this.data.slice(this.zero+this.index,this.zero+this.index+i);return this.index+=i,o},c.exports=n},{"../utils":32,"./DataReader":18}],21:[function(t,c,a){var e=t("./ArrayReader");function n(i){e.call(this,i)}t("../utils").inherits(n,e),n.prototype.readData=function(i){if(this.checkOffset(i),i===0)return new Uint8Array(0);var o=this.data.subarray(this.zero+this.index,this.zero+this.index+i);return this.index+=i,o},c.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(t,c,a){var e=t("../utils"),n=t("../support"),i=t("./ArrayReader"),o=t("./StringReader"),d=t("./NodeBufferReader"),w=t("./Uint8ArrayReader");c.exports=function(m){var v=e.getTypeOf(m);return e.checkSupport(v),v!=="string"||n.uint8array?v==="nodebuffer"?new d(m):n.uint8array?new w(e.transformTo("uint8array",m)):new i(e.transformTo("array",m)):new o(m)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,c,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,c,a){var e=t("./GenericWorker"),n=t("../utils");function i(o){e.call(this,"ConvertWorker to "+o),this.destType=o}n.inherits(i,e),i.prototype.processChunk=function(o){this.push({data:n.transformTo(this.destType,o.data),meta:o.meta})},c.exports=i},{"../utils":32,"./GenericWorker":28}],25:[function(t,c,a){var e=t("./GenericWorker"),n=t("../crc32");function i(){e.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(i,e),i.prototype.processChunk=function(o){this.streamInfo.crc32=n(o.data,this.streamInfo.crc32||0),this.push(o)},c.exports=i},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,c,a){var e=t("../utils"),n=t("./GenericWorker");function i(o){n.call(this,"DataLengthProbe for "+o),this.propName=o,this.withStreamInfo(o,0)}e.inherits(i,n),i.prototype.processChunk=function(o){if(o){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+o.data.length}n.prototype.processChunk.call(this,o)},c.exports=i},{"../utils":32,"./GenericWorker":28}],27:[function(t,c,a){var e=t("../utils"),n=t("./GenericWorker");function i(o){n.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,o.then(function(w){d.dataIsReady=!0,d.data=w,d.max=w&&w.length||0,d.type=e.getTypeOf(w),d.isPaused||d._tickAndRepeat()},function(w){d.error(w)})}e.inherits(i,n),i.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},i.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,e.delay(this._tickAndRepeat,[],this)),!0)},i.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(e.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},i.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var o=null,d=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":o=this.data.substring(this.index,d);break;case"uint8array":o=this.data.subarray(this.index,d);break;case"array":case"nodebuffer":o=this.data.slice(this.index,d)}return this.index=d,this.push({data:o,meta:{percent:this.max?this.index/this.max*100:0}})},c.exports=i},{"../utils":32,"./GenericWorker":28}],28:[function(t,c,a){function e(n){this.name=n||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}e.prototype={push:function(n){this.emit("data",n)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(n){this.emit("error",n)}return!0},error:function(n){return!this.isFinished&&(this.isPaused?this.generatedError=n:(this.isFinished=!0,this.emit("error",n),this.previous&&this.previous.error(n),this.cleanUp()),!0)},on:function(n,i){return this._listeners[n].push(i),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(n,i){if(this._listeners[n])for(var o=0;o<this._listeners[n].length;o++)this._listeners[n][o].call(this,i)},pipe:function(n){return n.registerPrevious(this)},registerPrevious:function(n){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=n.streamInfo,this.mergeStreamInfo(),this.previous=n;var i=this;return n.on("data",function(o){i.processChunk(o)}),n.on("end",function(){i.end()}),n.on("error",function(o){i.error(o)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var n=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),n=!0),this.previous&&this.previous.resume(),!n},flush:function(){},processChunk:function(n){this.push(n)},withStreamInfo:function(n,i){return this.extraStreamInfo[n]=i,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var n in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,n)&&(this.streamInfo[n]=this.extraStreamInfo[n])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var n="Worker "+this.name;return this.previous?this.previous+" -> "+n:n}},c.exports=e},{}],29:[function(t,c,a){var e=t("../utils"),n=t("./ConvertWorker"),i=t("./GenericWorker"),o=t("../base64"),d=t("../support"),w=t("../external"),m=null;if(d.nodestream)try{m=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function v(g,h){return new w.Promise(function(f,p){var b=[],k=g._internalType,C=g._outputType,E=g._mimeType;g.on("data",function(F,B){b.push(F),h&&h(B)}).on("error",function(F){b=[],p(F)}).on("end",function(){try{var F=(function(B,U,R){switch(B){case"blob":return e.newBlob(e.transformTo("arraybuffer",U),R);case"base64":return o.encode(U);default:return e.transformTo(B,U)}})(C,(function(B,U){var R,Z=0,V=null,x=0;for(R=0;R<U.length;R++)x+=U[R].length;switch(B){case"string":return U.join("");case"array":return Array.prototype.concat.apply([],U);case"uint8array":for(V=new Uint8Array(x),R=0;R<U.length;R++)V.set(U[R],Z),Z+=U[R].length;return V;case"nodebuffer":return Buffer.concat(U);default:throw new Error("concat : unsupported type '"+B+"'")}})(k,b),E);f(F)}catch(B){p(B)}b=[]}).resume()})}function u(g,h,f){var p=h;switch(h){case"blob":case"arraybuffer":p="uint8array";break;case"base64":p="string"}try{this._internalType=p,this._outputType=h,this._mimeType=f,e.checkSupport(p),this._worker=g.pipe(new n(p)),g.lock()}catch(b){this._worker=new i("error"),this._worker.error(b)}}u.prototype={accumulate:function(g){return v(this,g)},on:function(g,h){var f=this;return g==="data"?this._worker.on(g,function(p){h.call(f,p.data,p.meta)}):this._worker.on(g,function(){e.delay(h,arguments,f)}),this},resume:function(){return e.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(e.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},g)}},c.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,c,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var e=new ArrayBuffer(0);try{a.blob=new Blob([e],{type:"application/zip"}).size===0}catch{try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(e),a.blob=n.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!t("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(t,c,a){for(var e=t("./utils"),n=t("./support"),i=t("./nodejsUtils"),o=t("./stream/GenericWorker"),d=new Array(256),w=0;w<256;w++)d[w]=252<=w?6:248<=w?5:240<=w?4:224<=w?3:192<=w?2:1;d[254]=d[254]=1;function m(){o.call(this,"utf-8 decode"),this.leftOver=null}function v(){o.call(this,"utf-8 encode")}a.utf8encode=function(u){return n.nodebuffer?i.newBufferFrom(u,"utf-8"):(function(g){var h,f,p,b,k,C=g.length,E=0;for(b=0;b<C;b++)(64512&(f=g.charCodeAt(b)))==55296&&b+1<C&&(64512&(p=g.charCodeAt(b+1)))==56320&&(f=65536+(f-55296<<10)+(p-56320),b++),E+=f<128?1:f<2048?2:f<65536?3:4;for(h=n.uint8array?new Uint8Array(E):new Array(E),b=k=0;k<E;b++)(64512&(f=g.charCodeAt(b)))==55296&&b+1<C&&(64512&(p=g.charCodeAt(b+1)))==56320&&(f=65536+(f-55296<<10)+(p-56320),b++),f<128?h[k++]=f:(f<2048?h[k++]=192|f>>>6:(f<65536?h[k++]=224|f>>>12:(h[k++]=240|f>>>18,h[k++]=128|f>>>12&63),h[k++]=128|f>>>6&63),h[k++]=128|63&f);return h})(u)},a.utf8decode=function(u){return n.nodebuffer?e.transformTo("nodebuffer",u).toString("utf-8"):(function(g){var h,f,p,b,k=g.length,C=new Array(2*k);for(h=f=0;h<k;)if((p=g[h++])<128)C[f++]=p;else if(4<(b=d[p]))C[f++]=65533,h+=b-1;else{for(p&=b===2?31:b===3?15:7;1<b&&h<k;)p=p<<6|63&g[h++],b--;1<b?C[f++]=65533:p<65536?C[f++]=p:(p-=65536,C[f++]=55296|p>>10&1023,C[f++]=56320|1023&p)}return C.length!==f&&(C.subarray?C=C.subarray(0,f):C.length=f),e.applyFromCharCode(C)})(u=e.transformTo(n.uint8array?"uint8array":"array",u))},e.inherits(m,o),m.prototype.processChunk=function(u){var g=e.transformTo(n.uint8array?"uint8array":"array",u.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var h=g;(g=new Uint8Array(h.length+this.leftOver.length)).set(this.leftOver,0),g.set(h,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var f=(function(b,k){var C;for((k=k||b.length)>b.length&&(k=b.length),C=k-1;0<=C&&(192&b[C])==128;)C--;return C<0||C===0?k:C+d[b[C]]>k?C:k})(g),p=g;f!==g.length&&(n.uint8array?(p=g.subarray(0,f),this.leftOver=g.subarray(f,g.length)):(p=g.slice(0,f),this.leftOver=g.slice(f,g.length))),this.push({data:a.utf8decode(p),meta:u.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=m,e.inherits(v,o),v.prototype.processChunk=function(u){this.push({data:a.utf8encode(u.data),meta:u.meta})},a.Utf8EncodeWorker=v},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,c,a){var e=t("./support"),n=t("./base64"),i=t("./nodejsUtils"),o=t("./external");function d(h){return h}function w(h,f){for(var p=0;p<h.length;++p)f[p]=255&h.charCodeAt(p);return f}t("setimmediate"),a.newBlob=function(h,f){a.checkSupport("blob");try{return new Blob([h],{type:f})}catch{try{var p=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return p.append(h),p.getBlob(f)}catch{throw new Error("Bug : can't construct the Blob.")}}};var m={stringifyByChunk:function(h,f,p){var b=[],k=0,C=h.length;if(C<=p)return String.fromCharCode.apply(null,h);for(;k<C;)f==="array"||f==="nodebuffer"?b.push(String.fromCharCode.apply(null,h.slice(k,Math.min(k+p,C)))):b.push(String.fromCharCode.apply(null,h.subarray(k,Math.min(k+p,C)))),k+=p;return b.join("")},stringifyByChar:function(h){for(var f="",p=0;p<h.length;p++)f+=String.fromCharCode(h[p]);return f},applyCanBeUsed:{uint8array:(function(){try{return e.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return e.nodebuffer&&String.fromCharCode.apply(null,i.allocBuffer(1)).length===1}catch{return!1}})()}};function v(h){var f=65536,p=a.getTypeOf(h),b=!0;if(p==="uint8array"?b=m.applyCanBeUsed.uint8array:p==="nodebuffer"&&(b=m.applyCanBeUsed.nodebuffer),b)for(;1<f;)try{return m.stringifyByChunk(h,p,f)}catch{f=Math.floor(f/2)}return m.stringifyByChar(h)}function u(h,f){for(var p=0;p<h.length;p++)f[p]=h[p];return f}a.applyFromCharCode=v;var g={};g.string={string:d,array:function(h){return w(h,new Array(h.length))},arraybuffer:function(h){return g.string.uint8array(h).buffer},uint8array:function(h){return w(h,new Uint8Array(h.length))},nodebuffer:function(h){return w(h,i.allocBuffer(h.length))}},g.array={string:v,array:d,arraybuffer:function(h){return new Uint8Array(h).buffer},uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return i.newBufferFrom(h)}},g.arraybuffer={string:function(h){return v(new Uint8Array(h))},array:function(h){return u(new Uint8Array(h),new Array(h.byteLength))},arraybuffer:d,uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return i.newBufferFrom(new Uint8Array(h))}},g.uint8array={string:v,array:function(h){return u(h,new Array(h.length))},arraybuffer:function(h){return h.buffer},uint8array:d,nodebuffer:function(h){return i.newBufferFrom(h)}},g.nodebuffer={string:v,array:function(h){return u(h,new Array(h.length))},arraybuffer:function(h){return g.nodebuffer.uint8array(h).buffer},uint8array:function(h){return u(h,new Uint8Array(h.length))},nodebuffer:d},a.transformTo=function(h,f){if(f=f||"",!h)return f;a.checkSupport(h);var p=a.getTypeOf(f);return g[p][h](f)},a.resolve=function(h){for(var f=h.split("/"),p=[],b=0;b<f.length;b++){var k=f[b];k==="."||k===""&&b!==0&&b!==f.length-1||(k===".."?p.pop():p.push(k))}return p.join("/")},a.getTypeOf=function(h){return typeof h=="string"?"string":Object.prototype.toString.call(h)==="[object Array]"?"array":e.nodebuffer&&i.isBuffer(h)?"nodebuffer":e.uint8array&&h instanceof Uint8Array?"uint8array":e.arraybuffer&&h instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(h){if(!e[h.toLowerCase()])throw new Error(h+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(h){var f,p,b="";for(p=0;p<(h||"").length;p++)b+="\\x"+((f=h.charCodeAt(p))<16?"0":"")+f.toString(16).toUpperCase();return b},a.delay=function(h,f,p){setImmediate(function(){h.apply(p||null,f||[])})},a.inherits=function(h,f){function p(){}p.prototype=f.prototype,h.prototype=new p},a.extend=function(){var h,f,p={};for(h=0;h<arguments.length;h++)for(f in arguments[h])Object.prototype.hasOwnProperty.call(arguments[h],f)&&p[f]===void 0&&(p[f]=arguments[h][f]);return p},a.prepareContent=function(h,f,p,b,k){return o.Promise.resolve(f).then(function(C){return e.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new o.Promise(function(E,F){var B=new FileReader;B.onload=function(U){E(U.target.result)},B.onerror=function(U){F(U.target.error)},B.readAsArrayBuffer(C)}):C}).then(function(C){var E=a.getTypeOf(C);return E?(E==="arraybuffer"?C=a.transformTo("uint8array",C):E==="string"&&(k?C=n.decode(C):p&&b!==!0&&(C=(function(F){return w(F,e.uint8array?new Uint8Array(F.length):new Array(F.length))})(C))),C):o.Promise.reject(new Error("Can't read the data of '"+h+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,c,a){var e=t("./reader/readerFor"),n=t("./utils"),i=t("./signature"),o=t("./zipEntry"),d=t("./support");function w(m){this.files=[],this.loadOptions=m}w.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var v=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(v)+", expected "+n.pretty(m)+")")}},isSignature:function(m,v){var u=this.reader.index;this.reader.setIndex(m);var g=this.reader.readString(4)===v;return this.reader.setIndex(u),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),v=d.uint8array?"uint8array":"array",u=n.transformTo(v,m);this.zipComment=this.loadOptions.decodeFileName(u)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m,v,u,g=this.zip64EndOfCentralSize-44;0<g;)m=this.reader.readInt(2),v=this.reader.readInt(4),u=this.reader.readData(v),this.zip64ExtensibleData[m]={id:m,length:v,value:u}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,v;for(m=0;m<this.files.length;m++)v=this.files[m],this.reader.setIndex(v.localHeaderOffset),this.checkSignature(i.LOCAL_FILE_HEADER),v.readLocalPart(this.reader),v.handleUTF8(),v.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(i.CENTRAL_FILE_HEADER);)(m=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(i.CENTRAL_DIRECTORY_END);if(m<0)throw this.isSignature(0,i.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(m);var v=m;if(this.checkSignature(i.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(m=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,i.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var u=this.centralDirOffset+this.centralDirSize;this.zip64&&(u+=20,u+=12+this.zip64EndOfCentralSize);var g=v-u;if(0<g)this.isSignature(v,i.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw new Error("Corrupted zip: missing "+Math.abs(g)+" bytes.")},prepareReader:function(m){this.reader=e(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},c.exports=w},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,c,a){var e=t("./reader/readerFor"),n=t("./utils"),i=t("./compressedObject"),o=t("./crc32"),d=t("./utf8"),w=t("./compressions"),m=t("./support");function v(u,g){this.options=u,this.loadOptions=g}v.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(u){var g,h;if(u.skip(22),this.fileNameLength=u.readInt(2),h=u.readInt(2),this.fileName=u.readData(this.fileNameLength),u.skip(h),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((g=(function(f){for(var p in w)if(Object.prototype.hasOwnProperty.call(w,p)&&w[p].magic===f)return w[p];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new i(this.compressedSize,this.uncompressedSize,this.crc32,g,u.readData(this.compressedSize))},readCentralPart:function(u){this.versionMadeBy=u.readInt(2),u.skip(2),this.bitFlag=u.readInt(2),this.compressionMethod=u.readString(2),this.date=u.readDate(),this.crc32=u.readInt(4),this.compressedSize=u.readInt(4),this.uncompressedSize=u.readInt(4);var g=u.readInt(2);if(this.extraFieldsLength=u.readInt(2),this.fileCommentLength=u.readInt(2),this.diskNumberStart=u.readInt(2),this.internalFileAttributes=u.readInt(2),this.externalFileAttributes=u.readInt(4),this.localHeaderOffset=u.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");u.skip(g),this.readExtraFields(u),this.parseZIP64ExtraField(u),this.fileComment=u.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var u=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),u==0&&(this.dosPermissions=63&this.externalFileAttributes),u==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var u=e(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=u.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=u.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=u.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=u.readInt(4))}},readExtraFields:function(u){var g,h,f,p=u.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});u.index+4<p;)g=u.readInt(2),h=u.readInt(2),f=u.readData(h),this.extraFields[g]={id:g,length:h,value:f};u.setIndex(p)},handleUTF8:function(){var u=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var h=n.transformTo(u,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(h)}var f=this.findExtraFieldUnicodeComment();if(f!==null)this.fileCommentStr=f;else{var p=n.transformTo(u,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(p)}}},findExtraFieldUnicodePath:function(){var u=this.extraFields[28789];if(u){var g=e(u.value);return g.readInt(1)!==1||o(this.fileName)!==g.readInt(4)?null:d.utf8decode(g.readData(u.length-5))}return null},findExtraFieldUnicodeComment:function(){var u=this.extraFields[25461];if(u){var g=e(u.value);return g.readInt(1)!==1||o(this.fileComment)!==g.readInt(4)?null:d.utf8decode(g.readData(u.length-5))}return null}},c.exports=v},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,c,a){function e(g,h,f){this.name=g,this.dir=f.dir,this.date=f.date,this.comment=f.comment,this.unixPermissions=f.unixPermissions,this.dosPermissions=f.dosPermissions,this._data=h,this._dataBinary=f.binary,this.options={compression:f.compression,compressionOptions:f.compressionOptions}}var n=t("./stream/StreamHelper"),i=t("./stream/DataWorker"),o=t("./utf8"),d=t("./compressedObject"),w=t("./stream/GenericWorker");e.prototype={internalStream:function(g){var h=null,f="string";try{if(!g)throw new Error("No output type specified.");var p=(f=g.toLowerCase())==="string"||f==="text";f!=="binarystring"&&f!=="text"||(f="string"),h=this._decompressWorker();var b=!this._dataBinary;b&&!p&&(h=h.pipe(new o.Utf8EncodeWorker)),!b&&p&&(h=h.pipe(new o.Utf8DecodeWorker))}catch(k){(h=new w("error")).error(k)}return new n(h,f,"")},async:function(g,h){return this.internalStream(g).accumulate(h)},nodeStream:function(g,h){return this.internalStream(g||"nodebuffer").toNodejsStream(h)},_compressWorker:function(g,h){if(this._data instanceof d&&this._data.compression.magic===g.magic)return this._data.getCompressedWorker();var f=this._decompressWorker();return this._dataBinary||(f=f.pipe(new o.Utf8EncodeWorker)),d.createWorkerFrom(f,g,h)},_decompressWorker:function(){return this._data instanceof d?this._data.getContentWorker():this._data instanceof w?this._data:new i(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],v=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<m.length;u++)e.prototype[m[u]]=v;c.exports=e},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,c,a){(function(e){var n,i,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var d=0,w=new o(g),m=e.document.createTextNode("");w.observe(m,{characterData:!0}),n=function(){m.data=d=++d%2}}else if(e.setImmediate||e.MessageChannel===void 0)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var h=e.document.createElement("script");h.onreadystatechange=function(){g(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},e.document.documentElement.appendChild(h)}:function(){setTimeout(g,0)};else{var v=new e.MessageChannel;v.port1.onmessage=g,n=function(){v.port2.postMessage(0)}}var u=[];function g(){var h,f;i=!0;for(var p=u.length;p;){for(f=u,u=[],h=-1;++h<p;)f[h]();p=u.length}i=!1}c.exports=function(h){u.push(h)!==1||i||n()}}).call(this,typeof Ct<"u"?Ct:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,c,a){var e=t("immediate");function n(){}var i={},o=["REJECTED"],d=["FULFILLED"],w=["PENDING"];function m(p){if(typeof p!="function")throw new TypeError("resolver must be a function");this.state=w,this.queue=[],this.outcome=void 0,p!==n&&h(this,p)}function v(p,b,k){this.promise=p,typeof b=="function"&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function u(p,b,k){e(function(){var C;try{C=b(k)}catch(E){return i.reject(p,E)}C===p?i.reject(p,new TypeError("Cannot resolve promise with itself")):i.resolve(p,C)})}function g(p){var b=p&&p.then;if(p&&(typeof p=="object"||typeof p=="function")&&typeof b=="function")return function(){b.apply(p,arguments)}}function h(p,b){var k=!1;function C(B){k||(k=!0,i.reject(p,B))}function E(B){k||(k=!0,i.resolve(p,B))}var F=f(function(){b(E,C)});F.status==="error"&&C(F.value)}function f(p,b){var k={};try{k.value=p(b),k.status="success"}catch(C){k.status="error",k.value=C}return k}(c.exports=m).prototype.finally=function(p){if(typeof p!="function")return this;var b=this.constructor;return this.then(function(k){return b.resolve(p()).then(function(){return k})},function(k){return b.resolve(p()).then(function(){throw k})})},m.prototype.catch=function(p){return this.then(null,p)},m.prototype.then=function(p,b){if(typeof p!="function"&&this.state===d||typeof b!="function"&&this.state===o)return this;var k=new this.constructor(n);return this.state!==w?u(k,this.state===d?p:b,this.outcome):this.queue.push(new v(k,p,b)),k},v.prototype.callFulfilled=function(p){i.resolve(this.promise,p)},v.prototype.otherCallFulfilled=function(p){u(this.promise,this.onFulfilled,p)},v.prototype.callRejected=function(p){i.reject(this.promise,p)},v.prototype.otherCallRejected=function(p){u(this.promise,this.onRejected,p)},i.resolve=function(p,b){var k=f(g,b);if(k.status==="error")return i.reject(p,k.value);var C=k.value;if(C)h(p,C);else{p.state=d,p.outcome=b;for(var E=-1,F=p.queue.length;++E<F;)p.queue[E].callFulfilled(b)}return p},i.reject=function(p,b){p.state=o,p.outcome=b;for(var k=-1,C=p.queue.length;++k<C;)p.queue[k].callRejected(b);return p},m.resolve=function(p){return p instanceof this?p:i.resolve(new this(n),p)},m.reject=function(p){var b=new this(n);return i.reject(b,p)},m.all=function(p){var b=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=p.length,C=!1;if(!k)return this.resolve([]);for(var E=new Array(k),F=0,B=-1,U=new this(n);++B<k;)R(p[B],B);return U;function R(Z,V){b.resolve(Z).then(function(x){E[V]=x,++F!==k||C||(C=!0,i.resolve(U,E))},function(x){C||(C=!0,i.reject(U,x))})}},m.race=function(p){var b=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=p.length,C=!1;if(!k)return this.resolve([]);for(var E=-1,F=new this(n);++E<k;)B=p[E],b.resolve(B).then(function(U){C||(C=!0,i.resolve(F,U))},function(U){C||(C=!0,i.reject(F,U))});var B;return F}},{immediate:36}],38:[function(t,c,a){var e={};(0,t("./lib/utils/common").assign)(e,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),c.exports=e},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,c,a){var e=t("./zlib/deflate"),n=t("./utils/common"),i=t("./utils/strings"),o=t("./zlib/messages"),d=t("./zlib/zstream"),w=Object.prototype.toString,m=0,v=-1,u=0,g=8;function h(p){if(!(this instanceof h))return new h(p);this.options=n.assign({level:v,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},p||{});var b=this.options;b.raw&&0<b.windowBits?b.windowBits=-b.windowBits:b.gzip&&0<b.windowBits&&b.windowBits<16&&(b.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var k=e.deflateInit2(this.strm,b.level,b.method,b.windowBits,b.memLevel,b.strategy);if(k!==m)throw new Error(o[k]);if(b.header&&e.deflateSetHeader(this.strm,b.header),b.dictionary){var C;if(C=typeof b.dictionary=="string"?i.string2buf(b.dictionary):w.call(b.dictionary)==="[object ArrayBuffer]"?new Uint8Array(b.dictionary):b.dictionary,(k=e.deflateSetDictionary(this.strm,C))!==m)throw new Error(o[k]);this._dict_set=!0}}function f(p,b){var k=new h(b);if(k.push(p,!0),k.err)throw k.msg||o[k.err];return k.result}h.prototype.push=function(p,b){var k,C,E=this.strm,F=this.options.chunkSize;if(this.ended)return!1;C=b===~~b?b:b===!0?4:0,typeof p=="string"?E.input=i.string2buf(p):w.call(p)==="[object ArrayBuffer]"?E.input=new Uint8Array(p):E.input=p,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new n.Buf8(F),E.next_out=0,E.avail_out=F),(k=e.deflate(E,C))!==1&&k!==m)return this.onEnd(k),!(this.ended=!0);E.avail_out!==0&&(E.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(i.buf2binstring(n.shrinkBuf(E.output,E.next_out))):this.onData(n.shrinkBuf(E.output,E.next_out)))}while((0<E.avail_in||E.avail_out===0)&&k!==1);return C===4?(k=e.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===m):C!==2||(this.onEnd(m),!(E.avail_out=0))},h.prototype.onData=function(p){this.chunks.push(p)},h.prototype.onEnd=function(p){p===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},a.Deflate=h,a.deflate=f,a.deflateRaw=function(p,b){return(b=b||{}).raw=!0,f(p,b)},a.gzip=function(p,b){return(b=b||{}).gzip=!0,f(p,b)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,c,a){var e=t("./zlib/inflate"),n=t("./utils/common"),i=t("./utils/strings"),o=t("./zlib/constants"),d=t("./zlib/messages"),w=t("./zlib/zstream"),m=t("./zlib/gzheader"),v=Object.prototype.toString;function u(h){if(!(this instanceof u))return new u(h);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},h||{});var f=this.options;f.raw&&0<=f.windowBits&&f.windowBits<16&&(f.windowBits=-f.windowBits,f.windowBits===0&&(f.windowBits=-15)),!(0<=f.windowBits&&f.windowBits<16)||h&&h.windowBits||(f.windowBits+=32),15<f.windowBits&&f.windowBits<48&&(15&f.windowBits)==0&&(f.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new w,this.strm.avail_out=0;var p=e.inflateInit2(this.strm,f.windowBits);if(p!==o.Z_OK)throw new Error(d[p]);this.header=new m,e.inflateGetHeader(this.strm,this.header)}function g(h,f){var p=new u(f);if(p.push(h,!0),p.err)throw p.msg||d[p.err];return p.result}u.prototype.push=function(h,f){var p,b,k,C,E,F,B=this.strm,U=this.options.chunkSize,R=this.options.dictionary,Z=!1;if(this.ended)return!1;b=f===~~f?f:f===!0?o.Z_FINISH:o.Z_NO_FLUSH,typeof h=="string"?B.input=i.binstring2buf(h):v.call(h)==="[object ArrayBuffer]"?B.input=new Uint8Array(h):B.input=h,B.next_in=0,B.avail_in=B.input.length;do{if(B.avail_out===0&&(B.output=new n.Buf8(U),B.next_out=0,B.avail_out=U),(p=e.inflate(B,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&R&&(F=typeof R=="string"?i.string2buf(R):v.call(R)==="[object ArrayBuffer]"?new Uint8Array(R):R,p=e.inflateSetDictionary(this.strm,F)),p===o.Z_BUF_ERROR&&Z===!0&&(p=o.Z_OK,Z=!1),p!==o.Z_STREAM_END&&p!==o.Z_OK)return this.onEnd(p),!(this.ended=!0);B.next_out&&(B.avail_out!==0&&p!==o.Z_STREAM_END&&(B.avail_in!==0||b!==o.Z_FINISH&&b!==o.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=i.utf8border(B.output,B.next_out),C=B.next_out-k,E=i.buf2string(B.output,k),B.next_out=C,B.avail_out=U-C,C&&n.arraySet(B.output,B.output,k,C,0),this.onData(E)):this.onData(n.shrinkBuf(B.output,B.next_out)))),B.avail_in===0&&B.avail_out===0&&(Z=!0)}while((0<B.avail_in||B.avail_out===0)&&p!==o.Z_STREAM_END);return p===o.Z_STREAM_END&&(b=o.Z_FINISH),b===o.Z_FINISH?(p=e.inflateEnd(this.strm),this.onEnd(p),this.ended=!0,p===o.Z_OK):b!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(B.avail_out=0))},u.prototype.onData=function(h){this.chunks.push(h)},u.prototype.onEnd=function(h){h===o.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg},a.Inflate=u,a.inflate=g,a.inflateRaw=function(h,f){return(f=f||{}).raw=!0,g(h,f)},a.ungzip=g},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,c,a){var e=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(o){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var w=d.shift();if(w){if(typeof w!="object")throw new TypeError(w+"must be non-object");for(var m in w)w.hasOwnProperty(m)&&(o[m]=w[m])}}return o},a.shrinkBuf=function(o,d){return o.length===d?o:o.subarray?o.subarray(0,d):(o.length=d,o)};var n={arraySet:function(o,d,w,m,v){if(d.subarray&&o.subarray)o.set(d.subarray(w,w+m),v);else for(var u=0;u<m;u++)o[v+u]=d[w+u]},flattenChunks:function(o){var d,w,m,v,u,g;for(d=m=0,w=o.length;d<w;d++)m+=o[d].length;for(g=new Uint8Array(m),d=v=0,w=o.length;d<w;d++)u=o[d],g.set(u,v),v+=u.length;return g}},i={arraySet:function(o,d,w,m,v){for(var u=0;u<m;u++)o[v+u]=d[w+u]},flattenChunks:function(o){return[].concat.apply([],o)}};a.setTyped=function(o){o?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,n)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,i))},a.setTyped(e)},{}],42:[function(t,c,a){var e=t("./common"),n=!0,i=!0;try{String.fromCharCode.apply(null,[0])}catch{n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{i=!1}for(var o=new e.Buf8(256),d=0;d<256;d++)o[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;function w(m,v){if(v<65537&&(m.subarray&&i||!m.subarray&&n))return String.fromCharCode.apply(null,e.shrinkBuf(m,v));for(var u="",g=0;g<v;g++)u+=String.fromCharCode(m[g]);return u}o[254]=o[254]=1,a.string2buf=function(m){var v,u,g,h,f,p=m.length,b=0;for(h=0;h<p;h++)(64512&(u=m.charCodeAt(h)))==55296&&h+1<p&&(64512&(g=m.charCodeAt(h+1)))==56320&&(u=65536+(u-55296<<10)+(g-56320),h++),b+=u<128?1:u<2048?2:u<65536?3:4;for(v=new e.Buf8(b),h=f=0;f<b;h++)(64512&(u=m.charCodeAt(h)))==55296&&h+1<p&&(64512&(g=m.charCodeAt(h+1)))==56320&&(u=65536+(u-55296<<10)+(g-56320),h++),u<128?v[f++]=u:(u<2048?v[f++]=192|u>>>6:(u<65536?v[f++]=224|u>>>12:(v[f++]=240|u>>>18,v[f++]=128|u>>>12&63),v[f++]=128|u>>>6&63),v[f++]=128|63&u);return v},a.buf2binstring=function(m){return w(m,m.length)},a.binstring2buf=function(m){for(var v=new e.Buf8(m.length),u=0,g=v.length;u<g;u++)v[u]=m.charCodeAt(u);return v},a.buf2string=function(m,v){var u,g,h,f,p=v||m.length,b=new Array(2*p);for(u=g=0;u<p;)if((h=m[u++])<128)b[g++]=h;else if(4<(f=o[h]))b[g++]=65533,u+=f-1;else{for(h&=f===2?31:f===3?15:7;1<f&&u<p;)h=h<<6|63&m[u++],f--;1<f?b[g++]=65533:h<65536?b[g++]=h:(h-=65536,b[g++]=55296|h>>10&1023,b[g++]=56320|1023&h)}return w(b,g)},a.utf8border=function(m,v){var u;for((v=v||m.length)>m.length&&(v=m.length),u=v-1;0<=u&&(192&m[u])==128;)u--;return u<0||u===0?v:u+o[m[u]]>v?u:v}},{"./common":41}],43:[function(t,c,a){c.exports=function(e,n,i,o){for(var d=65535&e|0,w=e>>>16&65535|0,m=0;i!==0;){for(i-=m=2e3<i?2e3:i;w=w+(d=d+n[o++]|0)|0,--m;);d%=65521,w%=65521}return d|w<<16|0}},{}],44:[function(t,c,a){c.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,c,a){var e=(function(){for(var n,i=[],o=0;o<256;o++){n=o;for(var d=0;d<8;d++)n=1&n?3988292384^n>>>1:n>>>1;i[o]=n}return i})();c.exports=function(n,i,o,d){var w=e,m=d+o;n^=-1;for(var v=d;v<m;v++)n=n>>>8^w[255&(n^i[v])];return-1^n}},{}],46:[function(t,c,a){var e,n=t("../utils/common"),i=t("./trees"),o=t("./adler32"),d=t("./crc32"),w=t("./messages"),m=0,v=4,u=0,g=-2,h=-1,f=4,p=2,b=8,k=9,C=286,E=30,F=19,B=2*C+1,U=15,R=3,Z=258,V=Z+R+1,x=42,D=113,l=1,N=2,Q=3,W=4;function et(s,O){return s.msg=w[O],O}function M(s){return(s<<1)-(4<s?9:0)}function J(s){for(var O=s.length;0<=--O;)s[O]=0}function z(s){var O=s.state,A=O.pending;A>s.avail_out&&(A=s.avail_out),A!==0&&(n.arraySet(s.output,O.pending_buf,O.pending_out,A,s.next_out),s.next_out+=A,O.pending_out+=A,s.total_out+=A,s.avail_out-=A,O.pending-=A,O.pending===0&&(O.pending_out=0))}function I(s,O){i._tr_flush_block(s,0<=s.block_start?s.block_start:-1,s.strstart-s.block_start,O),s.block_start=s.strstart,z(s.strm)}function K(s,O){s.pending_buf[s.pending++]=O}function G(s,O){s.pending_buf[s.pending++]=O>>>8&255,s.pending_buf[s.pending++]=255&O}function H(s,O){var A,_,y=s.max_chain_length,T=s.strstart,P=s.prev_length,L=s.nice_match,S=s.strstart>s.w_size-V?s.strstart-(s.w_size-V):0,$=s.window,q=s.w_mask,X=s.prev,Y=s.strstart+Z,at=$[T+P-1],rt=$[T+P];s.prev_length>=s.good_match&&(y>>=2),L>s.lookahead&&(L=s.lookahead);do if($[(A=O)+P]===rt&&$[A+P-1]===at&&$[A]===$[T]&&$[++A]===$[T+1]){T+=2,A++;do;while($[++T]===$[++A]&&$[++T]===$[++A]&&$[++T]===$[++A]&&$[++T]===$[++A]&&$[++T]===$[++A]&&$[++T]===$[++A]&&$[++T]===$[++A]&&$[++T]===$[++A]&&T<Y);if(_=Z-(Y-T),T=Y-Z,P<_){if(s.match_start=O,L<=(P=_))break;at=$[T+P-1],rt=$[T+P]}}while((O=X[O&q])>S&&--y!=0);return P<=s.lookahead?P:s.lookahead}function ot(s){var O,A,_,y,T,P,L,S,$,q,X=s.w_size;do{if(y=s.window_size-s.lookahead-s.strstart,s.strstart>=X+(X-V)){for(n.arraySet(s.window,s.window,X,X,0),s.match_start-=X,s.strstart-=X,s.block_start-=X,O=A=s.hash_size;_=s.head[--O],s.head[O]=X<=_?_-X:0,--A;);for(O=A=X;_=s.prev[--O],s.prev[O]=X<=_?_-X:0,--A;);y+=X}if(s.strm.avail_in===0)break;if(P=s.strm,L=s.window,S=s.strstart+s.lookahead,$=y,q=void 0,q=P.avail_in,$<q&&(q=$),A=q===0?0:(P.avail_in-=q,n.arraySet(L,P.input,P.next_in,q,S),P.state.wrap===1?P.adler=o(P.adler,L,q,S):P.state.wrap===2&&(P.adler=d(P.adler,L,q,S)),P.next_in+=q,P.total_in+=q,q),s.lookahead+=A,s.lookahead+s.insert>=R)for(T=s.strstart-s.insert,s.ins_h=s.window[T],s.ins_h=(s.ins_h<<s.hash_shift^s.window[T+1])&s.hash_mask;s.insert&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[T+R-1])&s.hash_mask,s.prev[T&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=T,T++,s.insert--,!(s.lookahead+s.insert<R)););}while(s.lookahead<V&&s.strm.avail_in!==0)}function ht(s,O){for(var A,_;;){if(s.lookahead<V){if(ot(s),s.lookahead<V&&O===m)return l;if(s.lookahead===0)break}if(A=0,s.lookahead>=R&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+R-1])&s.hash_mask,A=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),A!==0&&s.strstart-A<=s.w_size-V&&(s.match_length=H(s,A)),s.match_length>=R)if(_=i._tr_tally(s,s.strstart-s.match_start,s.match_length-R),s.lookahead-=s.match_length,s.match_length<=s.max_lazy_match&&s.lookahead>=R){for(s.match_length--;s.strstart++,s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+R-1])&s.hash_mask,A=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart,--s.match_length!=0;);s.strstart++}else s.strstart+=s.match_length,s.match_length=0,s.ins_h=s.window[s.strstart],s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+1])&s.hash_mask;else _=i._tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++;if(_&&(I(s,!1),s.strm.avail_out===0))return l}return s.insert=s.strstart<R-1?s.strstart:R-1,O===v?(I(s,!0),s.strm.avail_out===0?Q:W):s.last_lit&&(I(s,!1),s.strm.avail_out===0)?l:N}function nt(s,O){for(var A,_,y;;){if(s.lookahead<V){if(ot(s),s.lookahead<V&&O===m)return l;if(s.lookahead===0)break}if(A=0,s.lookahead>=R&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+R-1])&s.hash_mask,A=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),s.prev_length=s.match_length,s.prev_match=s.match_start,s.match_length=R-1,A!==0&&s.prev_length<s.max_lazy_match&&s.strstart-A<=s.w_size-V&&(s.match_length=H(s,A),s.match_length<=5&&(s.strategy===1||s.match_length===R&&4096<s.strstart-s.match_start)&&(s.match_length=R-1)),s.prev_length>=R&&s.match_length<=s.prev_length){for(y=s.strstart+s.lookahead-R,_=i._tr_tally(s,s.strstart-1-s.prev_match,s.prev_length-R),s.lookahead-=s.prev_length-1,s.prev_length-=2;++s.strstart<=y&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+R-1])&s.hash_mask,A=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),--s.prev_length!=0;);if(s.match_available=0,s.match_length=R-1,s.strstart++,_&&(I(s,!1),s.strm.avail_out===0))return l}else if(s.match_available){if((_=i._tr_tally(s,0,s.window[s.strstart-1]))&&I(s,!1),s.strstart++,s.lookahead--,s.strm.avail_out===0)return l}else s.match_available=1,s.strstart++,s.lookahead--}return s.match_available&&(_=i._tr_tally(s,0,s.window[s.strstart-1]),s.match_available=0),s.insert=s.strstart<R-1?s.strstart:R-1,O===v?(I(s,!0),s.strm.avail_out===0?Q:W):s.last_lit&&(I(s,!1),s.strm.avail_out===0)?l:N}function it(s,O,A,_,y){this.good_length=s,this.max_lazy=O,this.nice_length=A,this.max_chain=_,this.func=y}function ut(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=b,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*B),this.dyn_dtree=new n.Buf16(2*(2*E+1)),this.bl_tree=new n.Buf16(2*(2*F+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(U+1),this.heap=new n.Buf16(2*C+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*C+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function lt(s){var O;return s&&s.state?(s.total_in=s.total_out=0,s.data_type=p,(O=s.state).pending=0,O.pending_out=0,O.wrap<0&&(O.wrap=-O.wrap),O.status=O.wrap?x:D,s.adler=O.wrap===2?0:1,O.last_flush=m,i._tr_init(O),u):et(s,g)}function pt(s){var O=lt(s);return O===u&&(function(A){A.window_size=2*A.w_size,J(A.head),A.max_lazy_match=e[A.level].max_lazy,A.good_match=e[A.level].good_length,A.nice_match=e[A.level].nice_length,A.max_chain_length=e[A.level].max_chain,A.strstart=0,A.block_start=0,A.lookahead=0,A.insert=0,A.match_length=A.prev_length=R-1,A.match_available=0,A.ins_h=0})(s.state),O}function ft(s,O,A,_,y,T){if(!s)return g;var P=1;if(O===h&&(O=6),_<0?(P=0,_=-_):15<_&&(P=2,_-=16),y<1||k<y||A!==b||_<8||15<_||O<0||9<O||T<0||f<T)return et(s,g);_===8&&(_=9);var L=new ut;return(s.state=L).strm=s,L.wrap=P,L.gzhead=null,L.w_bits=_,L.w_size=1<<L.w_bits,L.w_mask=L.w_size-1,L.hash_bits=y+7,L.hash_size=1<<L.hash_bits,L.hash_mask=L.hash_size-1,L.hash_shift=~~((L.hash_bits+R-1)/R),L.window=new n.Buf8(2*L.w_size),L.head=new n.Buf16(L.hash_size),L.prev=new n.Buf16(L.w_size),L.lit_bufsize=1<<y+6,L.pending_buf_size=4*L.lit_bufsize,L.pending_buf=new n.Buf8(L.pending_buf_size),L.d_buf=1*L.lit_bufsize,L.l_buf=3*L.lit_bufsize,L.level=O,L.strategy=T,L.method=A,pt(s)}e=[new it(0,0,0,0,function(s,O){var A=65535;for(A>s.pending_buf_size-5&&(A=s.pending_buf_size-5);;){if(s.lookahead<=1){if(ot(s),s.lookahead===0&&O===m)return l;if(s.lookahead===0)break}s.strstart+=s.lookahead,s.lookahead=0;var _=s.block_start+A;if((s.strstart===0||s.strstart>=_)&&(s.lookahead=s.strstart-_,s.strstart=_,I(s,!1),s.strm.avail_out===0)||s.strstart-s.block_start>=s.w_size-V&&(I(s,!1),s.strm.avail_out===0))return l}return s.insert=0,O===v?(I(s,!0),s.strm.avail_out===0?Q:W):(s.strstart>s.block_start&&(I(s,!1),s.strm.avail_out),l)}),new it(4,4,8,4,ht),new it(4,5,16,8,ht),new it(4,6,32,32,ht),new it(4,4,16,16,nt),new it(8,16,32,32,nt),new it(8,16,128,128,nt),new it(8,32,128,256,nt),new it(32,128,258,1024,nt),new it(32,258,258,4096,nt)],a.deflateInit=function(s,O){return ft(s,O,b,15,8,0)},a.deflateInit2=ft,a.deflateReset=pt,a.deflateResetKeep=lt,a.deflateSetHeader=function(s,O){return s&&s.state?s.state.wrap!==2?g:(s.state.gzhead=O,u):g},a.deflate=function(s,O){var A,_,y,T;if(!s||!s.state||5<O||O<0)return s?et(s,g):g;if(_=s.state,!s.output||!s.input&&s.avail_in!==0||_.status===666&&O!==v)return et(s,s.avail_out===0?-5:g);if(_.strm=s,A=_.last_flush,_.last_flush=O,_.status===x)if(_.wrap===2)s.adler=0,K(_,31),K(_,139),K(_,8),_.gzhead?(K(_,(_.gzhead.text?1:0)+(_.gzhead.hcrc?2:0)+(_.gzhead.extra?4:0)+(_.gzhead.name?8:0)+(_.gzhead.comment?16:0)),K(_,255&_.gzhead.time),K(_,_.gzhead.time>>8&255),K(_,_.gzhead.time>>16&255),K(_,_.gzhead.time>>24&255),K(_,_.level===9?2:2<=_.strategy||_.level<2?4:0),K(_,255&_.gzhead.os),_.gzhead.extra&&_.gzhead.extra.length&&(K(_,255&_.gzhead.extra.length),K(_,_.gzhead.extra.length>>8&255)),_.gzhead.hcrc&&(s.adler=d(s.adler,_.pending_buf,_.pending,0)),_.gzindex=0,_.status=69):(K(_,0),K(_,0),K(_,0),K(_,0),K(_,0),K(_,_.level===9?2:2<=_.strategy||_.level<2?4:0),K(_,3),_.status=D);else{var P=b+(_.w_bits-8<<4)<<8;P|=(2<=_.strategy||_.level<2?0:_.level<6?1:_.level===6?2:3)<<6,_.strstart!==0&&(P|=32),P+=31-P%31,_.status=D,G(_,P),_.strstart!==0&&(G(_,s.adler>>>16),G(_,65535&s.adler)),s.adler=1}if(_.status===69)if(_.gzhead.extra){for(y=_.pending;_.gzindex<(65535&_.gzhead.extra.length)&&(_.pending!==_.pending_buf_size||(_.gzhead.hcrc&&_.pending>y&&(s.adler=d(s.adler,_.pending_buf,_.pending-y,y)),z(s),y=_.pending,_.pending!==_.pending_buf_size));)K(_,255&_.gzhead.extra[_.gzindex]),_.gzindex++;_.gzhead.hcrc&&_.pending>y&&(s.adler=d(s.adler,_.pending_buf,_.pending-y,y)),_.gzindex===_.gzhead.extra.length&&(_.gzindex=0,_.status=73)}else _.status=73;if(_.status===73)if(_.gzhead.name){y=_.pending;do{if(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>y&&(s.adler=d(s.adler,_.pending_buf,_.pending-y,y)),z(s),y=_.pending,_.pending===_.pending_buf_size)){T=1;break}T=_.gzindex<_.gzhead.name.length?255&_.gzhead.name.charCodeAt(_.gzindex++):0,K(_,T)}while(T!==0);_.gzhead.hcrc&&_.pending>y&&(s.adler=d(s.adler,_.pending_buf,_.pending-y,y)),T===0&&(_.gzindex=0,_.status=91)}else _.status=91;if(_.status===91)if(_.gzhead.comment){y=_.pending;do{if(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>y&&(s.adler=d(s.adler,_.pending_buf,_.pending-y,y)),z(s),y=_.pending,_.pending===_.pending_buf_size)){T=1;break}T=_.gzindex<_.gzhead.comment.length?255&_.gzhead.comment.charCodeAt(_.gzindex++):0,K(_,T)}while(T!==0);_.gzhead.hcrc&&_.pending>y&&(s.adler=d(s.adler,_.pending_buf,_.pending-y,y)),T===0&&(_.status=103)}else _.status=103;if(_.status===103&&(_.gzhead.hcrc?(_.pending+2>_.pending_buf_size&&z(s),_.pending+2<=_.pending_buf_size&&(K(_,255&s.adler),K(_,s.adler>>8&255),s.adler=0,_.status=D)):_.status=D),_.pending!==0){if(z(s),s.avail_out===0)return _.last_flush=-1,u}else if(s.avail_in===0&&M(O)<=M(A)&&O!==v)return et(s,-5);if(_.status===666&&s.avail_in!==0)return et(s,-5);if(s.avail_in!==0||_.lookahead!==0||O!==m&&_.status!==666){var L=_.strategy===2?(function(S,$){for(var q;;){if(S.lookahead===0&&(ot(S),S.lookahead===0)){if($===m)return l;break}if(S.match_length=0,q=i._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++,q&&(I(S,!1),S.strm.avail_out===0))return l}return S.insert=0,$===v?(I(S,!0),S.strm.avail_out===0?Q:W):S.last_lit&&(I(S,!1),S.strm.avail_out===0)?l:N})(_,O):_.strategy===3?(function(S,$){for(var q,X,Y,at,rt=S.window;;){if(S.lookahead<=Z){if(ot(S),S.lookahead<=Z&&$===m)return l;if(S.lookahead===0)break}if(S.match_length=0,S.lookahead>=R&&0<S.strstart&&(X=rt[Y=S.strstart-1])===rt[++Y]&&X===rt[++Y]&&X===rt[++Y]){at=S.strstart+Z;do;while(X===rt[++Y]&&X===rt[++Y]&&X===rt[++Y]&&X===rt[++Y]&&X===rt[++Y]&&X===rt[++Y]&&X===rt[++Y]&&X===rt[++Y]&&Y<at);S.match_length=Z-(at-Y),S.match_length>S.lookahead&&(S.match_length=S.lookahead)}if(S.match_length>=R?(q=i._tr_tally(S,1,S.match_length-R),S.lookahead-=S.match_length,S.strstart+=S.match_length,S.match_length=0):(q=i._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++),q&&(I(S,!1),S.strm.avail_out===0))return l}return S.insert=0,$===v?(I(S,!0),S.strm.avail_out===0?Q:W):S.last_lit&&(I(S,!1),S.strm.avail_out===0)?l:N})(_,O):e[_.level].func(_,O);if(L!==Q&&L!==W||(_.status=666),L===l||L===Q)return s.avail_out===0&&(_.last_flush=-1),u;if(L===N&&(O===1?i._tr_align(_):O!==5&&(i._tr_stored_block(_,0,0,!1),O===3&&(J(_.head),_.lookahead===0&&(_.strstart=0,_.block_start=0,_.insert=0))),z(s),s.avail_out===0))return _.last_flush=-1,u}return O!==v?u:_.wrap<=0?1:(_.wrap===2?(K(_,255&s.adler),K(_,s.adler>>8&255),K(_,s.adler>>16&255),K(_,s.adler>>24&255),K(_,255&s.total_in),K(_,s.total_in>>8&255),K(_,s.total_in>>16&255),K(_,s.total_in>>24&255)):(G(_,s.adler>>>16),G(_,65535&s.adler)),z(s),0<_.wrap&&(_.wrap=-_.wrap),_.pending!==0?u:1)},a.deflateEnd=function(s){var O;return s&&s.state?(O=s.state.status)!==x&&O!==69&&O!==73&&O!==91&&O!==103&&O!==D&&O!==666?et(s,g):(s.state=null,O===D?et(s,-3):u):g},a.deflateSetDictionary=function(s,O){var A,_,y,T,P,L,S,$,q=O.length;if(!s||!s.state||(T=(A=s.state).wrap)===2||T===1&&A.status!==x||A.lookahead)return g;for(T===1&&(s.adler=o(s.adler,O,q,0)),A.wrap=0,q>=A.w_size&&(T===0&&(J(A.head),A.strstart=0,A.block_start=0,A.insert=0),$=new n.Buf8(A.w_size),n.arraySet($,O,q-A.w_size,A.w_size,0),O=$,q=A.w_size),P=s.avail_in,L=s.next_in,S=s.input,s.avail_in=q,s.next_in=0,s.input=O,ot(A);A.lookahead>=R;){for(_=A.strstart,y=A.lookahead-(R-1);A.ins_h=(A.ins_h<<A.hash_shift^A.window[_+R-1])&A.hash_mask,A.prev[_&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=_,_++,--y;);A.strstart=_,A.lookahead=R-1,ot(A)}return A.strstart+=A.lookahead,A.block_start=A.strstart,A.insert=A.lookahead,A.lookahead=0,A.match_length=A.prev_length=R-1,A.match_available=0,s.next_in=L,s.input=S,s.avail_in=P,A.wrap=T,u},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,c,a){c.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,c,a){c.exports=function(e,n){var i,o,d,w,m,v,u,g,h,f,p,b,k,C,E,F,B,U,R,Z,V,x,D,l,N;i=e.state,o=e.next_in,l=e.input,d=o+(e.avail_in-5),w=e.next_out,N=e.output,m=w-(n-e.avail_out),v=w+(e.avail_out-257),u=i.dmax,g=i.wsize,h=i.whave,f=i.wnext,p=i.window,b=i.hold,k=i.bits,C=i.lencode,E=i.distcode,F=(1<<i.lenbits)-1,B=(1<<i.distbits)-1;t:do{k<15&&(b+=l[o++]<<k,k+=8,b+=l[o++]<<k,k+=8),U=C[b&F];e:for(;;){if(b>>>=R=U>>>24,k-=R,(R=U>>>16&255)===0)N[w++]=65535&U;else{if(!(16&R)){if((64&R)==0){U=C[(65535&U)+(b&(1<<R)-1)];continue e}if(32&R){i.mode=12;break t}e.msg="invalid literal/length code",i.mode=30;break t}Z=65535&U,(R&=15)&&(k<R&&(b+=l[o++]<<k,k+=8),Z+=b&(1<<R)-1,b>>>=R,k-=R),k<15&&(b+=l[o++]<<k,k+=8,b+=l[o++]<<k,k+=8),U=E[b&B];n:for(;;){if(b>>>=R=U>>>24,k-=R,!(16&(R=U>>>16&255))){if((64&R)==0){U=E[(65535&U)+(b&(1<<R)-1)];continue n}e.msg="invalid distance code",i.mode=30;break t}if(V=65535&U,k<(R&=15)&&(b+=l[o++]<<k,(k+=8)<R&&(b+=l[o++]<<k,k+=8)),u<(V+=b&(1<<R)-1)){e.msg="invalid distance too far back",i.mode=30;break t}if(b>>>=R,k-=R,(R=w-m)<V){if(h<(R=V-R)&&i.sane){e.msg="invalid distance too far back",i.mode=30;break t}if(D=p,(x=0)===f){if(x+=g-R,R<Z){for(Z-=R;N[w++]=p[x++],--R;);x=w-V,D=N}}else if(f<R){if(x+=g+f-R,(R-=f)<Z){for(Z-=R;N[w++]=p[x++],--R;);if(x=0,f<Z){for(Z-=R=f;N[w++]=p[x++],--R;);x=w-V,D=N}}}else if(x+=f-R,R<Z){for(Z-=R;N[w++]=p[x++],--R;);x=w-V,D=N}for(;2<Z;)N[w++]=D[x++],N[w++]=D[x++],N[w++]=D[x++],Z-=3;Z&&(N[w++]=D[x++],1<Z&&(N[w++]=D[x++]))}else{for(x=w-V;N[w++]=N[x++],N[w++]=N[x++],N[w++]=N[x++],2<(Z-=3););Z&&(N[w++]=N[x++],1<Z&&(N[w++]=N[x++]))}break}}break}}while(o<d&&w<v);o-=Z=k>>3,b&=(1<<(k-=Z<<3))-1,e.next_in=o,e.next_out=w,e.avail_in=o<d?d-o+5:5-(o-d),e.avail_out=w<v?v-w+257:257-(w-v),i.hold=b,i.bits=k}},{}],49:[function(t,c,a){var e=t("../utils/common"),n=t("./adler32"),i=t("./crc32"),o=t("./inffast"),d=t("./inftrees"),w=1,m=2,v=0,u=-2,g=1,h=852,f=592;function p(x){return(x>>>24&255)+(x>>>8&65280)+((65280&x)<<8)+((255&x)<<24)}function b(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(x){var D;return x&&x.state?(D=x.state,x.total_in=x.total_out=D.total=0,x.msg="",D.wrap&&(x.adler=1&D.wrap),D.mode=g,D.last=0,D.havedict=0,D.dmax=32768,D.head=null,D.hold=0,D.bits=0,D.lencode=D.lendyn=new e.Buf32(h),D.distcode=D.distdyn=new e.Buf32(f),D.sane=1,D.back=-1,v):u}function C(x){var D;return x&&x.state?((D=x.state).wsize=0,D.whave=0,D.wnext=0,k(x)):u}function E(x,D){var l,N;return x&&x.state?(N=x.state,D<0?(l=0,D=-D):(l=1+(D>>4),D<48&&(D&=15)),D&&(D<8||15<D)?u:(N.window!==null&&N.wbits!==D&&(N.window=null),N.wrap=l,N.wbits=D,C(x))):u}function F(x,D){var l,N;return x?(N=new b,(x.state=N).window=null,(l=E(x,D))!==v&&(x.state=null),l):u}var B,U,R=!0;function Z(x){if(R){var D;for(B=new e.Buf32(512),U=new e.Buf32(32),D=0;D<144;)x.lens[D++]=8;for(;D<256;)x.lens[D++]=9;for(;D<280;)x.lens[D++]=7;for(;D<288;)x.lens[D++]=8;for(d(w,x.lens,0,288,B,0,x.work,{bits:9}),D=0;D<32;)x.lens[D++]=5;d(m,x.lens,0,32,U,0,x.work,{bits:5}),R=!1}x.lencode=B,x.lenbits=9,x.distcode=U,x.distbits=5}function V(x,D,l,N){var Q,W=x.state;return W.window===null&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new e.Buf8(W.wsize)),N>=W.wsize?(e.arraySet(W.window,D,l-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(N<(Q=W.wsize-W.wnext)&&(Q=N),e.arraySet(W.window,D,l-N,Q,W.wnext),(N-=Q)?(e.arraySet(W.window,D,l-N,N,0),W.wnext=N,W.whave=W.wsize):(W.wnext+=Q,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=Q))),0}a.inflateReset=C,a.inflateReset2=E,a.inflateResetKeep=k,a.inflateInit=function(x){return F(x,15)},a.inflateInit2=F,a.inflate=function(x,D){var l,N,Q,W,et,M,J,z,I,K,G,H,ot,ht,nt,it,ut,lt,pt,ft,s,O,A,_,y=0,T=new e.Buf8(4),P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!x||!x.state||!x.output||!x.input&&x.avail_in!==0)return u;(l=x.state).mode===12&&(l.mode=13),et=x.next_out,Q=x.output,J=x.avail_out,W=x.next_in,N=x.input,M=x.avail_in,z=l.hold,I=l.bits,K=M,G=J,O=v;t:for(;;)switch(l.mode){case g:if(l.wrap===0){l.mode=13;break}for(;I<16;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}if(2&l.wrap&&z===35615){T[l.check=0]=255&z,T[1]=z>>>8&255,l.check=i(l.check,T,2,0),I=z=0,l.mode=2;break}if(l.flags=0,l.head&&(l.head.done=!1),!(1&l.wrap)||(((255&z)<<8)+(z>>8))%31){x.msg="incorrect header check",l.mode=30;break}if((15&z)!=8){x.msg="unknown compression method",l.mode=30;break}if(I-=4,s=8+(15&(z>>>=4)),l.wbits===0)l.wbits=s;else if(s>l.wbits){x.msg="invalid window size",l.mode=30;break}l.dmax=1<<s,x.adler=l.check=1,l.mode=512&z?10:12,I=z=0;break;case 2:for(;I<16;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}if(l.flags=z,(255&l.flags)!=8){x.msg="unknown compression method",l.mode=30;break}if(57344&l.flags){x.msg="unknown header flags set",l.mode=30;break}l.head&&(l.head.text=z>>8&1),512&l.flags&&(T[0]=255&z,T[1]=z>>>8&255,l.check=i(l.check,T,2,0)),I=z=0,l.mode=3;case 3:for(;I<32;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}l.head&&(l.head.time=z),512&l.flags&&(T[0]=255&z,T[1]=z>>>8&255,T[2]=z>>>16&255,T[3]=z>>>24&255,l.check=i(l.check,T,4,0)),I=z=0,l.mode=4;case 4:for(;I<16;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}l.head&&(l.head.xflags=255&z,l.head.os=z>>8),512&l.flags&&(T[0]=255&z,T[1]=z>>>8&255,l.check=i(l.check,T,2,0)),I=z=0,l.mode=5;case 5:if(1024&l.flags){for(;I<16;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}l.length=z,l.head&&(l.head.extra_len=z),512&l.flags&&(T[0]=255&z,T[1]=z>>>8&255,l.check=i(l.check,T,2,0)),I=z=0}else l.head&&(l.head.extra=null);l.mode=6;case 6:if(1024&l.flags&&(M<(H=l.length)&&(H=M),H&&(l.head&&(s=l.head.extra_len-l.length,l.head.extra||(l.head.extra=new Array(l.head.extra_len)),e.arraySet(l.head.extra,N,W,H,s)),512&l.flags&&(l.check=i(l.check,N,H,W)),M-=H,W+=H,l.length-=H),l.length))break t;l.length=0,l.mode=7;case 7:if(2048&l.flags){if(M===0)break t;for(H=0;s=N[W+H++],l.head&&s&&l.length<65536&&(l.head.name+=String.fromCharCode(s)),s&&H<M;);if(512&l.flags&&(l.check=i(l.check,N,H,W)),M-=H,W+=H,s)break t}else l.head&&(l.head.name=null);l.length=0,l.mode=8;case 8:if(4096&l.flags){if(M===0)break t;for(H=0;s=N[W+H++],l.head&&s&&l.length<65536&&(l.head.comment+=String.fromCharCode(s)),s&&H<M;);if(512&l.flags&&(l.check=i(l.check,N,H,W)),M-=H,W+=H,s)break t}else l.head&&(l.head.comment=null);l.mode=9;case 9:if(512&l.flags){for(;I<16;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}if(z!==(65535&l.check)){x.msg="header crc mismatch",l.mode=30;break}I=z=0}l.head&&(l.head.hcrc=l.flags>>9&1,l.head.done=!0),x.adler=l.check=0,l.mode=12;break;case 10:for(;I<32;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}x.adler=l.check=p(z),I=z=0,l.mode=11;case 11:if(l.havedict===0)return x.next_out=et,x.avail_out=J,x.next_in=W,x.avail_in=M,l.hold=z,l.bits=I,2;x.adler=l.check=1,l.mode=12;case 12:if(D===5||D===6)break t;case 13:if(l.last){z>>>=7&I,I-=7&I,l.mode=27;break}for(;I<3;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}switch(l.last=1&z,I-=1,3&(z>>>=1)){case 0:l.mode=14;break;case 1:if(Z(l),l.mode=20,D!==6)break;z>>>=2,I-=2;break t;case 2:l.mode=17;break;case 3:x.msg="invalid block type",l.mode=30}z>>>=2,I-=2;break;case 14:for(z>>>=7&I,I-=7&I;I<32;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}if((65535&z)!=(z>>>16^65535)){x.msg="invalid stored block lengths",l.mode=30;break}if(l.length=65535&z,I=z=0,l.mode=15,D===6)break t;case 15:l.mode=16;case 16:if(H=l.length){if(M<H&&(H=M),J<H&&(H=J),H===0)break t;e.arraySet(Q,N,W,H,et),M-=H,W+=H,J-=H,et+=H,l.length-=H;break}l.mode=12;break;case 17:for(;I<14;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}if(l.nlen=257+(31&z),z>>>=5,I-=5,l.ndist=1+(31&z),z>>>=5,I-=5,l.ncode=4+(15&z),z>>>=4,I-=4,286<l.nlen||30<l.ndist){x.msg="too many length or distance symbols",l.mode=30;break}l.have=0,l.mode=18;case 18:for(;l.have<l.ncode;){for(;I<3;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}l.lens[P[l.have++]]=7&z,z>>>=3,I-=3}for(;l.have<19;)l.lens[P[l.have++]]=0;if(l.lencode=l.lendyn,l.lenbits=7,A={bits:l.lenbits},O=d(0,l.lens,0,19,l.lencode,0,l.work,A),l.lenbits=A.bits,O){x.msg="invalid code lengths set",l.mode=30;break}l.have=0,l.mode=19;case 19:for(;l.have<l.nlen+l.ndist;){for(;it=(y=l.lencode[z&(1<<l.lenbits)-1])>>>16&255,ut=65535&y,!((nt=y>>>24)<=I);){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}if(ut<16)z>>>=nt,I-=nt,l.lens[l.have++]=ut;else{if(ut===16){for(_=nt+2;I<_;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}if(z>>>=nt,I-=nt,l.have===0){x.msg="invalid bit length repeat",l.mode=30;break}s=l.lens[l.have-1],H=3+(3&z),z>>>=2,I-=2}else if(ut===17){for(_=nt+3;I<_;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}I-=nt,s=0,H=3+(7&(z>>>=nt)),z>>>=3,I-=3}else{for(_=nt+7;I<_;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}I-=nt,s=0,H=11+(127&(z>>>=nt)),z>>>=7,I-=7}if(l.have+H>l.nlen+l.ndist){x.msg="invalid bit length repeat",l.mode=30;break}for(;H--;)l.lens[l.have++]=s}}if(l.mode===30)break;if(l.lens[256]===0){x.msg="invalid code -- missing end-of-block",l.mode=30;break}if(l.lenbits=9,A={bits:l.lenbits},O=d(w,l.lens,0,l.nlen,l.lencode,0,l.work,A),l.lenbits=A.bits,O){x.msg="invalid literal/lengths set",l.mode=30;break}if(l.distbits=6,l.distcode=l.distdyn,A={bits:l.distbits},O=d(m,l.lens,l.nlen,l.ndist,l.distcode,0,l.work,A),l.distbits=A.bits,O){x.msg="invalid distances set",l.mode=30;break}if(l.mode=20,D===6)break t;case 20:l.mode=21;case 21:if(6<=M&&258<=J){x.next_out=et,x.avail_out=J,x.next_in=W,x.avail_in=M,l.hold=z,l.bits=I,o(x,G),et=x.next_out,Q=x.output,J=x.avail_out,W=x.next_in,N=x.input,M=x.avail_in,z=l.hold,I=l.bits,l.mode===12&&(l.back=-1);break}for(l.back=0;it=(y=l.lencode[z&(1<<l.lenbits)-1])>>>16&255,ut=65535&y,!((nt=y>>>24)<=I);){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}if(it&&(240&it)==0){for(lt=nt,pt=it,ft=ut;it=(y=l.lencode[ft+((z&(1<<lt+pt)-1)>>lt)])>>>16&255,ut=65535&y,!(lt+(nt=y>>>24)<=I);){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}z>>>=lt,I-=lt,l.back+=lt}if(z>>>=nt,I-=nt,l.back+=nt,l.length=ut,it===0){l.mode=26;break}if(32&it){l.back=-1,l.mode=12;break}if(64&it){x.msg="invalid literal/length code",l.mode=30;break}l.extra=15&it,l.mode=22;case 22:if(l.extra){for(_=l.extra;I<_;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}l.length+=z&(1<<l.extra)-1,z>>>=l.extra,I-=l.extra,l.back+=l.extra}l.was=l.length,l.mode=23;case 23:for(;it=(y=l.distcode[z&(1<<l.distbits)-1])>>>16&255,ut=65535&y,!((nt=y>>>24)<=I);){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}if((240&it)==0){for(lt=nt,pt=it,ft=ut;it=(y=l.distcode[ft+((z&(1<<lt+pt)-1)>>lt)])>>>16&255,ut=65535&y,!(lt+(nt=y>>>24)<=I);){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}z>>>=lt,I-=lt,l.back+=lt}if(z>>>=nt,I-=nt,l.back+=nt,64&it){x.msg="invalid distance code",l.mode=30;break}l.offset=ut,l.extra=15&it,l.mode=24;case 24:if(l.extra){for(_=l.extra;I<_;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}l.offset+=z&(1<<l.extra)-1,z>>>=l.extra,I-=l.extra,l.back+=l.extra}if(l.offset>l.dmax){x.msg="invalid distance too far back",l.mode=30;break}l.mode=25;case 25:if(J===0)break t;if(H=G-J,l.offset>H){if((H=l.offset-H)>l.whave&&l.sane){x.msg="invalid distance too far back",l.mode=30;break}ot=H>l.wnext?(H-=l.wnext,l.wsize-H):l.wnext-H,H>l.length&&(H=l.length),ht=l.window}else ht=Q,ot=et-l.offset,H=l.length;for(J<H&&(H=J),J-=H,l.length-=H;Q[et++]=ht[ot++],--H;);l.length===0&&(l.mode=21);break;case 26:if(J===0)break t;Q[et++]=l.length,J--,l.mode=21;break;case 27:if(l.wrap){for(;I<32;){if(M===0)break t;M--,z|=N[W++]<<I,I+=8}if(G-=J,x.total_out+=G,l.total+=G,G&&(x.adler=l.check=l.flags?i(l.check,Q,G,et-G):n(l.check,Q,G,et-G)),G=J,(l.flags?z:p(z))!==l.check){x.msg="incorrect data check",l.mode=30;break}I=z=0}l.mode=28;case 28:if(l.wrap&&l.flags){for(;I<32;){if(M===0)break t;M--,z+=N[W++]<<I,I+=8}if(z!==(4294967295&l.total)){x.msg="incorrect length check",l.mode=30;break}I=z=0}l.mode=29;case 29:O=1;break t;case 30:O=-3;break t;case 31:return-4;case 32:default:return u}return x.next_out=et,x.avail_out=J,x.next_in=W,x.avail_in=M,l.hold=z,l.bits=I,(l.wsize||G!==x.avail_out&&l.mode<30&&(l.mode<27||D!==4))&&V(x,x.output,x.next_out,G-x.avail_out)?(l.mode=31,-4):(K-=x.avail_in,G-=x.avail_out,x.total_in+=K,x.total_out+=G,l.total+=G,l.wrap&&G&&(x.adler=l.check=l.flags?i(l.check,Q,G,x.next_out-G):n(l.check,Q,G,x.next_out-G)),x.data_type=l.bits+(l.last?64:0)+(l.mode===12?128:0)+(l.mode===20||l.mode===15?256:0),(K==0&&G===0||D===4)&&O===v&&(O=-5),O)},a.inflateEnd=function(x){if(!x||!x.state)return u;var D=x.state;return D.window&&(D.window=null),x.state=null,v},a.inflateGetHeader=function(x,D){var l;return x&&x.state?(2&(l=x.state).wrap)==0?u:((l.head=D).done=!1,v):u},a.inflateSetDictionary=function(x,D){var l,N=D.length;return x&&x.state?(l=x.state).wrap!==0&&l.mode!==11?u:l.mode===11&&n(1,D,N,0)!==l.check?-3:V(x,D,N,N)?(l.mode=31,-4):(l.havedict=1,v):u},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,c,a){var e=t("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];c.exports=function(w,m,v,u,g,h,f,p){var b,k,C,E,F,B,U,R,Z,V=p.bits,x=0,D=0,l=0,N=0,Q=0,W=0,et=0,M=0,J=0,z=0,I=null,K=0,G=new e.Buf16(16),H=new e.Buf16(16),ot=null,ht=0;for(x=0;x<=15;x++)G[x]=0;for(D=0;D<u;D++)G[m[v+D]]++;for(Q=V,N=15;1<=N&&G[N]===0;N--);if(N<Q&&(Q=N),N===0)return g[h++]=20971520,g[h++]=20971520,p.bits=1,0;for(l=1;l<N&&G[l]===0;l++);for(Q<l&&(Q=l),x=M=1;x<=15;x++)if(M<<=1,(M-=G[x])<0)return-1;if(0<M&&(w===0||N!==1))return-1;for(H[1]=0,x=1;x<15;x++)H[x+1]=H[x]+G[x];for(D=0;D<u;D++)m[v+D]!==0&&(f[H[m[v+D]]++]=D);if(B=w===0?(I=ot=f,19):w===1?(I=n,K-=257,ot=i,ht-=257,256):(I=o,ot=d,-1),x=l,F=h,et=D=z=0,C=-1,E=(J=1<<(W=Q))-1,w===1&&852<J||w===2&&592<J)return 1;for(;;){for(U=x-et,Z=f[D]<B?(R=0,f[D]):f[D]>B?(R=ot[ht+f[D]],I[K+f[D]]):(R=96,0),b=1<<x-et,l=k=1<<W;g[F+(z>>et)+(k-=b)]=U<<24|R<<16|Z|0,k!==0;);for(b=1<<x-1;z&b;)b>>=1;if(b!==0?(z&=b-1,z+=b):z=0,D++,--G[x]==0){if(x===N)break;x=m[v+f[D]]}if(Q<x&&(z&E)!==C){for(et===0&&(et=Q),F+=l,M=1<<(W=x-et);W+et<N&&!((M-=G[W+et])<=0);)W++,M<<=1;if(J+=1<<W,w===1&&852<J||w===2&&592<J)return 1;g[C=z&E]=Q<<24|W<<16|F-h|0}}return z!==0&&(g[F+z]=x-et<<24|64<<16|0),p.bits=Q,0}},{"../utils/common":41}],51:[function(t,c,a){c.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,c,a){var e=t("../utils/common"),n=0,i=1;function o(y){for(var T=y.length;0<=--T;)y[T]=0}var d=0,w=29,m=256,v=m+1+w,u=30,g=19,h=2*v+1,f=15,p=16,b=7,k=256,C=16,E=17,F=18,B=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],U=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=new Array(2*(v+2));o(V);var x=new Array(2*u);o(x);var D=new Array(512);o(D);var l=new Array(256);o(l);var N=new Array(w);o(N);var Q,W,et,M=new Array(u);function J(y,T,P,L,S){this.static_tree=y,this.extra_bits=T,this.extra_base=P,this.elems=L,this.max_length=S,this.has_stree=y&&y.length}function z(y,T){this.dyn_tree=y,this.max_code=0,this.stat_desc=T}function I(y){return y<256?D[y]:D[256+(y>>>7)]}function K(y,T){y.pending_buf[y.pending++]=255&T,y.pending_buf[y.pending++]=T>>>8&255}function G(y,T,P){y.bi_valid>p-P?(y.bi_buf|=T<<y.bi_valid&65535,K(y,y.bi_buf),y.bi_buf=T>>p-y.bi_valid,y.bi_valid+=P-p):(y.bi_buf|=T<<y.bi_valid&65535,y.bi_valid+=P)}function H(y,T,P){G(y,P[2*T],P[2*T+1])}function ot(y,T){for(var P=0;P|=1&y,y>>>=1,P<<=1,0<--T;);return P>>>1}function ht(y,T,P){var L,S,$=new Array(f+1),q=0;for(L=1;L<=f;L++)$[L]=q=q+P[L-1]<<1;for(S=0;S<=T;S++){var X=y[2*S+1];X!==0&&(y[2*S]=ot($[X]++,X))}}function nt(y){var T;for(T=0;T<v;T++)y.dyn_ltree[2*T]=0;for(T=0;T<u;T++)y.dyn_dtree[2*T]=0;for(T=0;T<g;T++)y.bl_tree[2*T]=0;y.dyn_ltree[2*k]=1,y.opt_len=y.static_len=0,y.last_lit=y.matches=0}function it(y){8<y.bi_valid?K(y,y.bi_buf):0<y.bi_valid&&(y.pending_buf[y.pending++]=y.bi_buf),y.bi_buf=0,y.bi_valid=0}function ut(y,T,P,L){var S=2*T,$=2*P;return y[S]<y[$]||y[S]===y[$]&&L[T]<=L[P]}function lt(y,T,P){for(var L=y.heap[P],S=P<<1;S<=y.heap_len&&(S<y.heap_len&&ut(T,y.heap[S+1],y.heap[S],y.depth)&&S++,!ut(T,L,y.heap[S],y.depth));)y.heap[P]=y.heap[S],P=S,S<<=1;y.heap[P]=L}function pt(y,T,P){var L,S,$,q,X=0;if(y.last_lit!==0)for(;L=y.pending_buf[y.d_buf+2*X]<<8|y.pending_buf[y.d_buf+2*X+1],S=y.pending_buf[y.l_buf+X],X++,L===0?H(y,S,T):(H(y,($=l[S])+m+1,T),(q=B[$])!==0&&G(y,S-=N[$],q),H(y,$=I(--L),P),(q=U[$])!==0&&G(y,L-=M[$],q)),X<y.last_lit;);H(y,k,T)}function ft(y,T){var P,L,S,$=T.dyn_tree,q=T.stat_desc.static_tree,X=T.stat_desc.has_stree,Y=T.stat_desc.elems,at=-1;for(y.heap_len=0,y.heap_max=h,P=0;P<Y;P++)$[2*P]!==0?(y.heap[++y.heap_len]=at=P,y.depth[P]=0):$[2*P+1]=0;for(;y.heap_len<2;)$[2*(S=y.heap[++y.heap_len]=at<2?++at:0)]=1,y.depth[S]=0,y.opt_len--,X&&(y.static_len-=q[2*S+1]);for(T.max_code=at,P=y.heap_len>>1;1<=P;P--)lt(y,$,P);for(S=Y;P=y.heap[1],y.heap[1]=y.heap[y.heap_len--],lt(y,$,1),L=y.heap[1],y.heap[--y.heap_max]=P,y.heap[--y.heap_max]=L,$[2*S]=$[2*P]+$[2*L],y.depth[S]=(y.depth[P]>=y.depth[L]?y.depth[P]:y.depth[L])+1,$[2*P+1]=$[2*L+1]=S,y.heap[1]=S++,lt(y,$,1),2<=y.heap_len;);y.heap[--y.heap_max]=y.heap[1],(function(rt,dt){var wt,mt,bt,ct,xt,It,gt=dt.dyn_tree,Dt=dt.max_code,Wt=dt.stat_desc.static_tree,Mt=dt.stat_desc.has_stree,Zt=dt.stat_desc.extra_bits,Ot=dt.stat_desc.extra_base,_t=dt.stat_desc.max_length,kt=0;for(ct=0;ct<=f;ct++)rt.bl_count[ct]=0;for(gt[2*rt.heap[rt.heap_max]+1]=0,wt=rt.heap_max+1;wt<h;wt++)_t<(ct=gt[2*gt[2*(mt=rt.heap[wt])+1]+1]+1)&&(ct=_t,kt++),gt[2*mt+1]=ct,Dt<mt||(rt.bl_count[ct]++,xt=0,Ot<=mt&&(xt=Zt[mt-Ot]),It=gt[2*mt],rt.opt_len+=It*(ct+xt),Mt&&(rt.static_len+=It*(Wt[2*mt+1]+xt)));if(kt!==0){do{for(ct=_t-1;rt.bl_count[ct]===0;)ct--;rt.bl_count[ct]--,rt.bl_count[ct+1]+=2,rt.bl_count[_t]--,kt-=2}while(0<kt);for(ct=_t;ct!==0;ct--)for(mt=rt.bl_count[ct];mt!==0;)Dt<(bt=rt.heap[--wt])||(gt[2*bt+1]!==ct&&(rt.opt_len+=(ct-gt[2*bt+1])*gt[2*bt],gt[2*bt+1]=ct),mt--)}})(y,T),ht($,at,y.bl_count)}function s(y,T,P){var L,S,$=-1,q=T[1],X=0,Y=7,at=4;for(q===0&&(Y=138,at=3),T[2*(P+1)+1]=65535,L=0;L<=P;L++)S=q,q=T[2*(L+1)+1],++X<Y&&S===q||(X<at?y.bl_tree[2*S]+=X:S!==0?(S!==$&&y.bl_tree[2*S]++,y.bl_tree[2*C]++):X<=10?y.bl_tree[2*E]++:y.bl_tree[2*F]++,$=S,at=(X=0)===q?(Y=138,3):S===q?(Y=6,3):(Y=7,4))}function O(y,T,P){var L,S,$=-1,q=T[1],X=0,Y=7,at=4;for(q===0&&(Y=138,at=3),L=0;L<=P;L++)if(S=q,q=T[2*(L+1)+1],!(++X<Y&&S===q)){if(X<at)for(;H(y,S,y.bl_tree),--X!=0;);else S!==0?(S!==$&&(H(y,S,y.bl_tree),X--),H(y,C,y.bl_tree),G(y,X-3,2)):X<=10?(H(y,E,y.bl_tree),G(y,X-3,3)):(H(y,F,y.bl_tree),G(y,X-11,7));$=S,at=(X=0)===q?(Y=138,3):S===q?(Y=6,3):(Y=7,4)}}o(M);var A=!1;function _(y,T,P,L){G(y,(d<<1)+(L?1:0),3),(function(S,$,q,X){it(S),K(S,q),K(S,~q),e.arraySet(S.pending_buf,S.window,$,q,S.pending),S.pending+=q})(y,T,P)}a._tr_init=function(y){A||((function(){var T,P,L,S,$,q=new Array(f+1);for(S=L=0;S<w-1;S++)for(N[S]=L,T=0;T<1<<B[S];T++)l[L++]=S;for(l[L-1]=S,S=$=0;S<16;S++)for(M[S]=$,T=0;T<1<<U[S];T++)D[$++]=S;for($>>=7;S<u;S++)for(M[S]=$<<7,T=0;T<1<<U[S]-7;T++)D[256+$++]=S;for(P=0;P<=f;P++)q[P]=0;for(T=0;T<=143;)V[2*T+1]=8,T++,q[8]++;for(;T<=255;)V[2*T+1]=9,T++,q[9]++;for(;T<=279;)V[2*T+1]=7,T++,q[7]++;for(;T<=287;)V[2*T+1]=8,T++,q[8]++;for(ht(V,v+1,q),T=0;T<u;T++)x[2*T+1]=5,x[2*T]=ot(T,5);Q=new J(V,B,m+1,v,f),W=new J(x,U,0,u,f),et=new J(new Array(0),R,0,g,b)})(),A=!0),y.l_desc=new z(y.dyn_ltree,Q),y.d_desc=new z(y.dyn_dtree,W),y.bl_desc=new z(y.bl_tree,et),y.bi_buf=0,y.bi_valid=0,nt(y)},a._tr_stored_block=_,a._tr_flush_block=function(y,T,P,L){var S,$,q=0;0<y.level?(y.strm.data_type===2&&(y.strm.data_type=(function(X){var Y,at=4093624447;for(Y=0;Y<=31;Y++,at>>>=1)if(1&at&&X.dyn_ltree[2*Y]!==0)return n;if(X.dyn_ltree[18]!==0||X.dyn_ltree[20]!==0||X.dyn_ltree[26]!==0)return i;for(Y=32;Y<m;Y++)if(X.dyn_ltree[2*Y]!==0)return i;return n})(y)),ft(y,y.l_desc),ft(y,y.d_desc),q=(function(X){var Y;for(s(X,X.dyn_ltree,X.l_desc.max_code),s(X,X.dyn_dtree,X.d_desc.max_code),ft(X,X.bl_desc),Y=g-1;3<=Y&&X.bl_tree[2*Z[Y]+1]===0;Y--);return X.opt_len+=3*(Y+1)+5+5+4,Y})(y),S=y.opt_len+3+7>>>3,($=y.static_len+3+7>>>3)<=S&&(S=$)):S=$=P+5,P+4<=S&&T!==-1?_(y,T,P,L):y.strategy===4||$===S?(G(y,2+(L?1:0),3),pt(y,V,x)):(G(y,4+(L?1:0),3),(function(X,Y,at,rt){var dt;for(G(X,Y-257,5),G(X,at-1,5),G(X,rt-4,4),dt=0;dt<rt;dt++)G(X,X.bl_tree[2*Z[dt]+1],3);O(X,X.dyn_ltree,Y-1),O(X,X.dyn_dtree,at-1)})(y,y.l_desc.max_code+1,y.d_desc.max_code+1,q+1),pt(y,y.dyn_ltree,y.dyn_dtree)),nt(y),L&&it(y)},a._tr_tally=function(y,T,P){return y.pending_buf[y.d_buf+2*y.last_lit]=T>>>8&255,y.pending_buf[y.d_buf+2*y.last_lit+1]=255&T,y.pending_buf[y.l_buf+y.last_lit]=255&P,y.last_lit++,T===0?y.dyn_ltree[2*P]++:(y.matches++,T--,y.dyn_ltree[2*(l[P]+m+1)]++,y.dyn_dtree[2*I(T)]++),y.last_lit===y.lit_bufsize-1},a._tr_align=function(y){G(y,2,3),H(y,k,V),(function(T){T.bi_valid===16?(K(T,T.bi_buf),T.bi_buf=0,T.bi_valid=0):8<=T.bi_valid&&(T.pending_buf[T.pending++]=255&T.bi_buf,T.bi_buf>>=8,T.bi_valid-=8)})(y)}},{"../utils/common":41}],53:[function(t,c,a){c.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,c,a){(function(e){(function(n,i){if(!n.setImmediate){var o,d,w,m,v=1,u={},g=!1,h=n.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(n);f=f&&f.setTimeout?f:n,o={}.toString.call(n.process)==="[object process]"?function(C){process.nextTick(function(){b(C)})}:(function(){if(n.postMessage&&!n.importScripts){var C=!0,E=n.onmessage;return n.onmessage=function(){C=!1},n.postMessage("","*"),n.onmessage=E,C}})()?(m="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",k,!1):n.attachEvent("onmessage",k),function(C){n.postMessage(m+C,"*")}):n.MessageChannel?((w=new MessageChannel).port1.onmessage=function(C){b(C.data)},function(C){w.port2.postMessage(C)}):h&&"onreadystatechange"in h.createElement("script")?(d=h.documentElement,function(C){var E=h.createElement("script");E.onreadystatechange=function(){b(C),E.onreadystatechange=null,d.removeChild(E),E=null},d.appendChild(E)}):function(C){setTimeout(b,0,C)},f.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var E=new Array(arguments.length-1),F=0;F<E.length;F++)E[F]=arguments[F+1];var B={callback:C,args:E};return u[v]=B,o(v),v++},f.clearImmediate=p}function p(C){delete u[C]}function b(C){if(g)setTimeout(b,0,C);else{var E=u[C];if(E){g=!0;try{(function(F){var B=F.callback,U=F.args;switch(U.length){case 0:B();break;case 1:B(U[0]);break;case 2:B(U[0],U[1]);break;case 3:B(U[0],U[1],U[2]);break;default:B.apply(i,U)}})(E)}finally{p(C),g=!1}}}}function k(C){C.source===n&&typeof C.data=="string"&&C.data.indexOf(m)===0&&b(+C.data.slice(m.length))}})(typeof self>"u"?e===void 0?this:e:self)}).call(this,typeof Ct<"u"?Ct:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(zt)),zt.exports}var Yt=qt();const Tt=Gt(Yt);class Kt{constructor(){tt(this,"scriptLoaded",!1);tt(this,"tableCounter",0);this.ensureScriptLoaded()}ensureScriptLoaded(){if(this.scriptLoaded)return;if(typeof window.officeParser<"u"){this.scriptLoaded=!0;return}if(document.querySelector('script[src="/officeparser.browser.js"]')){this.scriptLoaded=!0;return}throw new Error('officeparser.browser.js not loaded. Add <script src="/officeparser.browser.js"><\/script> to index.html')}async parseFile(r){this.ensureScriptLoaded();const t=await r.arrayBuffer(),c=await window.officeParser.parseOffice(t),a=await this.extractSectionProperties(t),e=this.normalizeAST(c);e.sectionProperties=a;const n=await this.extractNumberedLists(t);n.length>0&&(e.blocks=this.mergeBlocks(e.blocks,n)),this.tableCounter=0;const i=await this.extractTables(t);return i.length>0&&(e.blocks=this.mergeTableBlocks(e.blocks,i)),e}mergeTableBlocks(r,t){if(t.length===0)return r;const c=r.filter(i=>i.type!=="table"),a=[...t].sort((i,o)=>i.xmlIndex-o.xmlIndex),e=[],n=new Set(a.map(i=>i.block.text.toLowerCase().trim()));for(const i of c)n.has(i.text.toLowerCase().trim())||e.push(i);for(const i of a)e.push(i.block);return e.map((i,o)=>({...i,id:this.generateBlockId(i.text,o)}))}async extractTables(r){try{const c=await(await Tt.loadAsync(r)).file("word/document.xml")?.async("string");if(!c)return[];const e=new DOMParser().parseFromString(c,"application/xml"),n=[],i=e.getElementsByTagName("w:tbl"),o=e.getElementsByTagName("w:body")[0];if(!o)return[];const d=Array.from(o.children);let w=0;for(let m=0;m<i.length;m++){const v=i[m],u=`table-${this.tableCounter++}`,g=d.indexOf(v),h=v.getElementsByTagName("w:tr");for(let f=0;f<h.length;f++){const p=h[f],b=[],k=p.getElementsByTagName("w:tc");for(let E=0;E<k.length;E++){const F=k[E],B=this.extractTextFromTableCell(F);b.push(B)}const C=b.join(" | ").trim();if(C){const E=this.extractFormattingFromTableRow(p),F=C.replace(/\s+/g," ");n.push({block:{id:this.generateBlockId(F,2e3+w),type:"table-row",text:F,runs:[{text:F,formatting:E}],formatting:E,tableId:u,rowIndex:f},xmlIndex:g>=0?g*100+f:2e3+w}),w++}}}return n}catch(t){return console.warn("Failed to extract tables:",t),[]}}extractTextFromTableCell(r){const t=r.getElementsByTagName("w:t");let c="";for(let a=0;a<t.length;a++)c+=t[a].textContent||"";return c.trim()}extractFormattingFromTableRow(r){const t={},c=r.getElementsByTagName("w:b");if(c.length>0){const e=c[0].getAttribute("w:val");(e===null||e===""||e==="true"||e==="1")&&(t.bold=!0)}const a=r.getElementsByTagName("w:i");if(a.length>0){const e=a[0].getAttribute("w:val");(e===null||e===""||e==="true"||e==="1")&&(t.italic=!0)}return t}async extractNumberedLists(r){try{const c=await(await Tt.loadAsync(r)).file("word/document.xml")?.async("string");if(!c)return[];const e=new DOMParser().parseFromString(c,"application/xml"),n=[],i=e.getElementsByTagName("w:p");for(let o=0;o<i.length;o++){const d=i[o];if(d.getElementsByTagName("w:numPr").length>0){const m=this.extractTextFromParagraph(d);if(m.trim()){const v=this.extractFormattingFromParagraph(d),u=m.trim().replace(/\s+/g," ");n.push({block:{id:this.generateBlockId(u,1e3+o),type:"paragraph",text:u,runs:[{text:u,formatting:v}],formatting:v},xmlIndex:o})}}}return n}catch(t){return console.warn("Failed to extract numbered lists:",t),[]}}extractTextFromParagraph(r){const t=r.getElementsByTagName("w:t");let c="";for(let a=0;a<t.length;a++)c+=t[a].textContent||"";return c}extractFormattingFromParagraph(r){const t={},c=r.getElementsByTagName("w:b");if(c.length>0){const n=c[0].getAttribute("w:val");(n===null||n===""||n==="true"||n==="1")&&(t.bold=!0)}const a=r.getElementsByTagName("w:i");if(a.length>0){const n=a[0].getAttribute("w:val");(n===null||n===""||n==="true"||n==="1")&&(t.italic=!0)}const e=r.getElementsByTagName("w:u");if(e.length>0){const n=e[0].getAttribute("w:val");n&&n!=="none"&&(t.underline=!0)}return t}mergeBlocks(r,t){if(t.length===0)return r;if(r.length===0)return t.map(o=>o.block);const c=new Set(r.map(o=>o.text.toLowerCase().trim())),a=t.filter(o=>!c.has(o.block.text.toLowerCase().trim()));if(a.length===0)return r;a.sort((o,d)=>o.xmlIndex-d.xmlIndex);const e=[];let n=0,i=0;for(;n<r.length||i<a.length;){for(;i<a.length;){if(n>=r.length){e.push(a[i].block),i++;continue}const o=a[i].xmlIndex;if(i===0||o<(n+i)*2)e.push(a[i].block),i++;else break}n<r.length&&(e.push(r[n]),n++)}return e.map((o,d)=>({...o,id:this.generateBlockId(o.text,d)}))}async extractSectionProperties(r){try{const c=await(await Tt.loadAsync(r)).file("word/document.xml")?.async("string");if(!c)return{};const n=new DOMParser().parseFromString(c,"application/xml").getElementsByTagName("w:sectPr");if(n.length===0)return{};const o=n[n.length-1].getElementsByTagName("w:cols");if(o.length===0)return{};const d=o[0],w=d.getAttribute("w:num"),m=d.getAttribute("w:space"),v={};return w&&(v.columnCount=parseInt(w,10)),m&&(v.columnSpace=parseInt(m,10)),v}catch(t){return console.warn("Failed to extract section properties:",t),{}}}normalizeAST(r){const t=[],c={author:r.author||void 0,title:r.title||void 0,created:r.created?new Date(r.created):void 0,modified:r.modified?new Date(r.modified):void 0};return Array.isArray(r.content)&&r.content.forEach((a,e)=>{if(a.type&&a.type!=="paragraph"&&a.type!=="heading"&&a.type!=="table"&&console.log(`[DocxParser] Unhandled item type at index ${e}:`,a.type,a),a.type==="paragraph"||a.type==="heading"){const n=this.normalizeParagraph(a,e);n&&t.push(n)}else if(a.type==="table"){const n=this.normalizeTable(a,e);n&&t.push(n)}else(a.type==="page-break"||a.type==="break")&&t.push({id:`page-break-${e}`,type:"page-break",text:"",runs:[],formatting:{}})}),{metadata:c,blocks:t}}normalizeParagraph(r,t){let c="paragraph";if(r.style){const n=r.style.toLowerCase();n.includes("heading1")||n.includes("heading 1")?c="heading1":n.includes("heading2")||n.includes("heading 2")?c="heading2":(n.includes("heading3")||n.includes("heading 3"))&&(c="heading3")}let a=r.text||"";const e=[];if(Array.isArray(r.runs)&&r.runs.length>0&&(r.runs.forEach(n=>{const i=n.text||"";i&&e.push({text:i,formatting:this.extractFormatting(n)})}),a=e.map(n=>n.text).join("").trim().replace(/\s+/g," ")),e.length===0&&a){const n=a.trim().replace(/\s+/g," ");e.push({text:n,formatting:this.extractFormatting(r)}),a=n}return a.trim()?{id:this.generateBlockId(a,t),type:c,text:a.trim().replace(/\s+/g," "),runs:e,formatting:this.extractFormatting(r)}:null}normalizeTable(r,t){let c="";if(Array.isArray(r.rows)&&r.rows.forEach(e=>{if(Array.isArray(e.cells)){const n=e.cells.map(i=>i.text||"").filter(i=>i.trim());n.length>0&&(c+=n.join(" | ")+`
`)}}),!c.trim())return null;const a=c.trim().replace(/\s+/g," ");return{id:this.generateBlockId(a,t),type:"table",text:a,runs:[{text:a,formatting:{}}],formatting:{}}}extractFormatting(r){const t={};return r.bold===!0&&(t.bold=!0),r.italic===!0&&(t.italic=!0),r.underline===!0&&(t.underline=!0),r.color&&(t.color=r.color),r.font&&(t.font=r.font),r.fontSize&&(t.fontSize=r.fontSize),t}generateBlockId(r,t){const c=this.simpleHash(r.substring(0,100));return`block-${t}-${c}`}simpleHash(r){let t=0;for(let c=0;c<r.length;c++){const a=r.charCodeAt(c);t=(t<<5)-t+a,t=t&t}return Math.abs(t).toString(36)}terminate(){}}function yt(){}yt.prototype={diff:function(r,t){var c,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},e=a.callback;typeof a=="function"&&(e=a,a={}),this.options=a;var n=this;function i(C){return e?(setTimeout(function(){e(void 0,C)},0),!0):C}r=this.castInput(r),t=this.castInput(t),r=this.removeEmpty(this.tokenize(r)),t=this.removeEmpty(this.tokenize(t));var o=t.length,d=r.length,w=1,m=o+d;a.maxEditLength&&(m=Math.min(m,a.maxEditLength));var v=(c=a.timeout)!==null&&c!==void 0?c:1/0,u=Date.now()+v,g=[{oldPos:-1,lastComponent:void 0}],h=this.extractCommon(g[0],t,r,0);if(g[0].oldPos+1>=d&&h+1>=o)return i([{value:this.join(t),count:t.length}]);var f=-1/0,p=1/0;function b(){for(var C=Math.max(f,-w);C<=Math.min(p,w);C+=2){var E=void 0,F=g[C-1],B=g[C+1];F&&(g[C-1]=void 0);var U=!1;if(B){var R=B.oldPos-C;U=B&&0<=R&&R<o}var Z=F&&F.oldPos+1<d;if(!U&&!Z){g[C]=void 0;continue}if(!Z||U&&F.oldPos+1<B.oldPos?E=n.addToPath(B,!0,void 0,0):E=n.addToPath(F,void 0,!0,1),h=n.extractCommon(E,t,r,C),E.oldPos+1>=d&&h+1>=o)return i(Vt(n,E.lastComponent,t,r,n.useLongestToken));g[C]=E,E.oldPos+1>=d&&(p=Math.min(p,C-1)),h+1>=o&&(f=Math.max(f,C+1))}w++}if(e)(function C(){setTimeout(function(){if(w>m||Date.now()>u)return e();b()||C()},0)})();else for(;w<=m&&Date.now()<=u;){var k=b();if(k)return k}},addToPath:function(r,t,c,a){var e=r.lastComponent;return e&&e.added===t&&e.removed===c?{oldPos:r.oldPos+a,lastComponent:{count:e.count+1,added:t,removed:c,previousComponent:e.previousComponent}}:{oldPos:r.oldPos+a,lastComponent:{count:1,added:t,removed:c,previousComponent:e}}},extractCommon:function(r,t,c,a){for(var e=t.length,n=c.length,i=r.oldPos,o=i-a,d=0;o+1<e&&i+1<n&&this.equals(t[o+1],c[i+1]);)o++,i++,d++;return d&&(r.lastComponent={count:d,previousComponent:r.lastComponent}),r.oldPos=i,o},equals:function(r,t){return this.options.comparator?this.options.comparator(r,t):r===t||this.options.ignoreCase&&r.toLowerCase()===t.toLowerCase()},removeEmpty:function(r){for(var t=[],c=0;c<r.length;c++)r[c]&&t.push(r[c]);return t},castInput:function(r){return r},tokenize:function(r){return r.split("")},join:function(r){return r.join("")}};function Vt(j,r,t,c,a){for(var e=[],n;r;)e.push(r),n=r.previousComponent,delete r.previousComponent,r=n;e.reverse();for(var i=0,o=e.length,d=0,w=0;i<o;i++){var m=e[i];if(m.removed){if(m.value=j.join(c.slice(w,w+m.count)),w+=m.count,i&&e[i-1].added){var u=e[i-1];e[i-1]=e[i],e[i]=u}}else{if(!m.added&&a){var v=t.slice(d,d+m.count);v=v.map(function(h,f){var p=c[w+f];return p.length>h.length?p:h}),m.value=j.join(v)}else m.value=j.join(t.slice(d,d+m.count));d+=m.count,m.added||(w+=m.count)}}var g=e[o-1];return o>1&&typeof g.value=="string"&&(g.added||g.removed)&&j.equals("",g.value)&&(e[o-2].value+=g.value,e.pop()),e}function Jt(j,r){if(typeof j=="function")r.callback=j;else if(j)for(var t in j)j.hasOwnProperty(t)&&(r[t]=j[t]);return r}var Pt=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,Lt=/\S/,Ft=new yt;Ft.equals=function(j,r){return this.options.ignoreCase&&(j=j.toLowerCase(),r=r.toLowerCase()),j===r||this.options.ignoreWhitespace&&!Lt.test(j)&&!Lt.test(r)};Ft.tokenize=function(j){for(var r=j.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),t=0;t<r.length-1;t++)!r[t+1]&&r[t+2]&&Pt.test(r[t])&&Pt.test(r[t+2])&&(r[t]+=r[t+2],r.splice(t+1,2),t--);return r};function Qt(j,r,t){return t=Jt(t,{ignoreWhitespace:!0}),Ft.diff(j,r,t)}var jt=new yt;jt.tokenize=function(j){this.options.stripTrailingCr&&(j=j.replace(/\r\n/g,`
`));var r=[],t=j.split(/(\n|\r\n)/);t[t.length-1]||t.pop();for(var c=0;c<t.length;c++){var a=t[c];c%2&&!this.options.newlineIsToken?r[r.length-1]+=a:(this.options.ignoreWhitespace&&(a=a.trim()),r.push(a))}return r};var te=new yt;te.tokenize=function(j){return j.split(/(\S.+?[.!?])(?=\s+|$)/)};var ee=new yt;ee.tokenize=function(j){return j.split(/([{}:;,]|\s+)/)};function St(j){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?St=function(r){return typeof r}:St=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},St(j)}var ne=Object.prototype.toString,vt=new yt;vt.useLongestToken=!0;vt.tokenize=jt.tokenize;vt.castInput=function(j){var r=this.options,t=r.undefinedReplacement,c=r.stringifyReplacer,a=c===void 0?function(e,n){return typeof n>"u"?t:n}:c;return typeof j=="string"?j:JSON.stringify(Bt(j,null,null,a),a,"  ")};vt.equals=function(j,r){return yt.prototype.equals.call(vt,j.replace(/,([\r\n])/g,"$1"),r.replace(/,([\r\n])/g,"$1"))};function Bt(j,r,t,c,a){r=r||[],t=t||[],c&&(j=c(a,j));var e;for(e=0;e<r.length;e+=1)if(r[e]===j)return t[e];var n;if(ne.call(j)==="[object Array]"){for(r.push(j),n=new Array(j.length),t.push(n),e=0;e<j.length;e+=1)n[e]=Bt(j[e],r,t,c,a);return r.pop(),t.pop(),n}if(j&&j.toJSON&&(j=j.toJSON()),St(j)==="object"&&j!==null){r.push(j),n={},t.push(n);var i=[],o;for(o in j)j.hasOwnProperty(o)&&i.push(o);for(i.sort(),e=0;e<i.length;e+=1)o=i[e],n[o]=Bt(j[o],r,t,c,o);r.pop(),t.pop()}else n=j;return n}var Rt=new yt;Rt.tokenize=function(j){return j.slice()};Rt.join=Rt.removeEmpty=function(j){return j};const At={CHANGE_DENSITY_THRESHOLD:.6,MIN_CHANGED_WORDS:3,MAX_UNCHANGED_GAP:1};class re{constructor(){tt(this,"debugMode",!1)}setDebugMode(r){this.debugMode=r}isDebugMode(){return this.debugMode}diffDocuments(r,t){return this.diffDocumentsWithDebug(r,t).diff}diffDocumentsWithDebug(r,t){const{alignment:c,decisions:a}=this.alignBlocks(r.blocks,t.blocks),e=[];let n=0;return c.forEach(([o,d])=>{if(!o&&d)e.push({type:"insert",currentBlock:d,changeId:`change-${n++}`});else if(o&&!d)e.push({type:"delete",originalBlock:o,changeId:`change-${n++}`});else if(o&&d)if(o.text===d.text&&this.formatingsEqual(o.formatting,d.formatting))e.push({type:"unchanged",originalBlock:o,currentBlock:d});else{const w=Qt(o.text,d.text),m=this.groupConsecutiveChanges(w),v=this.diffFormatting(o,d,w),u=w.some(g=>g.added||g.removed)||v.some(g=>g.type==="format-change");e.push({type:u?"modify":"unchanged",originalBlock:o,currentBlock:d,wordDiff:w,groupedDiff:m,formatDiff:v,changeId:u?`change-${n++}`:void 0})}}),{diff:{blockDiffs:e,totalChanges:n,sectionProperties:t.sectionProperties},alignmentDecisions:a}}alignBlocks(r,t){const c=[],a=[],e=u=>u.trim().replace(/\s+/g," "),n=u=>e(u.text),i=u=>u.substring(0,100),o=(u,g)=>{const h=e(u.text),f=e(g.text);if(h===f)return 1;if(!h||!f)return 0;const p=h.split(/\s+/),b=f.split(/\s+/),k=new Set(p),C=new Set(b);let E=0;return k.forEach(F=>{C.has(F)&&E++}),2*E/(k.size+C.size)},d=new Map;t.forEach(u=>{const g=n(u);d.has(g)||d.set(g,[]),d.get(g).push(u)});const w=new Set,m=[];r.forEach((u,g)=>{const h=n(u),f=d.get(h)||[];let p=!1;for(let b=0;b<f.length;b++){const k=t.indexOf(f[b]);if(!w.has(k)){c.push([u,f[b]]),w.add(k),p=!0,a.push({originalIndex:g,currentIndex:k,matchType:"exact",similarityScore:1,reason:"Exact text match after whitespace normalization",originalPreview:i(u.text),currentPreview:i(f[b].text)});break}}p||m.push({block:u,index:g})});const v=.5;return m.forEach(({block:u,index:g})=>{let h=null;if(t.forEach((f,p)=>{if(w.has(p))return;const b=o(u,f);b>=v&&(!h||b>h.similarity)&&(h={block:f,index:p,similarity:b})}),h){const f=h;c.push([u,f.block]),w.add(f.index),a.push({originalIndex:g,currentIndex:f.index,matchType:"fuzzy",similarityScore:f.similarity,reason:`Fuzzy match: ${(f.similarity*100).toFixed(1)}% word overlap (threshold: ${v*100}%)`,originalPreview:i(u.text),currentPreview:i(f.block.text)})}else{c.push([u,null]);let f=0,p=null;t.forEach((k,C)=>{if(w.has(C))return;const E=o(u,k);E>f&&(f=E,p=C)});const b=p!==null?`No match found. Best candidate had ${(f*100).toFixed(1)}% similarity (below ${v*100}% threshold)`:"No match found. No unmatched candidates remaining";a.push({originalIndex:g,currentIndex:null,matchType:"delete",similarityScore:f>0?f:void 0,reason:b,originalPreview:i(u.text)})}}),t.forEach((u,g)=>{w.has(g)||(c.push([null,u]),a.push({originalIndex:null,currentIndex:g,matchType:"insert",reason:"No matching block in original document",currentPreview:i(u.text)}))}),c.sort((u,g)=>{const h=u[0]?r.indexOf(u[0]):1/0,f=g[0]?r.indexOf(g[0]):1/0;if(h!==f)return h-f;const p=u[1]?t.indexOf(u[1]):1/0,b=g[1]?t.indexOf(g[1]):1/0;return p-b}),{alignment:c,decisions:a}}diffFormatting(r,t,c){const a=[];return c.forEach(e=>{if(e.added)a.push({type:"insert",text:e.value,formatting:t.formatting});else if(e.removed)a.push({type:"delete",text:e.value,formatting:r.formatting});else{const n=this.compareFormatting(r.formatting,t.formatting);n.changed?a.push({type:"format-change",text:e.value,from:r.formatting,to:t.formatting,changes:n.changes}):a.push({type:"unchanged",text:e.value,formatting:r.formatting})}}),a}compareFormatting(r,t){const c={};let a=!1;return["bold","italic","underline","color","font","fontSize"].forEach(n=>{r[n]!==t[n]&&(c[n]={from:r[n],to:t[n]},a=!0)}),{changed:a,changes:c}}formatingsEqual(r,t){return r.bold===t.bold&&r.italic===t.italic&&r.underline===t.underline&&r.color===t.color&&r.font===t.font&&r.fontSize===t.fontSize}groupConsecutiveChanges(r){const t=[];let c=0;for(;c<r.length;){const a=r[c];if(!a.added&&!a.removed){t.push(a),c++;continue}const e=this.findChangeSpan(r,c);if(this.shouldGroup(e)){const n=[],i=[];for(let d=e.start;d<e.end;d++){const w=r[d];w.removed?n.push(w.value):(w.added||n.push(w.value),i.push(w.value))}const o={type:"phrase-replace",deletedText:n.join("").trim(),insertedText:i.join("").trim()};t.push(o),c=e.end}else t.push(a),c++}return t}findChangeSpan(r,t){let c=t,a=0;for(;c<r.length;){const e=r[c];if(e.added||e.removed)a=0,c++;else{const n=e.value.trim().split(/\s+/).filter(i=>i.length>0);if(a+=n.length,a>At.MAX_UNCHANGED_GAP)break;c++}}return{start:t,end:c,changes:r.slice(t,c)}}shouldGroup(r){let t=0,c=0;for(const e of r.changes){const n=e.value.trim().split(/\s+/).filter(i=>i.length>0).length;t+=n,(e.added||e.removed)&&(c+=n)}return(t>0?c/t:0)>=At.CHANGE_DENSITY_THRESHOLD&&c>=At.MIN_CHANGED_WORDS}}class ie{constructor(r){tt(this,"redlinedPane");tt(this,"changeElements",[]);const t=document.getElementById(r);if(!t)throw new Error("Redlined pane not found");this.redlinedPane=t}renderRedlined(r){this.changeElements=[];const t=[];r.blockDiffs.forEach(c=>{t.push(this.renderRedlinedBlock(c))}),this.applyColumnStyling(this.redlinedPane,r.sectionProperties),this.redlinedPane.innerHTML=t.join(""),this.collectChangeElements()}applyColumnStyling(r,t){if(t?.columnCount&&t.columnCount>1){const c=t.columnSpace?Math.round(t.columnSpace/1440*96):24;r.style.columnCount=String(t.columnCount),r.style.columnGap=`${c}px`}else r.style.columnCount="",r.style.columnGap=""}renderRedlinedBlock(r){const t=r.changeId?` data-change-id="${r.changeId}"`:"";switch(r.type){case"insert":return this.renderBlock(r.currentBlock,"inserted",t);case"delete":return this.renderBlock(r.originalBlock,"deleted",t);case"modify":return this.renderRedlinedModifiedBlock(r,t);case"unchanged":return this.renderBlock(r.currentBlock,"unchanged","");default:return""}}renderBlock(r,t,c){if(r.type==="page-break")return`<div class="block block-page-break ${t==="inserted"?"block-inserted":t==="deleted"?"block-deleted":"block-unchanged"}"${c}>
        <div class="page-break-indicator">
          <span> Page Break </span>
        </div>
      </div>`;const a=t==="inserted"?"block-inserted":t==="deleted"?"block-deleted":"block-unchanged",e=`para-${r.type}`;let n="";return r.runs&&r.runs.length>0?n=r.runs.map(i=>this.renderFormattedText(i.text,i.formatting)).join(""):n=this.escapeHtml(r.text),`<div class="block ${a} ${e}"${c}>${n}</div>`}renderRedlinedModifiedBlock(r,t){const c=r.groupedDiff||r.wordDiff;if(!c)return this.renderBlock(r.currentBlock,"unchanged",t);const a=r.currentBlock,e=r.originalBlock;let i=`<div class="block block-modified ${`para-${a.type}`}"${t}>`;for(const o of c)if(this.isPhraseReplacement(o)){const d=this.renderFormattedText(o.deletedText,e.formatting),w=this.renderFormattedText(o.insertedText,a.formatting);i+=`<span class="diff-delete">${d}</span>`,i+=`<span class="diff-insert">${w}</span>`}else if(o.removed){const d=this.renderFormattedText(o.value,e.formatting);i+=`<span class="diff-delete">${d}</span>`}else if(o.added){const d=this.renderFormattedText(o.value,a.formatting);i+=`<span class="diff-insert">${d}</span>`}else i+=this.renderFormattedText(o.value,a.formatting);return i+="</div>",i}isPhraseReplacement(r){return"type"in r&&r.type==="phrase-replace"}renderFormattedText(r,t){let c=this.escapeHtml(r);t.bold&&(c=`<strong>${c}</strong>`),t.italic&&(c=`<em>${c}</em>`),t.underline&&(c=`<u>${c}</u>`);const a=[];return t.color&&a.push(`color: ${t.color}`),t.font&&a.push(`font-family: ${t.font}`),t.fontSize&&a.push(`font-size: ${t.fontSize}pt`),a.length>0&&(c=`<span style="${a.join("; ")}">${c}</span>`),c}escapeHtml(r){const t=document.createElement("div");return t.textContent=r,t.innerHTML}collectChangeElements(){this.changeElements=Array.from(this.redlinedPane.querySelectorAll("[data-change-id]"))}getChangeElements(){return this.changeElements}}class se{constructor(r,t,c,a){tt(this,"changeElements");tt(this,"currentIndex",-1);tt(this,"prevButton");tt(this,"nextButton");tt(this,"counterElement");this.changeElements=r;const e=document.getElementById(t),n=document.getElementById(c),i=document.getElementById(a);if(!e||!n||!i)throw new Error("Navigation elements not found");this.prevButton=e,this.nextButton=n,this.counterElement=i,this.setupListeners(),this.updateUI()}setupListeners(){this.prevButton.addEventListener("click",()=>this.goToPrevious()),this.nextButton.addEventListener("click",()=>this.goToNext()),document.addEventListener("keydown",r=>{r.key==="n"&&!this.isInputFocused()?(r.preventDefault(),this.goToNext()):r.key==="p"&&!this.isInputFocused()&&(r.preventDefault(),this.goToPrevious())})}isInputFocused(){const r=document.activeElement;return r instanceof HTMLInputElement||r instanceof HTMLTextAreaElement}goToNext(){this.currentIndex<this.changeElements.length-1?this.navigateToIndex(this.currentIndex+1):this.changeElements.length>0&&this.navigateToIndex(0)}goToPrevious(){this.currentIndex>0?this.navigateToIndex(this.currentIndex-1):this.changeElements.length>0&&this.navigateToIndex(this.changeElements.length-1)}navigateToIndex(r){this.currentIndex>=0&&this.currentIndex<this.changeElements.length&&this.changeElements[this.currentIndex].classList.remove("change-highlight"),this.currentIndex=r;const t=this.changeElements[this.currentIndex];t.classList.add("change-highlight"),t.scrollIntoView({behavior:"smooth",block:"center"}),this.updateUI()}updateUI(){const r=this.changeElements.length;if(r===0)this.counterElement.textContent="No changes",this.prevButton.disabled=!0,this.nextButton.disabled=!0;else{const t=this.currentIndex+1;this.counterElement.textContent=`${t} of ${r} changes`,this.prevButton.disabled=!1,this.nextButton.disabled=!1}}reset(){this.changeElements.forEach(r=>r.classList.remove("change-highlight")),this.currentIndex=-1,this.updateUI()}updateChangeElements(r){this.changeElements=r,this.reset(),r.length>0?this.navigateToIndex(0):this.updateUI()}}const st={w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},Ut={includeComments:!0,includeInlineFormatting:!0};class ae{constructor(){tt(this,"zip",null);tt(this,"documentXml",null);tt(this,"comments",[]);tt(this,"nextCommentId",0);tt(this,"nextRevisionId",0);tt(this,"author","Document Comparison");tt(this,"date",new Date().toISOString());tt(this,"options",Ut)}async export(r,t,c,a={}){this.options={...Ut,...a},this.zip=await Tt.loadAsync(t);const e=await this.zip.file("word/document.xml")?.async("string");if(!e)throw new Error("Invalid DOCX: missing word/document.xml");const n=new DOMParser;this.documentXml=n.parseFromString(e,"application/xml"),this.comments=[],this.nextCommentId=0,this.nextRevisionId=0,this.date=new Date().toISOString();const i=Array.from(this.documentXml.getElementsByTagName("w:p")),o=Array.from(this.documentXml.getElementsByTagName("w:tr"));this.processBlockDiffs(r.blockDiffs,i,o);const w=new XMLSerializer().serializeToString(this.documentXml);this.zip.file("word/document.xml",w),this.comments.length>0&&await this.addCommentsToZip();const m=await this.zip.generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});this.downloadBlob(m,`${this.getBaseName(c)}_redlined.docx`)}processBlockDiffs(r,t,c){const a=new Set,e=new Set,n=new Map,i=new Map;for(const o of r){if(o.type==="delete")continue;const d=o.currentBlock;if(!d||d.type==="page-break")continue;if(d.type==="table-row"){const m=this.matchBlockToTableRow(d,c,e);m&&(e.add(m),i.set(o,m));continue}const w=this.matchBlockToParagraph(d,t,a);w&&(a.add(w),n.set(o,w))}for(let o=0;o<r.length;o++){const d=r[o];if(d.type==="unchanged")continue;if(d.type==="delete"){const v=d.originalBlock;if(!v||v.type==="page-break")continue;if(v.type==="table-row"){this.insertDeletedTableRow(v,r,i);continue}let u=null;for(let h=o+1;h<r.length;h++){const f=r[h];if(f.type!=="delete"&&(u=n.get(f)||null,u))break}let g=!1;if(o+1<r.length){const h=r[o+1];if(h.type==="delete"){const f=h.originalBlock;f&&f.type!=="page-break"&&f.type!=="table-row"&&(g=!0)}}this.insertDeletedParagraph(v,u,g);continue}const w=d.currentBlock;if(w.type==="table-row"){const v=i.get(d);if(v)switch(d.type){case"insert":this.markTableRowAsInserted(v,w);break;case"modify":this.applyTableRowChanges(v,d);break}continue}const m=n.get(d);if(m)switch(d.type){case"insert":this.markParagraphAsInserted(m,w);break;case"modify":this.applyWordLevelChanges(m,d);break}}}matchBlockToParagraph(r,t,c){const a=this.normalizeText(r.text);for(const e of t){if(c.has(e))continue;if(this.normalizeText(this.getParagraphText(e))===a)return e}for(const e of t){if(c.has(e))continue;const n=this.normalizeText(this.getParagraphText(e));if(n.length>0&&a.length>0){if(n.includes(a)||a.includes(n))return e;const i=Math.min(n.length,a.length,30);if(i>10&&n.substring(0,i)===a.substring(0,i))return e}}return null}matchBlockToTableRow(r,t,c){const a=this.normalizeText(r.text);for(const e of t){if(c.has(e))continue;if(this.normalizeText(this.getTableRowText(e))===a)return e}for(const e of t){if(c.has(e))continue;const n=this.normalizeText(this.getTableRowText(e));if(n.length>0&&a.length>0){if(n.includes(a)||a.includes(n))return e;const i=Math.min(n.length,a.length,30);if(i>10&&n.substring(0,i)===a.substring(0,i))return e}}return null}getTableRowText(r){const t=r.getElementsByTagName("w:tc"),c=[];for(let a=0;a<t.length;a++){const e=t[a].getElementsByTagName("w:t");let n="";for(let i=0;i<e.length;i++)n+=e[i].textContent||"";c.push(n.trim())}return c.join(" | ")}markTableRowAsInserted(r,t){const c=this.addComment("Added: New table row"),a=r.getElementsByTagName("w:tc");if(a.length!==0){if(c>=0){const n=a[0].getElementsByTagName("w:p")[0];if(n){const i=n.getElementsByTagName("w:r");if(i.length>0){const o=this.createCommentRangeStart(c);i[0].parentNode?.insertBefore(o,i[0])}}}for(let e=0;e<a.length;e++){const i=a[e].getElementsByTagName("w:r");for(let o=0;o<i.length;o++)this.applyInsertionFormatting(i[o])}if(c>=0){const n=a[a.length-1].getElementsByTagName("w:p")[0];if(n){const i=n.getElementsByTagName("w:r");if(i.length>0){const o=i[i.length-1],d=this.createCommentRangeEnd(c),w=this.createCommentReference(c);o.parentNode?.insertBefore(d,o.nextSibling),d.parentNode?.insertBefore(w,d.nextSibling)}}}}}insertDeletedTableRow(r,t,c){const a=r.tableId;let e=null,n=null,i;if(a!==void 0)for(const[d,w]of c){const m=d.currentBlock;m?.tableId===a&&(e=w.parentNode,m.rowIndex!==void 0&&r.rowIndex!==void 0&&m.rowIndex>r.rowIndex&&(i===void 0||m.rowIndex<i)&&(n=w,i=m.rowIndex))}const o=this.createDeletedTableRowElement(r);e?n?e.insertBefore(o,n):e.appendChild(o):this.insertStandaloneDeletedTable(r)}createDeletedTableRowElement(r){const t=this.addComment("Removed: Deleted table row"),c=r.text.split("|").map(e=>e.trim()),a=this.documentXml.createElementNS(st.w,"w:tr");for(let e=0;e<c.length;e++){const n=c[e],i=this.createDeletedTableCell(n,e===0?t:-1,e===c.length-1?t:-1);a.appendChild(i)}return a}insertStandaloneDeletedTable(r){const t=this.documentXml?.getElementsByTagName("w:body")[0];if(!t)return;const c=this.addComment("Removed: Deleted table row"),a=r.text.split("|").map(m=>m.trim()),e=this.documentXml.createElementNS(st.w,"w:tbl"),n=this.documentXml.createElementNS(st.w,"w:tblPr"),i=this.createTableBorders();n.appendChild(i);const o=this.documentXml.createElementNS(st.w,"w:tblW");o.setAttribute("w:w","0"),o.setAttribute("w:type","auto"),n.appendChild(o),e.appendChild(n);const d=this.documentXml.createElementNS(st.w,"w:tr");for(let m=0;m<a.length;m++){const v=a[m],u=this.createDeletedTableCell(v,m===0?c:-1,m===a.length-1?c:-1);d.appendChild(u)}e.appendChild(d);const w=t.getElementsByTagName("w:sectPr")[0];w&&w.parentNode===t?t.insertBefore(e,w):t.appendChild(e)}createTableBorders(){const r=this.documentXml.createElementNS(st.w,"w:tblBorders"),t=["top","left","bottom","right","insideH","insideV"];for(const c of t){const a=this.documentXml.createElementNS(st.w,`w:${c}`);a.setAttribute("w:val","single"),a.setAttribute("w:sz","4"),a.setAttribute("w:space","0"),a.setAttribute("w:color","auto"),r.appendChild(a)}return r}createDeletedTableCell(r,t,c){const a=this.documentXml.createElementNS(st.w,"w:tc"),e=this.documentXml.createElementNS(st.w,"w:tcPr"),n=this.documentXml.createElementNS(st.w,"w:tcW");n.setAttribute("w:w","0"),n.setAttribute("w:type","auto"),e.appendChild(n),a.appendChild(e);const i=this.documentXml.createElementNS(st.w,"w:p");t>=0&&i.appendChild(this.createCommentRangeStart(t));const o=this.createDelElement(),d=this.createRunWithText(r,!0);return o.appendChild(d),i.appendChild(o),c>=0&&(i.appendChild(this.createCommentRangeEnd(c)),i.appendChild(this.createCommentReference(c))),a.appendChild(i),a}applyTableRowChanges(r,t){const c=t.groupedDiff||t.wordDiff;if(!c||c.length===0)return;const a=r.getElementsByTagName("w:tc");if(a.length===0)return;const n=a[0].getElementsByTagName("w:p")[0];if(n){const i=n.getElementsByTagName("w:pPr")[0];for(;n.firstChild;)n.removeChild(n.firstChild);i&&n.appendChild(i);for(const o of c)if(this.isPhraseReplacement(o)){const d=this.addComment(`Replaced in table: "${o.deletedText}"  "${o.insertedText}"`);d>=0&&n.appendChild(this.createCommentRangeStart(d));const w=this.createDelElement(),m=this.createRunWithText(o.deletedText+" ",!0);w.appendChild(m),n.appendChild(w);const v=this.createRunWithText(o.insertedText+" ",!1,!0);n.appendChild(v),d>=0&&(n.appendChild(this.createCommentRangeEnd(d)),n.appendChild(this.createCommentReference(d)))}else if(o.added){const d=this.addComment(`Added in table: "${o.value.trim()}"`);d>=0&&n.appendChild(this.createCommentRangeStart(d));const w=this.createRunWithText(o.value,!1,!0);n.appendChild(w),d>=0&&(n.appendChild(this.createCommentRangeEnd(d)),n.appendChild(this.createCommentReference(d)))}else if(o.removed){const d=this.addComment(`Removed from table: "${o.value.trim()}"`);d>=0&&n.appendChild(this.createCommentRangeStart(d));const w=this.createDelElement(),m=this.createRunWithText(o.value,!0);w.appendChild(m),n.appendChild(w),d>=0&&(n.appendChild(this.createCommentRangeEnd(d)),n.appendChild(this.createCommentReference(d)))}else{const d=this.createRunWithText(o.value,!1,!1);n.appendChild(d)}}}getParagraphText(r){const t=r.getElementsByTagName("w:t");let c="";for(let a=0;a<t.length;a++)c+=t[a].textContent||"";return c}normalizeText(r){return r.trim().replace(/\s+/g," ").toLowerCase()}markParagraphAsInserted(r,t){const c=this.addComment(`Added: New ${t.type}`),a=Array.from(r.getElementsByTagName("w:r"));if(a.length===0)return;const e=a[0];if(c>=0){const n=this.createCommentRangeStart(c);e.parentNode?.insertBefore(n,e)}for(const n of a)this.applyInsertionFormatting(n);if(c>=0){const n=a[a.length-1],i=this.createCommentRangeEnd(c),o=this.createCommentReference(c);n.parentNode?.insertBefore(i,n.nextSibling),i.parentNode?.insertBefore(o,i.nextSibling)}}insertDeletedParagraph(r,t,c=!1){const a=this.documentXml?.getElementsByTagName("w:body")[0];if(!a)return;const e=this.addComment(`Removed: Deleted ${r.type}`),n=this.documentXml.createElementNS(st.w,"w:p"),i=this.documentXml.createElementNS(st.w,"w:pPr"),o=this.documentXml.createElementNS(st.w,"w:keepLines");if(i.appendChild(o),c){const m=this.documentXml.createElementNS(st.w,"w:keepNext");i.appendChild(m)}n.appendChild(i),e>=0&&n.appendChild(this.createCommentRangeStart(e));const d=this.createDelElement(),w=this.createRunWithText(r.text,!0);if(d.appendChild(w),n.appendChild(d),e>=0&&(n.appendChild(this.createCommentRangeEnd(e)),n.appendChild(this.createCommentReference(e))),t)t.parentNode?.insertBefore(n,t);else{const m=a.getElementsByTagName("w:sectPr")[0];m&&m.parentNode===a?a.insertBefore(n,m):a.appendChild(n)}}applyWordLevelChanges(r,t){const c=t.groupedDiff||t.wordDiff;if(!c||c.length===0)return;const a=r.getElementsByTagName("w:pPr")[0];for(;r.firstChild;)r.removeChild(r.firstChild);a&&r.appendChild(a);for(const e of c)if(this.isPhraseReplacement(e)){const n=this.addComment(`Replaced: "${e.deletedText}"  "${e.insertedText}"`);n>=0&&r.appendChild(this.createCommentRangeStart(n));const i=this.createDelElement(),o=this.createRunWithText(e.deletedText+" ",!0);i.appendChild(o),r.appendChild(i);const d=this.createRunWithText(e.insertedText+" ",!1,!0);r.appendChild(d),n>=0&&(r.appendChild(this.createCommentRangeEnd(n)),r.appendChild(this.createCommentReference(n)))}else if(e.added){const n=this.addComment(`Added: "${e.value.trim()}"`);n>=0&&r.appendChild(this.createCommentRangeStart(n));const i=this.createRunWithText(e.value,!1,!0);r.appendChild(i),n>=0&&(r.appendChild(this.createCommentRangeEnd(n)),r.appendChild(this.createCommentReference(n)))}else if(e.removed){const n=this.addComment(`Removed: "${e.value.trim()}"`);n>=0&&r.appendChild(this.createCommentRangeStart(n));const i=this.createDelElement(),o=this.createRunWithText(e.value,!0);i.appendChild(o),r.appendChild(i),n>=0&&(r.appendChild(this.createCommentRangeEnd(n)),r.appendChild(this.createCommentReference(n)))}else{const n=this.createRunWithText(e.value,!1,!1);r.appendChild(n)}}isPhraseReplacement(r){return"type"in r&&r.type==="phrase-replace"}createDelElement(){const r=this.documentXml.createElementNS(st.w,"w:del");return r.setAttribute("w:id",String(this.nextRevisionId++)),r.setAttribute("w:author",this.author),r.setAttribute("w:date",this.date),r}createRunWithText(r,t,c=!1){const a=this.documentXml.createElementNS(st.w,"w:r"),e=this.documentXml.createElementNS(st.w,"w:rPr");let n=!1;if(this.options.includeInlineFormatting){if(t){const o=this.documentXml.createElementNS(st.w,"w:color");o.setAttribute("w:val","FF0000"),e.appendChild(o);const d=this.documentXml.createElementNS(st.w,"w:strike");e.appendChild(d),n=!0}else if(c){const o=this.documentXml.createElementNS(st.w,"w:highlight");o.setAttribute("w:val","yellow"),e.appendChild(o),n=!0}}n&&a.appendChild(e);const i=this.documentXml.createElementNS(st.w,t?"w:delText":"w:t");return i.setAttribute("xml:space","preserve"),i.textContent=r,a.appendChild(i),a}applyInsertionFormatting(r){if(!this.options.includeInlineFormatting)return;let t=r.getElementsByTagName("w:rPr")[0];t||(t=this.documentXml.createElementNS(st.w,"w:rPr"),r.insertBefore(t,r.firstChild));let c=t.getElementsByTagName("w:highlight")[0];c||(c=this.documentXml.createElementNS(st.w,"w:highlight"),t.appendChild(c)),c.setAttribute("w:val","yellow")}createCommentRangeStart(r){const t=this.documentXml.createElementNS(st.w,"w:commentRangeStart");return t.setAttribute("w:id",String(r)),t}createCommentRangeEnd(r){const t=this.documentXml.createElementNS(st.w,"w:commentRangeEnd");return t.setAttribute("w:id",String(r)),t}createCommentReference(r){const t=this.documentXml.createElementNS(st.w,"w:r"),c=this.documentXml.createElementNS(st.w,"w:commentReference");return c.setAttribute("w:id",String(r)),t.appendChild(c),t}addComment(r){if(!this.options.includeComments)return-1;const t=this.nextCommentId++;return this.comments.push({id:t,text:r}),t}async addCommentsToZip(){const r=this.buildCommentsXml();this.zip.file("word/comments.xml",r),await this.updateRelationships(),await this.updateContentTypes()}buildCommentsXml(){return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:comments xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main"
            xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"
            xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006">
${this.comments.map(t=>`
    <w:comment w:id="${t.id}" w:author="${this.author}" w:date="${this.date}">
      <w:p>
        <w:r>
          <w:t>${this.escapeXml(t.text)}</w:t>
        </w:r>
      </w:p>
    </w:comment>`).join("")}
</w:comments>`}async updateRelationships(){const r="word/_rels/document.xml.rels";let t=await this.zip.file(r)?.async("string");if(t||(t=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
</Relationships>`),t.includes("comments.xml"))return;const c=t.match(/rId(\d+)/g)||[];let a=0;for(const i of c){const o=parseInt(i.replace("rId",""),10);o>a&&(a=o)}const n=`<Relationship Id="${`rId${a+1}`}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments" Target="comments.xml"/>`;t=t.replace("</Relationships>",`  ${n}
</Relationships>`),this.zip.file(r,t)}async updateContentTypes(){const r="[Content_Types].xml";let t=await this.zip.file(r)?.async("string");if(!t||t.includes("/word/comments.xml"))return;t=t.replace("</Types>",`  <Override PartName="/word/comments.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml"/>
</Types>`),this.zip.file(r,t)}escapeXml(r){return r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}downloadBlob(r,t){const c=URL.createObjectURL(r),a=document.createElement("a");a.href=c,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(c)}getBaseName(r){return r.replace(/\.(docx?|DOCX?)$/,"")}}class oe{generateReport(r,t,c,a,e,n){return{timestamp:new Date().toISOString(),originalFile:e,currentFile:n,parsing:this.generateParsingDebug(r,t),alignment:this.generateAlignmentDebug(a),diffs:this.generateDiffDebug(c)}}generateParsingDebug(r,t){return{original:{blockCount:r.blocks.length,blocks:r.blocks.map((c,a)=>this.blockToDebug(c,a))},current:{blockCount:t.blocks.length,blocks:t.blocks.map((c,a)=>this.blockToDebug(c,a))}}}blockToDebug(r,t){const c=r.text.trim()?r.text.trim().split(/\s+/).length:0,a=!!(r.formatting.bold||r.formatting.italic||r.formatting.underline||r.formatting.color||r.formatting.font||r.formatting.fontSize);return{index:t,type:r.type,textPreview:r.text.substring(0,100),textLength:r.text.length,wordCount:c,hasFormatting:a}}generateAlignmentDebug(r){let t=0,c=0,a=0,e=0;for(const n of r)switch(n.matchType){case"exact":t++;break;case"fuzzy":c++;break;case"delete":a++;break;case"insert":e++;break}return{exactMatches:t,fuzzyMatches:c,deletions:a,insertions:e,decisions:r}}generateDiffDebug(r){return r.blockDiffs.map(t=>this.blockDiffToDebug(t))}blockDiffToDebug(r){const t={type:r.type,changeId:r.changeId};if(r.originalBlock&&(t.originalText=r.originalBlock.text),r.currentBlock&&(t.currentText=r.currentBlock.text),r.wordDiff){let c=0,a=0,e=0;for(const n of r.wordDiff){const i=n.value.trim()?n.value.trim().split(/\s+/).length:0;n.added?c+=i:n.removed?a+=i:e+=i}t.wordDiffSummary={addedWords:c,removedWords:a,unchangedWords:e}}return t}exportToFile(r){const t=JSON.stringify(r,null,2),c=new Blob([t],{type:"application/json"}),a=URL.createObjectURL(c),e=document.createElement("a");e.href=a,e.download=`debug-report-${new Date().toISOString().replace(/[:.]/g,"-")}.json`,document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(a)}}class le{constructor(){tt(this,"fileUpload");tt(this,"parser");tt(this,"diffEngine");tt(this,"renderer",null);tt(this,"navigator",null);tt(this,"docxInPlaceExporter");tt(this,"debugExporter");tt(this,"originalFileName","");tt(this,"currentFileName","");tt(this,"debugMode",!1);tt(this,"currentDiff",null);tt(this,"originalAST",null);tt(this,"currentAST",null);tt(this,"alignmentDecisions",[]);tt(this,"currentFileBuffer",null);tt(this,"compareButton",null);tt(this,"settingsToggle",null);tt(this,"settingsFlyout",null);this.fileUpload=new Ht,this.parser=new Kt,this.diffEngine=new re,this.docxInPlaceExporter=new ae,this.debugExporter=new oe,this.debugMode=this.checkDebugMode(),this.diffEngine.setDebugMode(this.debugMode),this.fileUpload.onFileChange((r,t)=>{this.updateCompareButtonState(r&&t)}),this.setupCompareButton(),this.setupDocxExportButton(),this.setupDebugExportButton(),this.setupSettingsToggle()}checkDebugMode(){return new URLSearchParams(window.location.search).get("debug")==="true"}setupCompareButton(){this.compareButton=document.getElementById("compare-btn"),this.compareButton&&this.compareButton.addEventListener("click",()=>this.handleCompareClick())}updateCompareButtonState(r){this.compareButton&&(this.compareButton.disabled=!r)}async handleCompareClick(){const r=this.fileUpload.getFiles();if(!r){alert("Please select both original and current documents.");return}this.setCompareButtonLoading(!0);try{this.originalFileName=r.original.name,this.currentFileName=r.current.name,await this.compareDocuments(r.original,r.current)}finally{this.setCompareButtonLoading(!1)}}setCompareButtonLoading(r){this.compareButton&&(r?(this.compareButton.classList.add("comparing"),this.compareButton.innerHTML='<span class="spinner"></span>Comparing...',this.compareButton.disabled=!0):(this.compareButton.classList.remove("comparing"),this.compareButton.textContent="Compare",this.compareButton.disabled=!this.fileUpload.areBothFilesReady()))}async compareDocuments(r,t){try{this.showProgress("Parsing documents..."),this.currentFileBuffer=await t.arrayBuffer();const[c,a]=await Promise.all([this.parser.parseFile(r),this.parser.parseFile(t)]);this.updateProgress(50,"Comparing documents...");const e=this.diffEngine.diffDocumentsWithDebug(c,a);this.currentDiff=e.diff,this.originalAST=c,this.currentAST=a,this.alignmentDecisions=e.alignmentDecisions,this.updateProgress(75,"Rendering comparison..."),this.renderComparison(e.diff),this.updateProgress(100,"Complete!"),setTimeout(()=>{this.hideProgress(),this.showComparison()},500)}catch(c){console.error("Error comparing documents:",c),alert("Error comparing documents: "+(c instanceof Error?c.message:"Unknown error")),this.hideProgress()}}renderComparison(r){this.renderer||(this.renderer=new ie("pane-redlined-content")),this.renderer.renderRedlined(r);const t=this.renderer.getChangeElements();this.navigator?this.navigator.updateChangeElements(t):this.navigator=new se(t,"prev-change","next-change","change-counter")}showProgress(r){const t=document.getElementById("progress");t&&(t.style.display="block"),this.updateProgress(0,r)}updateProgress(r,t){const c=document.getElementById("progress-fill"),a=document.getElementById("progress-text");c&&(c.style.width=r+"%"),a&&(a.textContent=t)}hideProgress(){const r=document.getElementById("progress");r&&(r.style.display="none")}showComparison(){const r=document.getElementById("comparison"),t=document.getElementById("controls");r&&(r.style.display="flex"),t&&(t.style.display="flex")}setupDocxExportButton(){const r=document.getElementById("export-docx");r&&r.addEventListener("click",()=>this.exportDocx())}setupDebugExportButton(){const r=document.getElementById("export-debug");r&&r.addEventListener("click",()=>this.exportDebugReport())}setupSettingsToggle(){this.settingsToggle=document.getElementById("settings-toggle"),this.settingsFlyout=document.getElementById("settings-flyout"),this.settingsToggle&&this.settingsFlyout&&(this.settingsToggle.addEventListener("click",r=>{r.stopPropagation();const t=this.settingsFlyout.style.display!=="none";this.settingsFlyout.style.display=t?"none":"block"}),document.addEventListener("click",r=>{this.settingsFlyout&&this.settingsToggle&&!this.settingsFlyout.contains(r.target)&&!this.settingsToggle.contains(r.target)&&(this.settingsFlyout.style.display="none")}),this.settingsFlyout.addEventListener("click",r=>{r.stopPropagation()}))}getExportOptions(){const r=document.getElementById("setting-comments"),t=document.getElementById("setting-inline");return{includeComments:r?.checked??!0,includeInlineFormatting:t?.checked??!0}}async exportDocx(){const r=document.getElementById("export-docx");if(!this.currentDiff){alert("Please compare documents first before exporting.");return}if(!this.currentFileBuffer){alert("Current file buffer not available. Please try comparing documents again.");return}this.setButtonLoading(r,!0,"Exporting...");try{await new Promise(c=>setTimeout(c,10));const t=this.getExportOptions();await this.docxInPlaceExporter.export(this.currentDiff,this.currentFileBuffer,this.originalFileName,t)}catch(t){console.error("DOCX export failed:",t),alert("Failed to export DOCX. Please try again.")}finally{this.setButtonLoading(r,!1,"Export Redlined Docx")}}exportDebugReport(){if(!this.currentDiff||!this.originalAST||!this.currentAST){alert("Please compare documents first before exporting debug report.");return}const r=this.debugExporter.generateReport(this.originalAST,this.currentAST,this.currentDiff,this.alignmentDecisions,this.originalFileName,this.currentFileName);this.debugExporter.exportToFile(r)}setButtonLoading(r,t,c){r&&(t?(r.classList.add("exporting"),r.innerHTML=`<span class="spinner"></span>${c}`):(r.classList.remove("exporting"),r.textContent=c))}}new le;
