var Mt=Object.defineProperty;var Zt=(j,i,t)=>i in j?Mt(j,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):j[i]=t;var et=(j,i,t)=>Zt(j,typeof i!="symbol"?i+"":i,t);(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))f(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&f(n)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function f(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();class $t{constructor(){et(this,"originalFile",null);et(this,"currentFile",null);et(this,"onBothFilesReady",null);this.initializeUploadHandlers()}initializeUploadHandlers(){const i=document.getElementById("original-upload"),t=document.getElementById("current-upload"),f=i.parentElement?.querySelector(".upload-label"),o=t.parentElement?.querySelector(".upload-label");i.addEventListener("change",r=>{const n=r.target.files?.[0];n&&this.handleOriginalFile(n)}),t.addEventListener("change",r=>{const n=r.target.files?.[0];n&&this.handleCurrentFile(n)}),f&&this.setupDragAndDrop(f,r=>this.handleOriginalFile(r)),o&&this.setupDragAndDrop(o,r=>this.handleCurrentFile(r))}setupDragAndDrop(i,t){i.addEventListener("dragover",f=>{f.preventDefault(),i.classList.add("drag-over")}),i.addEventListener("dragleave",()=>{i.classList.remove("drag-over")}),i.addEventListener("drop",f=>{f.preventDefault(),i.classList.remove("drag-over");const o=f.dataTransfer?.files[0];o&&o.name.endsWith(".docx")?t(o):alert("Please drop a .docx file")})}handleOriginalFile(i){this.originalFile=i,this.updateFileDisplay("original",i.name),this.checkBothFilesReady()}handleCurrentFile(i){this.currentFile=i,this.updateFileDisplay("current",i.name),this.checkBothFilesReady()}updateFileDisplay(i,t){const f=document.getElementById(`${i}-name`),o=document.getElementById(`${i}-upload`)?.parentElement?.querySelector(".upload-label");f&&(f.textContent=t),o&&o.classList.add("has-file")}checkBothFilesReady(){this.originalFile&&this.currentFile&&this.onBothFilesReady&&this.onBothFilesReady(this.originalFile,this.currentFile)}onFilesReady(i){this.onBothFilesReady=i}reset(){this.originalFile=null,this.currentFile=null;const i=document.getElementById("original-upload"),t=document.getElementById("current-upload");i&&(i.value=""),t&&(t.value=""),["original","current"].forEach(f=>{const o=document.getElementById(`${f}-name`),r=document.getElementById(`${f}-upload`)?.parentElement?.querySelector(".upload-label");o&&(o.textContent=""),r&&r.classList.remove("has-file")})}}var Et=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ht(j){return j&&j.__esModule&&Object.prototype.hasOwnProperty.call(j,"default")?j.default:j}function Ct(j){throw new Error('Could not dynamically require "'+j+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var It={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Ot;function Xt(){return Ot||(Ot=1,(function(j,i){(function(t){j.exports=t()})(function(){return(function t(f,o,r){function n(y,b){if(!o[y]){if(!f[y]){var v=typeof Ct=="function"&&Ct;if(!b&&v)return v(y,!0);if(s)return s(y,!0);var w=new Error("Cannot find module '"+y+"'");throw w.code="MODULE_NOT_FOUND",w}var l=o[y]={exports:{}};f[y][0].call(l.exports,function(m){var u=f[y][1][m];return n(u||m)},l,l.exports,t,f,o,r)}return o[y].exports}for(var s=typeof Ct=="function"&&Ct,h=0;h<r.length;h++)n(r[h]);return n})({1:[function(t,f,o){var r=t("./utils"),n=t("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(h){for(var y,b,v,w,l,m,u,d=[],c=0,_=h.length,k=_,E=r.getTypeOf(h)!=="string";c<h.length;)k=_-c,v=E?(y=h[c++],b=c<_?h[c++]:0,c<_?h[c++]:0):(y=h.charCodeAt(c++),b=c<_?h.charCodeAt(c++):0,c<_?h.charCodeAt(c++):0),w=y>>2,l=(3&y)<<4|b>>4,m=1<k?(15&b)<<2|v>>6:64,u=2<k?63&v:64,d.push(s.charAt(w)+s.charAt(l)+s.charAt(m)+s.charAt(u));return d.join("")},o.decode=function(h){var y,b,v,w,l,m,u=0,d=0,c="data:";if(h.substr(0,c.length)===c)throw new Error("Invalid base64 input, it looks like a data url.");var _,k=3*(h=h.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(h.charAt(h.length-1)===s.charAt(64)&&k--,h.charAt(h.length-2)===s.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=n.uint8array?new Uint8Array(0|k):new Array(0|k);u<h.length;)y=s.indexOf(h.charAt(u++))<<2|(w=s.indexOf(h.charAt(u++)))>>4,b=(15&w)<<4|(l=s.indexOf(h.charAt(u++)))>>2,v=(3&l)<<6|(m=s.indexOf(h.charAt(u++))),_[d++]=y,l!==64&&(_[d++]=b),m!==64&&(_[d++]=v);return _}},{"./support":30,"./utils":32}],2:[function(t,f,o){var r=t("./external"),n=t("./stream/DataWorker"),s=t("./stream/Crc32Probe"),h=t("./stream/DataLengthProbe");function y(b,v,w,l,m){this.compressedSize=b,this.uncompressedSize=v,this.crc32=w,this.compression=l,this.compressedContent=m}y.prototype={getContentWorker:function(){var b=new n(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new h("data_length")),v=this;return b.on("end",function(){if(this.streamInfo.data_length!==v.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),b},getCompressedWorker:function(){return new n(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},y.createWorkerFrom=function(b,v,w){return b.pipe(new s).pipe(new h("uncompressedSize")).pipe(v.compressWorker(w)).pipe(new h("compressedSize")).withStreamInfo("compression",v)},f.exports=y},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,f,o){var r=t("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},o.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,f,o){var r=t("./utils"),n=(function(){for(var s,h=[],y=0;y<256;y++){s=y;for(var b=0;b<8;b++)s=1&s?3988292384^s>>>1:s>>>1;h[y]=s}return h})();f.exports=function(s,h){return s!==void 0&&s.length?r.getTypeOf(s)!=="string"?(function(y,b,v,w){var l=n,m=w+v;y^=-1;for(var u=w;u<m;u++)y=y>>>8^l[255&(y^b[u])];return-1^y})(0|h,s,s.length,0):(function(y,b,v,w){var l=n,m=w+v;y^=-1;for(var u=w;u<m;u++)y=y>>>8^l[255&(y^b.charCodeAt(u))];return-1^y})(0|h,s,s.length,0):0}},{"./utils":32}],5:[function(t,f,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(t,f,o){var r=null;r=typeof Promise<"u"?Promise:t("lie"),f.exports={Promise:r}},{lie:37}],7:[function(t,f,o){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",n=t("pako"),s=t("./utils"),h=t("./stream/GenericWorker"),y=r?"uint8array":"array";function b(v,w){h.call(this,"FlateWorker/"+v),this._pako=null,this._pakoAction=v,this._pakoOptions=w,this.meta={}}o.magic="\b\0",s.inherits(b,h),b.prototype.processChunk=function(v){this.meta=v.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(y,v.data),!1)},b.prototype.flush=function(){h.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},b.prototype.cleanUp=function(){h.prototype.cleanUp.call(this),this._pako=null},b.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var v=this;this._pako.onData=function(w){v.push({data:w,meta:v.meta})}},o.compressWorker=function(v){return new b("Deflate",v)},o.uncompressWorker=function(){return new b("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,f,o){function r(l,m){var u,d="";for(u=0;u<m;u++)d+=String.fromCharCode(255&l),l>>>=8;return d}function n(l,m,u,d,c,_){var k,E,S=l.file,O=l.compression,D=_!==y.utf8encode,U=s.transformTo("string",_(S.name)),B=s.transformTo("string",y.utf8encode(S.name)),Z=S.comment,V=s.transformTo("string",_(Z)),x=s.transformTo("string",y.utf8encode(Z)),R=B.length!==S.name.length,a=x.length!==Z.length,P="",Q="",W="",tt=S.dir,M=S.date,J={crc32:0,compressedSize:0,uncompressedSize:0};m&&!u||(J.crc32=l.crc32,J.compressedSize=l.compressedSize,J.uncompressedSize=l.uncompressedSize);var A=0;m&&(A|=8),D||!R&&!a||(A|=2048);var I=0,K=0;tt&&(I|=16),c==="UNIX"?(K=798,I|=(function(X,at){var ht=X;return X||(ht=at?16893:33204),(65535&ht)<<16})(S.unixPermissions,tt)):(K=20,I|=(function(X){return 63&(X||0)})(S.dosPermissions)),k=M.getUTCHours(),k<<=6,k|=M.getUTCMinutes(),k<<=5,k|=M.getUTCSeconds()/2,E=M.getUTCFullYear()-1980,E<<=4,E|=M.getUTCMonth()+1,E<<=5,E|=M.getUTCDate(),R&&(Q=r(1,1)+r(b(U),4)+B,P+="up"+r(Q.length,2)+Q),a&&(W=r(1,1)+r(b(V),4)+x,P+="uc"+r(W.length,2)+W);var G="";return G+=`
\0`,G+=r(A,2),G+=O.magic,G+=r(k,2),G+=r(E,2),G+=r(J.crc32,4),G+=r(J.compressedSize,4),G+=r(J.uncompressedSize,4),G+=r(U.length,2),G+=r(P.length,2),{fileRecord:v.LOCAL_FILE_HEADER+G+U+P,dirRecord:v.CENTRAL_FILE_HEADER+r(K,2)+G+r(V.length,2)+"\0\0\0\0"+r(I,4)+r(d,4)+U+P+V}}var s=t("../utils"),h=t("../stream/GenericWorker"),y=t("../utf8"),b=t("../crc32"),v=t("../signature");function w(l,m,u,d){h.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=m,this.zipPlatform=u,this.encodeFileName=d,this.streamFiles=l,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(w,h),w.prototype.push=function(l){var m=l.meta.percent||0,u=this.entriesCount,d=this._sources.length;this.accumulate?this.contentBuffer.push(l):(this.bytesWritten+=l.data.length,h.prototype.push.call(this,{data:l.data,meta:{currentFile:this.currentFile,percent:u?(m+100*(u-d-1))/u:100}}))},w.prototype.openedSource=function(l){this.currentSourceOffset=this.bytesWritten,this.currentFile=l.file.name;var m=this.streamFiles&&!l.file.dir;if(m){var u=n(l,m,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:u.fileRecord,meta:{percent:0}})}else this.accumulate=!0},w.prototype.closedSource=function(l){this.accumulate=!1;var m=this.streamFiles&&!l.file.dir,u=n(l,m,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(u.dirRecord),m)this.push({data:(function(d){return v.DATA_DESCRIPTOR+r(d.crc32,4)+r(d.compressedSize,4)+r(d.uncompressedSize,4)})(l),meta:{percent:100}});else for(this.push({data:u.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},w.prototype.flush=function(){for(var l=this.bytesWritten,m=0;m<this.dirRecords.length;m++)this.push({data:this.dirRecords[m],meta:{percent:100}});var u=this.bytesWritten-l,d=(function(c,_,k,E,S){var O=s.transformTo("string",S(E));return v.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(c,2)+r(c,2)+r(_,4)+r(k,4)+r(O.length,2)+O})(this.dirRecords.length,u,l,this.zipComment,this.encodeFileName);this.push({data:d,meta:{percent:100}})},w.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},w.prototype.registerPrevious=function(l){this._sources.push(l);var m=this;return l.on("data",function(u){m.processChunk(u)}),l.on("end",function(){m.closedSource(m.previous.streamInfo),m._sources.length?m.prepareNextSource():m.end()}),l.on("error",function(u){m.error(u)}),this},w.prototype.resume=function(){return!!h.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},w.prototype.error=function(l){var m=this._sources;if(!h.prototype.error.call(this,l))return!1;for(var u=0;u<m.length;u++)try{m[u].error(l)}catch{}return!0},w.prototype.lock=function(){h.prototype.lock.call(this);for(var l=this._sources,m=0;m<l.length;m++)l[m].lock()},f.exports=w},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,f,o){var r=t("../compressions"),n=t("./ZipFileWorker");o.generateWorker=function(s,h,y){var b=new n(h.streamFiles,y,h.platform,h.encodeFileName),v=0;try{s.forEach(function(w,l){v++;var m=(function(_,k){var E=_||k,S=r[E];if(!S)throw new Error(E+" is not a valid compression method !");return S})(l.options.compression,h.compression),u=l.options.compressionOptions||h.compressionOptions||{},d=l.dir,c=l.date;l._compressWorker(m,u).withStreamInfo("file",{name:w,dir:d,date:c,comment:l.comment||"",unixPermissions:l.unixPermissions,dosPermissions:l.dosPermissions}).pipe(b)}),b.entriesCount=v}catch(w){b.error(w)}return b}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,f,o){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var n=new r;for(var s in this)typeof this[s]!="function"&&(n[s]=this[s]);return n}}(r.prototype=t("./object")).loadAsync=t("./load"),r.support=t("./support"),r.defaults=t("./defaults"),r.version="3.10.1",r.loadAsync=function(n,s){return new r().loadAsync(n,s)},r.external=t("./external"),f.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,f,o){var r=t("./utils"),n=t("./external"),s=t("./utf8"),h=t("./zipEntries"),y=t("./stream/Crc32Probe"),b=t("./nodejsUtils");function v(w){return new n.Promise(function(l,m){var u=w.decompressed.getContentWorker().pipe(new y);u.on("error",function(d){m(d)}).on("end",function(){u.streamInfo.crc32!==w.decompressed.crc32?m(new Error("Corrupted zip : CRC32 mismatch")):l()}).resume()})}f.exports=function(w,l){var m=this;return l=r.extend(l||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),b.isNode&&b.isStream(w)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",w,!0,l.optimizedBinaryString,l.base64).then(function(u){var d=new h(l);return d.load(u),d}).then(function(u){var d=[n.Promise.resolve(u)],c=u.files;if(l.checkCRC32)for(var _=0;_<c.length;_++)d.push(v(c[_]));return n.Promise.all(d)}).then(function(u){for(var d=u.shift(),c=d.files,_=0;_<c.length;_++){var k=c[_],E=k.fileNameStr,S=r.resolve(k.fileNameStr);m.file(S,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:l.createFolders}),k.dir||(m.file(S).unsafeOriginalName=E)}return d.zipComment.length&&(m.comment=d.zipComment),m})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,f,o){var r=t("../utils"),n=t("../stream/GenericWorker");function s(h,y){n.call(this,"Nodejs stream input adapter for "+h),this._upstreamEnded=!1,this._bindStream(y)}r.inherits(s,n),s.prototype._bindStream=function(h){var y=this;(this._stream=h).pause(),h.on("data",function(b){y.push({data:b,meta:{percent:0}})}).on("error",function(b){y.isPaused?this.generatedError=b:y.error(b)}).on("end",function(){y.isPaused?y._upstreamEnded=!0:y.end()})},s.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},f.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,f,o){var r=t("readable-stream").Readable;function n(s,h,y){r.call(this,h),this._helper=s;var b=this;s.on("data",function(v,w){b.push(v)||b._helper.pause(),y&&y(w)}).on("error",function(v){b.emit("error",v)}).on("end",function(){b.push(null)})}t("../utils").inherits(n,r),n.prototype._read=function(){this._helper.resume()},f.exports=n},{"../utils":32,"readable-stream":16}],14:[function(t,f,o){f.exports={isNode:typeof Buffer<"u",newBufferFrom:function(r,n){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,n);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,n)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var n=new Buffer(r);return n.fill(0),n},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}}},{}],15:[function(t,f,o){function r(S,O,D){var U,B=s.getTypeOf(O),Z=s.extend(D||{},b);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(S=c(S)),Z.createFolders&&(U=d(S))&&_.call(this,U,!0);var V=B==="string"&&Z.binary===!1&&Z.base64===!1;D&&D.binary!==void 0||(Z.binary=!V),(O instanceof v&&O.uncompressedSize===0||Z.dir||!O||O.length===0)&&(Z.base64=!1,Z.binary=!0,O="",Z.compression="STORE",B="string");var x=null;x=O instanceof v||O instanceof h?O:m.isNode&&m.isStream(O)?new u(S,O):s.prepareContent(S,O,Z.binary,Z.optimizedBinaryString,Z.base64);var R=new w(S,x,Z);this.files[S]=R}var n=t("./utf8"),s=t("./utils"),h=t("./stream/GenericWorker"),y=t("./stream/StreamHelper"),b=t("./defaults"),v=t("./compressedObject"),w=t("./zipObject"),l=t("./generate"),m=t("./nodejsUtils"),u=t("./nodejs/NodejsStreamInputAdapter"),d=function(S){S.slice(-1)==="/"&&(S=S.substring(0,S.length-1));var O=S.lastIndexOf("/");return 0<O?S.substring(0,O):""},c=function(S){return S.slice(-1)!=="/"&&(S+="/"),S},_=function(S,O){return O=O!==void 0?O:b.createFolders,S=c(S),this.files[S]||r.call(this,S,null,{dir:!0,createFolders:O}),this.files[S]};function k(S){return Object.prototype.toString.call(S)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(S){var O,D,U;for(O in this.files)U=this.files[O],(D=O.slice(this.root.length,O.length))&&O.slice(0,this.root.length)===this.root&&S(D,U)},filter:function(S){var O=[];return this.forEach(function(D,U){S(D,U)&&O.push(U)}),O},file:function(S,O,D){if(arguments.length!==1)return S=this.root+S,r.call(this,S,O,D),this;if(k(S)){var U=S;return this.filter(function(Z,V){return!V.dir&&U.test(Z)})}var B=this.files[this.root+S];return B&&!B.dir?B:null},folder:function(S){if(!S)return this;if(k(S))return this.filter(function(B,Z){return Z.dir&&S.test(B)});var O=this.root+S,D=_.call(this,O),U=this.clone();return U.root=D.name,U},remove:function(S){S=this.root+S;var O=this.files[S];if(O||(S.slice(-1)!=="/"&&(S+="/"),O=this.files[S]),O&&!O.dir)delete this.files[S];else for(var D=this.filter(function(B,Z){return Z.name.slice(0,S.length)===S}),U=0;U<D.length;U++)delete this.files[D[U].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(S){var O,D={};try{if((D=s.extend(S||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=D.type.toLowerCase(),D.compression=D.compression.toUpperCase(),D.type==="binarystring"&&(D.type="string"),!D.type)throw new Error("No output type specified.");s.checkSupport(D.type),D.platform!=="darwin"&&D.platform!=="freebsd"&&D.platform!=="linux"&&D.platform!=="sunos"||(D.platform="UNIX"),D.platform==="win32"&&(D.platform="DOS");var U=D.comment||this.comment||"";O=l.generateWorker(this,D,U)}catch(B){(O=new h("error")).error(B)}return new y(O,D.type||"string",D.mimeType)},generateAsync:function(S,O){return this.generateInternalStream(S).accumulate(O)},generateNodeStream:function(S,O){return(S=S||{}).type||(S.type="nodebuffer"),this.generateInternalStream(S).toNodejsStream(O)}};f.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,f,o){f.exports=t("stream")},{stream:void 0}],17:[function(t,f,o){var r=t("./DataReader");function n(s){r.call(this,s);for(var h=0;h<this.data.length;h++)s[h]=255&s[h]}t("../utils").inherits(n,r),n.prototype.byteAt=function(s){return this.data[this.zero+s]},n.prototype.lastIndexOfSignature=function(s){for(var h=s.charCodeAt(0),y=s.charCodeAt(1),b=s.charCodeAt(2),v=s.charCodeAt(3),w=this.length-4;0<=w;--w)if(this.data[w]===h&&this.data[w+1]===y&&this.data[w+2]===b&&this.data[w+3]===v)return w-this.zero;return-1},n.prototype.readAndCheckSignature=function(s){var h=s.charCodeAt(0),y=s.charCodeAt(1),b=s.charCodeAt(2),v=s.charCodeAt(3),w=this.readData(4);return h===w[0]&&y===w[1]&&b===w[2]&&v===w[3]},n.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var h=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,h},f.exports=n},{"../utils":32,"./DataReader":18}],18:[function(t,f,o){var r=t("../utils");function n(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var h,y=0;for(this.checkOffset(s),h=this.index+s-1;h>=this.index;h--)y=(y<<8)+this.byteAt(h);return this.index+=s,y},readString:function(s){return r.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},f.exports=n},{"../utils":32}],19:[function(t,f,o){var r=t("./Uint8ArrayReader");function n(s){r.call(this,s)}t("../utils").inherits(n,r),n.prototype.readData=function(s){this.checkOffset(s);var h=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,h},f.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,f,o){var r=t("./DataReader");function n(s){r.call(this,s)}t("../utils").inherits(n,r),n.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},n.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},n.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},n.prototype.readData=function(s){this.checkOffset(s);var h=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,h},f.exports=n},{"../utils":32,"./DataReader":18}],21:[function(t,f,o){var r=t("./ArrayReader");function n(s){r.call(this,s)}t("../utils").inherits(n,r),n.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var h=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,h},f.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(t,f,o){var r=t("../utils"),n=t("../support"),s=t("./ArrayReader"),h=t("./StringReader"),y=t("./NodeBufferReader"),b=t("./Uint8ArrayReader");f.exports=function(v){var w=r.getTypeOf(v);return r.checkSupport(w),w!=="string"||n.uint8array?w==="nodebuffer"?new y(v):n.uint8array?new b(r.transformTo("uint8array",v)):new s(r.transformTo("array",v)):new h(v)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,f,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,f,o){var r=t("./GenericWorker"),n=t("../utils");function s(h){r.call(this,"ConvertWorker to "+h),this.destType=h}n.inherits(s,r),s.prototype.processChunk=function(h){this.push({data:n.transformTo(this.destType,h.data),meta:h.meta})},f.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(t,f,o){var r=t("./GenericWorker"),n=t("../crc32");function s(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(s,r),s.prototype.processChunk=function(h){this.streamInfo.crc32=n(h.data,this.streamInfo.crc32||0),this.push(h)},f.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,f,o){var r=t("../utils"),n=t("./GenericWorker");function s(h){n.call(this,"DataLengthProbe for "+h),this.propName=h,this.withStreamInfo(h,0)}r.inherits(s,n),s.prototype.processChunk=function(h){if(h){var y=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=y+h.data.length}n.prototype.processChunk.call(this,h)},f.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(t,f,o){var r=t("../utils"),n=t("./GenericWorker");function s(h){n.call(this,"DataWorker");var y=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,h.then(function(b){y.dataIsReady=!0,y.data=b,y.max=b&&b.length||0,y.type=r.getTypeOf(b),y.isPaused||y._tickAndRepeat()},function(b){y.error(b)})}r.inherits(s,n),s.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var h=null,y=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":h=this.data.substring(this.index,y);break;case"uint8array":h=this.data.subarray(this.index,y);break;case"array":case"nodebuffer":h=this.data.slice(this.index,y)}return this.index=y,this.push({data:h,meta:{percent:this.max?this.index/this.max*100:0}})},f.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(t,f,o){function r(n){this.name=n||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(n){this.emit("data",n)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(n){this.emit("error",n)}return!0},error:function(n){return!this.isFinished&&(this.isPaused?this.generatedError=n:(this.isFinished=!0,this.emit("error",n),this.previous&&this.previous.error(n),this.cleanUp()),!0)},on:function(n,s){return this._listeners[n].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(n,s){if(this._listeners[n])for(var h=0;h<this._listeners[n].length;h++)this._listeners[n][h].call(this,s)},pipe:function(n){return n.registerPrevious(this)},registerPrevious:function(n){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=n.streamInfo,this.mergeStreamInfo(),this.previous=n;var s=this;return n.on("data",function(h){s.processChunk(h)}),n.on("end",function(){s.end()}),n.on("error",function(h){s.error(h)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var n=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),n=!0),this.previous&&this.previous.resume(),!n},flush:function(){},processChunk:function(n){this.push(n)},withStreamInfo:function(n,s){return this.extraStreamInfo[n]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var n in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,n)&&(this.streamInfo[n]=this.extraStreamInfo[n])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var n="Worker "+this.name;return this.previous?this.previous+" -> "+n:n}},f.exports=r},{}],29:[function(t,f,o){var r=t("../utils"),n=t("./ConvertWorker"),s=t("./GenericWorker"),h=t("../base64"),y=t("../support"),b=t("../external"),v=null;if(y.nodestream)try{v=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function w(m,u){return new b.Promise(function(d,c){var _=[],k=m._internalType,E=m._outputType,S=m._mimeType;m.on("data",function(O,D){_.push(O),u&&u(D)}).on("error",function(O){_=[],c(O)}).on("end",function(){try{var O=(function(D,U,B){switch(D){case"blob":return r.newBlob(r.transformTo("arraybuffer",U),B);case"base64":return h.encode(U);default:return r.transformTo(D,U)}})(E,(function(D,U){var B,Z=0,V=null,x=0;for(B=0;B<U.length;B++)x+=U[B].length;switch(D){case"string":return U.join("");case"array":return Array.prototype.concat.apply([],U);case"uint8array":for(V=new Uint8Array(x),B=0;B<U.length;B++)V.set(U[B],Z),Z+=U[B].length;return V;case"nodebuffer":return Buffer.concat(U);default:throw new Error("concat : unsupported type '"+D+"'")}})(k,_),S);d(O)}catch(D){c(D)}_=[]}).resume()})}function l(m,u,d){var c=u;switch(u){case"blob":case"arraybuffer":c="uint8array";break;case"base64":c="string"}try{this._internalType=c,this._outputType=u,this._mimeType=d,r.checkSupport(c),this._worker=m.pipe(new n(c)),m.lock()}catch(_){this._worker=new s("error"),this._worker.error(_)}}l.prototype={accumulate:function(m){return w(this,m)},on:function(m,u){var d=this;return m==="data"?this._worker.on(m,function(c){u.call(d,c.data,c.meta)}):this._worker.on(m,function(){r.delay(u,arguments,d)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(r.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new v(this,{objectMode:this._outputType!=="nodebuffer"},m)}},f.exports=l},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,f,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var r=new ArrayBuffer(0);try{o.blob=new Blob([r],{type:"application/zip"}).size===0}catch{try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(r),o.blob=n.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!t("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(t,f,o){for(var r=t("./utils"),n=t("./support"),s=t("./nodejsUtils"),h=t("./stream/GenericWorker"),y=new Array(256),b=0;b<256;b++)y[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;y[254]=y[254]=1;function v(){h.call(this,"utf-8 decode"),this.leftOver=null}function w(){h.call(this,"utf-8 encode")}o.utf8encode=function(l){return n.nodebuffer?s.newBufferFrom(l,"utf-8"):(function(m){var u,d,c,_,k,E=m.length,S=0;for(_=0;_<E;_++)(64512&(d=m.charCodeAt(_)))==55296&&_+1<E&&(64512&(c=m.charCodeAt(_+1)))==56320&&(d=65536+(d-55296<<10)+(c-56320),_++),S+=d<128?1:d<2048?2:d<65536?3:4;for(u=n.uint8array?new Uint8Array(S):new Array(S),_=k=0;k<S;_++)(64512&(d=m.charCodeAt(_)))==55296&&_+1<E&&(64512&(c=m.charCodeAt(_+1)))==56320&&(d=65536+(d-55296<<10)+(c-56320),_++),d<128?u[k++]=d:(d<2048?u[k++]=192|d>>>6:(d<65536?u[k++]=224|d>>>12:(u[k++]=240|d>>>18,u[k++]=128|d>>>12&63),u[k++]=128|d>>>6&63),u[k++]=128|63&d);return u})(l)},o.utf8decode=function(l){return n.nodebuffer?r.transformTo("nodebuffer",l).toString("utf-8"):(function(m){var u,d,c,_,k=m.length,E=new Array(2*k);for(u=d=0;u<k;)if((c=m[u++])<128)E[d++]=c;else if(4<(_=y[c]))E[d++]=65533,u+=_-1;else{for(c&=_===2?31:_===3?15:7;1<_&&u<k;)c=c<<6|63&m[u++],_--;1<_?E[d++]=65533:c<65536?E[d++]=c:(c-=65536,E[d++]=55296|c>>10&1023,E[d++]=56320|1023&c)}return E.length!==d&&(E.subarray?E=E.subarray(0,d):E.length=d),r.applyFromCharCode(E)})(l=r.transformTo(n.uint8array?"uint8array":"array",l))},r.inherits(v,h),v.prototype.processChunk=function(l){var m=r.transformTo(n.uint8array?"uint8array":"array",l.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var u=m;(m=new Uint8Array(u.length+this.leftOver.length)).set(this.leftOver,0),m.set(u,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var d=(function(_,k){var E;for((k=k||_.length)>_.length&&(k=_.length),E=k-1;0<=E&&(192&_[E])==128;)E--;return E<0||E===0?k:E+y[_[E]]>k?E:k})(m),c=m;d!==m.length&&(n.uint8array?(c=m.subarray(0,d),this.leftOver=m.subarray(d,m.length)):(c=m.slice(0,d),this.leftOver=m.slice(d,m.length))),this.push({data:o.utf8decode(c),meta:l.meta})},v.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=v,r.inherits(w,h),w.prototype.processChunk=function(l){this.push({data:o.utf8encode(l.data),meta:l.meta})},o.Utf8EncodeWorker=w},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,f,o){var r=t("./support"),n=t("./base64"),s=t("./nodejsUtils"),h=t("./external");function y(u){return u}function b(u,d){for(var c=0;c<u.length;++c)d[c]=255&u.charCodeAt(c);return d}t("setimmediate"),o.newBlob=function(u,d){o.checkSupport("blob");try{return new Blob([u],{type:d})}catch{try{var c=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return c.append(u),c.getBlob(d)}catch{throw new Error("Bug : can't construct the Blob.")}}};var v={stringifyByChunk:function(u,d,c){var _=[],k=0,E=u.length;if(E<=c)return String.fromCharCode.apply(null,u);for(;k<E;)d==="array"||d==="nodebuffer"?_.push(String.fromCharCode.apply(null,u.slice(k,Math.min(k+c,E)))):_.push(String.fromCharCode.apply(null,u.subarray(k,Math.min(k+c,E)))),k+=c;return _.join("")},stringifyByChar:function(u){for(var d="",c=0;c<u.length;c++)d+=String.fromCharCode(u[c]);return d},applyCanBeUsed:{uint8array:(function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}})()}};function w(u){var d=65536,c=o.getTypeOf(u),_=!0;if(c==="uint8array"?_=v.applyCanBeUsed.uint8array:c==="nodebuffer"&&(_=v.applyCanBeUsed.nodebuffer),_)for(;1<d;)try{return v.stringifyByChunk(u,c,d)}catch{d=Math.floor(d/2)}return v.stringifyByChar(u)}function l(u,d){for(var c=0;c<u.length;c++)d[c]=u[c];return d}o.applyFromCharCode=w;var m={};m.string={string:y,array:function(u){return b(u,new Array(u.length))},arraybuffer:function(u){return m.string.uint8array(u).buffer},uint8array:function(u){return b(u,new Uint8Array(u.length))},nodebuffer:function(u){return b(u,s.allocBuffer(u.length))}},m.array={string:w,array:y,arraybuffer:function(u){return new Uint8Array(u).buffer},uint8array:function(u){return new Uint8Array(u)},nodebuffer:function(u){return s.newBufferFrom(u)}},m.arraybuffer={string:function(u){return w(new Uint8Array(u))},array:function(u){return l(new Uint8Array(u),new Array(u.byteLength))},arraybuffer:y,uint8array:function(u){return new Uint8Array(u)},nodebuffer:function(u){return s.newBufferFrom(new Uint8Array(u))}},m.uint8array={string:w,array:function(u){return l(u,new Array(u.length))},arraybuffer:function(u){return u.buffer},uint8array:y,nodebuffer:function(u){return s.newBufferFrom(u)}},m.nodebuffer={string:w,array:function(u){return l(u,new Array(u.length))},arraybuffer:function(u){return m.nodebuffer.uint8array(u).buffer},uint8array:function(u){return l(u,new Uint8Array(u.length))},nodebuffer:y},o.transformTo=function(u,d){if(d=d||"",!u)return d;o.checkSupport(u);var c=o.getTypeOf(d);return m[c][u](d)},o.resolve=function(u){for(var d=u.split("/"),c=[],_=0;_<d.length;_++){var k=d[_];k==="."||k===""&&_!==0&&_!==d.length-1||(k===".."?c.pop():c.push(k))}return c.join("/")},o.getTypeOf=function(u){return typeof u=="string"?"string":Object.prototype.toString.call(u)==="[object Array]"?"array":r.nodebuffer&&s.isBuffer(u)?"nodebuffer":r.uint8array&&u instanceof Uint8Array?"uint8array":r.arraybuffer&&u instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(u){if(!r[u.toLowerCase()])throw new Error(u+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(u){var d,c,_="";for(c=0;c<(u||"").length;c++)_+="\\x"+((d=u.charCodeAt(c))<16?"0":"")+d.toString(16).toUpperCase();return _},o.delay=function(u,d,c){setImmediate(function(){u.apply(c||null,d||[])})},o.inherits=function(u,d){function c(){}c.prototype=d.prototype,u.prototype=new c},o.extend=function(){var u,d,c={};for(u=0;u<arguments.length;u++)for(d in arguments[u])Object.prototype.hasOwnProperty.call(arguments[u],d)&&c[d]===void 0&&(c[d]=arguments[u][d]);return c},o.prepareContent=function(u,d,c,_,k){return h.Promise.resolve(d).then(function(E){return r.blob&&(E instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(E))!==-1)&&typeof FileReader<"u"?new h.Promise(function(S,O){var D=new FileReader;D.onload=function(U){S(U.target.result)},D.onerror=function(U){O(U.target.error)},D.readAsArrayBuffer(E)}):E}).then(function(E){var S=o.getTypeOf(E);return S?(S==="arraybuffer"?E=o.transformTo("uint8array",E):S==="string"&&(k?E=n.decode(E):c&&_!==!0&&(E=(function(O){return b(O,r.uint8array?new Uint8Array(O.length):new Array(O.length))})(E))),E):h.Promise.reject(new Error("Can't read the data of '"+u+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,f,o){var r=t("./reader/readerFor"),n=t("./utils"),s=t("./signature"),h=t("./zipEntry"),y=t("./support");function b(v){this.files=[],this.loadOptions=v}b.prototype={checkSignature:function(v){if(!this.reader.readAndCheckSignature(v)){this.reader.index-=4;var w=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(w)+", expected "+n.pretty(v)+")")}},isSignature:function(v,w){var l=this.reader.index;this.reader.setIndex(v);var m=this.reader.readString(4)===w;return this.reader.setIndex(l),m},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var v=this.reader.readData(this.zipCommentLength),w=y.uint8array?"uint8array":"array",l=n.transformTo(w,v);this.zipComment=this.loadOptions.decodeFileName(l)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var v,w,l,m=this.zip64EndOfCentralSize-44;0<m;)v=this.reader.readInt(2),w=this.reader.readInt(4),l=this.reader.readData(w),this.zip64ExtensibleData[v]={id:v,length:w,value:l}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var v,w;for(v=0;v<this.files.length;v++)w=this.files[v],this.reader.setIndex(w.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),w.readLocalPart(this.reader),w.handleUTF8(),w.processAttributes()},readCentralDir:function(){var v;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(v=new h({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(v);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var v=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(v<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(v);var w=v;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(v=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(v),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var l=this.centralDirOffset+this.centralDirSize;this.zip64&&(l+=20,l+=12+this.zip64EndOfCentralSize);var m=w-l;if(0<m)this.isSignature(w,s.CENTRAL_FILE_HEADER)||(this.reader.zero=m);else if(m<0)throw new Error("Corrupted zip: missing "+Math.abs(m)+" bytes.")},prepareReader:function(v){this.reader=r(v)},load:function(v){this.prepareReader(v),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},f.exports=b},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,f,o){var r=t("./reader/readerFor"),n=t("./utils"),s=t("./compressedObject"),h=t("./crc32"),y=t("./utf8"),b=t("./compressions"),v=t("./support");function w(l,m){this.options=l,this.loadOptions=m}w.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(l){var m,u;if(l.skip(22),this.fileNameLength=l.readInt(2),u=l.readInt(2),this.fileName=l.readData(this.fileNameLength),l.skip(u),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((m=(function(d){for(var c in b)if(Object.prototype.hasOwnProperty.call(b,c)&&b[c].magic===d)return b[c];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,m,l.readData(this.compressedSize))},readCentralPart:function(l){this.versionMadeBy=l.readInt(2),l.skip(2),this.bitFlag=l.readInt(2),this.compressionMethod=l.readString(2),this.date=l.readDate(),this.crc32=l.readInt(4),this.compressedSize=l.readInt(4),this.uncompressedSize=l.readInt(4);var m=l.readInt(2);if(this.extraFieldsLength=l.readInt(2),this.fileCommentLength=l.readInt(2),this.diskNumberStart=l.readInt(2),this.internalFileAttributes=l.readInt(2),this.externalFileAttributes=l.readInt(4),this.localHeaderOffset=l.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");l.skip(m),this.readExtraFields(l),this.parseZIP64ExtraField(l),this.fileComment=l.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var l=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),l==0&&(this.dosPermissions=63&this.externalFileAttributes),l==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var l=r(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=l.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=l.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=l.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=l.readInt(4))}},readExtraFields:function(l){var m,u,d,c=l.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});l.index+4<c;)m=l.readInt(2),u=l.readInt(2),d=l.readData(u),this.extraFields[m]={id:m,length:u,value:d};l.setIndex(c)},handleUTF8:function(){var l=v.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=y.utf8decode(this.fileName),this.fileCommentStr=y.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var u=n.transformTo(l,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(u)}var d=this.findExtraFieldUnicodeComment();if(d!==null)this.fileCommentStr=d;else{var c=n.transformTo(l,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(c)}}},findExtraFieldUnicodePath:function(){var l=this.extraFields[28789];if(l){var m=r(l.value);return m.readInt(1)!==1||h(this.fileName)!==m.readInt(4)?null:y.utf8decode(m.readData(l.length-5))}return null},findExtraFieldUnicodeComment:function(){var l=this.extraFields[25461];if(l){var m=r(l.value);return m.readInt(1)!==1||h(this.fileComment)!==m.readInt(4)?null:y.utf8decode(m.readData(l.length-5))}return null}},f.exports=w},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,f,o){function r(m,u,d){this.name=m,this.dir=d.dir,this.date=d.date,this.comment=d.comment,this.unixPermissions=d.unixPermissions,this.dosPermissions=d.dosPermissions,this._data=u,this._dataBinary=d.binary,this.options={compression:d.compression,compressionOptions:d.compressionOptions}}var n=t("./stream/StreamHelper"),s=t("./stream/DataWorker"),h=t("./utf8"),y=t("./compressedObject"),b=t("./stream/GenericWorker");r.prototype={internalStream:function(m){var u=null,d="string";try{if(!m)throw new Error("No output type specified.");var c=(d=m.toLowerCase())==="string"||d==="text";d!=="binarystring"&&d!=="text"||(d="string"),u=this._decompressWorker();var _=!this._dataBinary;_&&!c&&(u=u.pipe(new h.Utf8EncodeWorker)),!_&&c&&(u=u.pipe(new h.Utf8DecodeWorker))}catch(k){(u=new b("error")).error(k)}return new n(u,d,"")},async:function(m,u){return this.internalStream(m).accumulate(u)},nodeStream:function(m,u){return this.internalStream(m||"nodebuffer").toNodejsStream(u)},_compressWorker:function(m,u){if(this._data instanceof y&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var d=this._decompressWorker();return this._dataBinary||(d=d.pipe(new h.Utf8EncodeWorker)),y.createWorkerFrom(d,m,u)},_decompressWorker:function(){return this._data instanceof y?this._data.getContentWorker():this._data instanceof b?this._data:new s(this._data)}};for(var v=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],w=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},l=0;l<v.length;l++)r.prototype[v[l]]=w;f.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,f,o){(function(r){var n,s,h=r.MutationObserver||r.WebKitMutationObserver;if(h){var y=0,b=new h(m),v=r.document.createTextNode("");b.observe(v,{characterData:!0}),n=function(){v.data=y=++y%2}}else if(r.setImmediate||r.MessageChannel===void 0)n="document"in r&&"onreadystatechange"in r.document.createElement("script")?function(){var u=r.document.createElement("script");u.onreadystatechange=function(){m(),u.onreadystatechange=null,u.parentNode.removeChild(u),u=null},r.document.documentElement.appendChild(u)}:function(){setTimeout(m,0)};else{var w=new r.MessageChannel;w.port1.onmessage=m,n=function(){w.port2.postMessage(0)}}var l=[];function m(){var u,d;s=!0;for(var c=l.length;c;){for(d=l,l=[],u=-1;++u<c;)d[u]();c=l.length}s=!1}f.exports=function(u){l.push(u)!==1||s||n()}}).call(this,typeof Et<"u"?Et:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,f,o){var r=t("immediate");function n(){}var s={},h=["REJECTED"],y=["FULFILLED"],b=["PENDING"];function v(c){if(typeof c!="function")throw new TypeError("resolver must be a function");this.state=b,this.queue=[],this.outcome=void 0,c!==n&&u(this,c)}function w(c,_,k){this.promise=c,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function l(c,_,k){r(function(){var E;try{E=_(k)}catch(S){return s.reject(c,S)}E===c?s.reject(c,new TypeError("Cannot resolve promise with itself")):s.resolve(c,E)})}function m(c){var _=c&&c.then;if(c&&(typeof c=="object"||typeof c=="function")&&typeof _=="function")return function(){_.apply(c,arguments)}}function u(c,_){var k=!1;function E(D){k||(k=!0,s.reject(c,D))}function S(D){k||(k=!0,s.resolve(c,D))}var O=d(function(){_(S,E)});O.status==="error"&&E(O.value)}function d(c,_){var k={};try{k.value=c(_),k.status="success"}catch(E){k.status="error",k.value=E}return k}(f.exports=v).prototype.finally=function(c){if(typeof c!="function")return this;var _=this.constructor;return this.then(function(k){return _.resolve(c()).then(function(){return k})},function(k){return _.resolve(c()).then(function(){throw k})})},v.prototype.catch=function(c){return this.then(null,c)},v.prototype.then=function(c,_){if(typeof c!="function"&&this.state===y||typeof _!="function"&&this.state===h)return this;var k=new this.constructor(n);return this.state!==b?l(k,this.state===y?c:_,this.outcome):this.queue.push(new w(k,c,_)),k},w.prototype.callFulfilled=function(c){s.resolve(this.promise,c)},w.prototype.otherCallFulfilled=function(c){l(this.promise,this.onFulfilled,c)},w.prototype.callRejected=function(c){s.reject(this.promise,c)},w.prototype.otherCallRejected=function(c){l(this.promise,this.onRejected,c)},s.resolve=function(c,_){var k=d(m,_);if(k.status==="error")return s.reject(c,k.value);var E=k.value;if(E)u(c,E);else{c.state=y,c.outcome=_;for(var S=-1,O=c.queue.length;++S<O;)c.queue[S].callFulfilled(_)}return c},s.reject=function(c,_){c.state=h,c.outcome=_;for(var k=-1,E=c.queue.length;++k<E;)c.queue[k].callRejected(_);return c},v.resolve=function(c){return c instanceof this?c:s.resolve(new this(n),c)},v.reject=function(c){var _=new this(n);return s.reject(_,c)},v.all=function(c){var _=this;if(Object.prototype.toString.call(c)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=c.length,E=!1;if(!k)return this.resolve([]);for(var S=new Array(k),O=0,D=-1,U=new this(n);++D<k;)B(c[D],D);return U;function B(Z,V){_.resolve(Z).then(function(x){S[V]=x,++O!==k||E||(E=!0,s.resolve(U,S))},function(x){E||(E=!0,s.reject(U,x))})}},v.race=function(c){var _=this;if(Object.prototype.toString.call(c)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=c.length,E=!1;if(!k)return this.resolve([]);for(var S=-1,O=new this(n);++S<k;)D=c[S],_.resolve(D).then(function(U){E||(E=!0,s.resolve(O,U))},function(U){E||(E=!0,s.reject(O,U))});var D;return O}},{immediate:36}],38:[function(t,f,o){var r={};(0,t("./lib/utils/common").assign)(r,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),f.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,f,o){var r=t("./zlib/deflate"),n=t("./utils/common"),s=t("./utils/strings"),h=t("./zlib/messages"),y=t("./zlib/zstream"),b=Object.prototype.toString,v=0,w=-1,l=0,m=8;function u(c){if(!(this instanceof u))return new u(c);this.options=n.assign({level:w,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:l,to:""},c||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var k=r.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(k!==v)throw new Error(h[k]);if(_.header&&r.deflateSetHeader(this.strm,_.header),_.dictionary){var E;if(E=typeof _.dictionary=="string"?s.string2buf(_.dictionary):b.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(k=r.deflateSetDictionary(this.strm,E))!==v)throw new Error(h[k]);this._dict_set=!0}}function d(c,_){var k=new u(_);if(k.push(c,!0),k.err)throw k.msg||h[k.err];return k.result}u.prototype.push=function(c,_){var k,E,S=this.strm,O=this.options.chunkSize;if(this.ended)return!1;E=_===~~_?_:_===!0?4:0,typeof c=="string"?S.input=s.string2buf(c):b.call(c)==="[object ArrayBuffer]"?S.input=new Uint8Array(c):S.input=c,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new n.Buf8(O),S.next_out=0,S.avail_out=O),(k=r.deflate(S,E))!==1&&k!==v)return this.onEnd(k),!(this.ended=!0);S.avail_out!==0&&(S.avail_in!==0||E!==4&&E!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(n.shrinkBuf(S.output,S.next_out))):this.onData(n.shrinkBuf(S.output,S.next_out)))}while((0<S.avail_in||S.avail_out===0)&&k!==1);return E===4?(k=r.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===v):E!==2||(this.onEnd(v),!(S.avail_out=0))},u.prototype.onData=function(c){this.chunks.push(c)},u.prototype.onEnd=function(c){c===v&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=c,this.msg=this.strm.msg},o.Deflate=u,o.deflate=d,o.deflateRaw=function(c,_){return(_=_||{}).raw=!0,d(c,_)},o.gzip=function(c,_){return(_=_||{}).gzip=!0,d(c,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,f,o){var r=t("./zlib/inflate"),n=t("./utils/common"),s=t("./utils/strings"),h=t("./zlib/constants"),y=t("./zlib/messages"),b=t("./zlib/zstream"),v=t("./zlib/gzheader"),w=Object.prototype.toString;function l(u){if(!(this instanceof l))return new l(u);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},u||{});var d=this.options;d.raw&&0<=d.windowBits&&d.windowBits<16&&(d.windowBits=-d.windowBits,d.windowBits===0&&(d.windowBits=-15)),!(0<=d.windowBits&&d.windowBits<16)||u&&u.windowBits||(d.windowBits+=32),15<d.windowBits&&d.windowBits<48&&(15&d.windowBits)==0&&(d.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var c=r.inflateInit2(this.strm,d.windowBits);if(c!==h.Z_OK)throw new Error(y[c]);this.header=new v,r.inflateGetHeader(this.strm,this.header)}function m(u,d){var c=new l(d);if(c.push(u,!0),c.err)throw c.msg||y[c.err];return c.result}l.prototype.push=function(u,d){var c,_,k,E,S,O,D=this.strm,U=this.options.chunkSize,B=this.options.dictionary,Z=!1;if(this.ended)return!1;_=d===~~d?d:d===!0?h.Z_FINISH:h.Z_NO_FLUSH,typeof u=="string"?D.input=s.binstring2buf(u):w.call(u)==="[object ArrayBuffer]"?D.input=new Uint8Array(u):D.input=u,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new n.Buf8(U),D.next_out=0,D.avail_out=U),(c=r.inflate(D,h.Z_NO_FLUSH))===h.Z_NEED_DICT&&B&&(O=typeof B=="string"?s.string2buf(B):w.call(B)==="[object ArrayBuffer]"?new Uint8Array(B):B,c=r.inflateSetDictionary(this.strm,O)),c===h.Z_BUF_ERROR&&Z===!0&&(c=h.Z_OK,Z=!1),c!==h.Z_STREAM_END&&c!==h.Z_OK)return this.onEnd(c),!(this.ended=!0);D.next_out&&(D.avail_out!==0&&c!==h.Z_STREAM_END&&(D.avail_in!==0||_!==h.Z_FINISH&&_!==h.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=s.utf8border(D.output,D.next_out),E=D.next_out-k,S=s.buf2string(D.output,k),D.next_out=E,D.avail_out=U-E,E&&n.arraySet(D.output,D.output,k,E,0),this.onData(S)):this.onData(n.shrinkBuf(D.output,D.next_out)))),D.avail_in===0&&D.avail_out===0&&(Z=!0)}while((0<D.avail_in||D.avail_out===0)&&c!==h.Z_STREAM_END);return c===h.Z_STREAM_END&&(_=h.Z_FINISH),_===h.Z_FINISH?(c=r.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===h.Z_OK):_!==h.Z_SYNC_FLUSH||(this.onEnd(h.Z_OK),!(D.avail_out=0))},l.prototype.onData=function(u){this.chunks.push(u)},l.prototype.onEnd=function(u){u===h.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=u,this.msg=this.strm.msg},o.Inflate=l,o.inflate=m,o.inflateRaw=function(u,d){return(d=d||{}).raw=!0,m(u,d)},o.ungzip=m},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,f,o){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(h){for(var y=Array.prototype.slice.call(arguments,1);y.length;){var b=y.shift();if(b){if(typeof b!="object")throw new TypeError(b+"must be non-object");for(var v in b)b.hasOwnProperty(v)&&(h[v]=b[v])}}return h},o.shrinkBuf=function(h,y){return h.length===y?h:h.subarray?h.subarray(0,y):(h.length=y,h)};var n={arraySet:function(h,y,b,v,w){if(y.subarray&&h.subarray)h.set(y.subarray(b,b+v),w);else for(var l=0;l<v;l++)h[w+l]=y[b+l]},flattenChunks:function(h){var y,b,v,w,l,m;for(y=v=0,b=h.length;y<b;y++)v+=h[y].length;for(m=new Uint8Array(v),y=w=0,b=h.length;y<b;y++)l=h[y],m.set(l,w),w+=l.length;return m}},s={arraySet:function(h,y,b,v,w){for(var l=0;l<v;l++)h[w+l]=y[b+l]},flattenChunks:function(h){return[].concat.apply([],h)}};o.setTyped=function(h){h?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,n)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,s))},o.setTyped(r)},{}],42:[function(t,f,o){var r=t("./common"),n=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var h=new r.Buf8(256),y=0;y<256;y++)h[y]=252<=y?6:248<=y?5:240<=y?4:224<=y?3:192<=y?2:1;function b(v,w){if(w<65537&&(v.subarray&&s||!v.subarray&&n))return String.fromCharCode.apply(null,r.shrinkBuf(v,w));for(var l="",m=0;m<w;m++)l+=String.fromCharCode(v[m]);return l}h[254]=h[254]=1,o.string2buf=function(v){var w,l,m,u,d,c=v.length,_=0;for(u=0;u<c;u++)(64512&(l=v.charCodeAt(u)))==55296&&u+1<c&&(64512&(m=v.charCodeAt(u+1)))==56320&&(l=65536+(l-55296<<10)+(m-56320),u++),_+=l<128?1:l<2048?2:l<65536?3:4;for(w=new r.Buf8(_),u=d=0;d<_;u++)(64512&(l=v.charCodeAt(u)))==55296&&u+1<c&&(64512&(m=v.charCodeAt(u+1)))==56320&&(l=65536+(l-55296<<10)+(m-56320),u++),l<128?w[d++]=l:(l<2048?w[d++]=192|l>>>6:(l<65536?w[d++]=224|l>>>12:(w[d++]=240|l>>>18,w[d++]=128|l>>>12&63),w[d++]=128|l>>>6&63),w[d++]=128|63&l);return w},o.buf2binstring=function(v){return b(v,v.length)},o.binstring2buf=function(v){for(var w=new r.Buf8(v.length),l=0,m=w.length;l<m;l++)w[l]=v.charCodeAt(l);return w},o.buf2string=function(v,w){var l,m,u,d,c=w||v.length,_=new Array(2*c);for(l=m=0;l<c;)if((u=v[l++])<128)_[m++]=u;else if(4<(d=h[u]))_[m++]=65533,l+=d-1;else{for(u&=d===2?31:d===3?15:7;1<d&&l<c;)u=u<<6|63&v[l++],d--;1<d?_[m++]=65533:u<65536?_[m++]=u:(u-=65536,_[m++]=55296|u>>10&1023,_[m++]=56320|1023&u)}return b(_,m)},o.utf8border=function(v,w){var l;for((w=w||v.length)>v.length&&(w=v.length),l=w-1;0<=l&&(192&v[l])==128;)l--;return l<0||l===0?w:l+h[v[l]]>w?l:w}},{"./common":41}],43:[function(t,f,o){f.exports=function(r,n,s,h){for(var y=65535&r|0,b=r>>>16&65535|0,v=0;s!==0;){for(s-=v=2e3<s?2e3:s;b=b+(y=y+n[h++]|0)|0,--v;);y%=65521,b%=65521}return y|b<<16|0}},{}],44:[function(t,f,o){f.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,f,o){var r=(function(){for(var n,s=[],h=0;h<256;h++){n=h;for(var y=0;y<8;y++)n=1&n?3988292384^n>>>1:n>>>1;s[h]=n}return s})();f.exports=function(n,s,h,y){var b=r,v=y+h;n^=-1;for(var w=y;w<v;w++)n=n>>>8^b[255&(n^s[w])];return-1^n}},{}],46:[function(t,f,o){var r,n=t("../utils/common"),s=t("./trees"),h=t("./adler32"),y=t("./crc32"),b=t("./messages"),v=0,w=4,l=0,m=-2,u=-1,d=4,c=2,_=8,k=9,E=286,S=30,O=19,D=2*E+1,U=15,B=3,Z=258,V=Z+B+1,x=42,R=113,a=1,P=2,Q=3,W=4;function tt(e,F){return e.msg=b[F],F}function M(e){return(e<<1)-(4<e?9:0)}function J(e){for(var F=e.length;0<=--F;)e[F]=0}function A(e){var F=e.state,T=F.pending;T>e.avail_out&&(T=e.avail_out),T!==0&&(n.arraySet(e.output,F.pending_buf,F.pending_out,T,e.next_out),e.next_out+=T,F.pending_out+=T,e.total_out+=T,e.avail_out-=T,F.pending-=T,F.pending===0&&(F.pending_out=0))}function I(e,F){s._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,F),e.block_start=e.strstart,A(e.strm)}function K(e,F){e.pending_buf[e.pending++]=F}function G(e,F){e.pending_buf[e.pending++]=F>>>8&255,e.pending_buf[e.pending++]=255&F}function X(e,F){var T,g,p=e.max_chain_length,C=e.strstart,L=e.prev_length,N=e.nice_match,z=e.strstart>e.w_size-V?e.strstart-(e.w_size-V):0,$=e.window,q=e.w_mask,H=e.prev,Y=e.strstart+Z,st=$[C+L-1],nt=$[C+L];e.prev_length>=e.good_match&&(p>>=2),N>e.lookahead&&(N=e.lookahead);do if($[(T=F)+L]===nt&&$[T+L-1]===st&&$[T]===$[C]&&$[++T]===$[C+1]){C+=2,T++;do;while($[++C]===$[++T]&&$[++C]===$[++T]&&$[++C]===$[++T]&&$[++C]===$[++T]&&$[++C]===$[++T]&&$[++C]===$[++T]&&$[++C]===$[++T]&&$[++C]===$[++T]&&C<Y);if(g=Z-(Y-C),C=Y-Z,L<g){if(e.match_start=F,N<=(L=g))break;st=$[C+L-1],nt=$[C+L]}}while((F=H[F&q])>z&&--p!=0);return L<=e.lookahead?L:e.lookahead}function at(e){var F,T,g,p,C,L,N,z,$,q,H=e.w_size;do{if(p=e.window_size-e.lookahead-e.strstart,e.strstart>=H+(H-V)){for(n.arraySet(e.window,e.window,H,H,0),e.match_start-=H,e.strstart-=H,e.block_start-=H,F=T=e.hash_size;g=e.head[--F],e.head[F]=H<=g?g-H:0,--T;);for(F=T=H;g=e.prev[--F],e.prev[F]=H<=g?g-H:0,--T;);p+=H}if(e.strm.avail_in===0)break;if(L=e.strm,N=e.window,z=e.strstart+e.lookahead,$=p,q=void 0,q=L.avail_in,$<q&&(q=$),T=q===0?0:(L.avail_in-=q,n.arraySet(N,L.input,L.next_in,q,z),L.state.wrap===1?L.adler=h(L.adler,N,q,z):L.state.wrap===2&&(L.adler=y(L.adler,N,q,z)),L.next_in+=q,L.total_in+=q,q),e.lookahead+=T,e.lookahead+e.insert>=B)for(C=e.strstart-e.insert,e.ins_h=e.window[C],e.ins_h=(e.ins_h<<e.hash_shift^e.window[C+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[C+B-1])&e.hash_mask,e.prev[C&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=C,C++,e.insert--,!(e.lookahead+e.insert<B)););}while(e.lookahead<V&&e.strm.avail_in!==0)}function ht(e,F){for(var T,g;;){if(e.lookahead<V){if(at(e),e.lookahead<V&&F===v)return a;if(e.lookahead===0)break}if(T=0,e.lookahead>=B&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+B-1])&e.hash_mask,T=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),T!==0&&e.strstart-T<=e.w_size-V&&(e.match_length=X(e,T)),e.match_length>=B)if(g=s._tr_tally(e,e.strstart-e.match_start,e.match_length-B),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=B){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+B-1])&e.hash_mask,T=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,--e.match_length!=0;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else g=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(g&&(I(e,!1),e.strm.avail_out===0))return a}return e.insert=e.strstart<B-1?e.strstart:B-1,F===w?(I(e,!0),e.strm.avail_out===0?Q:W):e.last_lit&&(I(e,!1),e.strm.avail_out===0)?a:P}function rt(e,F){for(var T,g,p;;){if(e.lookahead<V){if(at(e),e.lookahead<V&&F===v)return a;if(e.lookahead===0)break}if(T=0,e.lookahead>=B&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+B-1])&e.hash_mask,T=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=B-1,T!==0&&e.prev_length<e.max_lazy_match&&e.strstart-T<=e.w_size-V&&(e.match_length=X(e,T),e.match_length<=5&&(e.strategy===1||e.match_length===B&&4096<e.strstart-e.match_start)&&(e.match_length=B-1)),e.prev_length>=B&&e.match_length<=e.prev_length){for(p=e.strstart+e.lookahead-B,g=s._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-B),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=p&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+B-1])&e.hash_mask,T=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),--e.prev_length!=0;);if(e.match_available=0,e.match_length=B-1,e.strstart++,g&&(I(e,!1),e.strm.avail_out===0))return a}else if(e.match_available){if((g=s._tr_tally(e,0,e.window[e.strstart-1]))&&I(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return a}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(g=s._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<B-1?e.strstart:B-1,F===w?(I(e,!0),e.strm.avail_out===0?Q:W):e.last_lit&&(I(e,!1),e.strm.avail_out===0)?a:P}function it(e,F,T,g,p){this.good_length=e,this.max_lazy=F,this.nice_length=T,this.max_chain=g,this.func=p}function ut(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*D),this.dyn_dtree=new n.Buf16(2*(2*S+1)),this.bl_tree=new n.Buf16(2*(2*O+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(U+1),this.heap=new n.Buf16(2*E+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*E+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ot(e){var F;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=c,(F=e.state).pending=0,F.pending_out=0,F.wrap<0&&(F.wrap=-F.wrap),F.status=F.wrap?x:R,e.adler=F.wrap===2?0:1,F.last_flush=v,s._tr_init(F),l):tt(e,m)}function pt(e){var F=ot(e);return F===l&&(function(T){T.window_size=2*T.w_size,J(T.head),T.max_lazy_match=r[T.level].max_lazy,T.good_match=r[T.level].good_length,T.nice_match=r[T.level].nice_length,T.max_chain_length=r[T.level].max_chain,T.strstart=0,T.block_start=0,T.lookahead=0,T.insert=0,T.match_length=T.prev_length=B-1,T.match_available=0,T.ins_h=0})(e.state),F}function ft(e,F,T,g,p,C){if(!e)return m;var L=1;if(F===u&&(F=6),g<0?(L=0,g=-g):15<g&&(L=2,g-=16),p<1||k<p||T!==_||g<8||15<g||F<0||9<F||C<0||d<C)return tt(e,m);g===8&&(g=9);var N=new ut;return(e.state=N).strm=e,N.wrap=L,N.gzhead=null,N.w_bits=g,N.w_size=1<<N.w_bits,N.w_mask=N.w_size-1,N.hash_bits=p+7,N.hash_size=1<<N.hash_bits,N.hash_mask=N.hash_size-1,N.hash_shift=~~((N.hash_bits+B-1)/B),N.window=new n.Buf8(2*N.w_size),N.head=new n.Buf16(N.hash_size),N.prev=new n.Buf16(N.w_size),N.lit_bufsize=1<<p+6,N.pending_buf_size=4*N.lit_bufsize,N.pending_buf=new n.Buf8(N.pending_buf_size),N.d_buf=1*N.lit_bufsize,N.l_buf=3*N.lit_bufsize,N.level=F,N.strategy=C,N.method=T,pt(e)}r=[new it(0,0,0,0,function(e,F){var T=65535;for(T>e.pending_buf_size-5&&(T=e.pending_buf_size-5);;){if(e.lookahead<=1){if(at(e),e.lookahead===0&&F===v)return a;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var g=e.block_start+T;if((e.strstart===0||e.strstart>=g)&&(e.lookahead=e.strstart-g,e.strstart=g,I(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-V&&(I(e,!1),e.strm.avail_out===0))return a}return e.insert=0,F===w?(I(e,!0),e.strm.avail_out===0?Q:W):(e.strstart>e.block_start&&(I(e,!1),e.strm.avail_out),a)}),new it(4,4,8,4,ht),new it(4,5,16,8,ht),new it(4,6,32,32,ht),new it(4,4,16,16,rt),new it(8,16,32,32,rt),new it(8,16,128,128,rt),new it(8,32,128,256,rt),new it(32,128,258,1024,rt),new it(32,258,258,4096,rt)],o.deflateInit=function(e,F){return ft(e,F,_,15,8,0)},o.deflateInit2=ft,o.deflateReset=pt,o.deflateResetKeep=ot,o.deflateSetHeader=function(e,F){return e&&e.state?e.state.wrap!==2?m:(e.state.gzhead=F,l):m},o.deflate=function(e,F){var T,g,p,C;if(!e||!e.state||5<F||F<0)return e?tt(e,m):m;if(g=e.state,!e.output||!e.input&&e.avail_in!==0||g.status===666&&F!==w)return tt(e,e.avail_out===0?-5:m);if(g.strm=e,T=g.last_flush,g.last_flush=F,g.status===x)if(g.wrap===2)e.adler=0,K(g,31),K(g,139),K(g,8),g.gzhead?(K(g,(g.gzhead.text?1:0)+(g.gzhead.hcrc?2:0)+(g.gzhead.extra?4:0)+(g.gzhead.name?8:0)+(g.gzhead.comment?16:0)),K(g,255&g.gzhead.time),K(g,g.gzhead.time>>8&255),K(g,g.gzhead.time>>16&255),K(g,g.gzhead.time>>24&255),K(g,g.level===9?2:2<=g.strategy||g.level<2?4:0),K(g,255&g.gzhead.os),g.gzhead.extra&&g.gzhead.extra.length&&(K(g,255&g.gzhead.extra.length),K(g,g.gzhead.extra.length>>8&255)),g.gzhead.hcrc&&(e.adler=y(e.adler,g.pending_buf,g.pending,0)),g.gzindex=0,g.status=69):(K(g,0),K(g,0),K(g,0),K(g,0),K(g,0),K(g,g.level===9?2:2<=g.strategy||g.level<2?4:0),K(g,3),g.status=R);else{var L=_+(g.w_bits-8<<4)<<8;L|=(2<=g.strategy||g.level<2?0:g.level<6?1:g.level===6?2:3)<<6,g.strstart!==0&&(L|=32),L+=31-L%31,g.status=R,G(g,L),g.strstart!==0&&(G(g,e.adler>>>16),G(g,65535&e.adler)),e.adler=1}if(g.status===69)if(g.gzhead.extra){for(p=g.pending;g.gzindex<(65535&g.gzhead.extra.length)&&(g.pending!==g.pending_buf_size||(g.gzhead.hcrc&&g.pending>p&&(e.adler=y(e.adler,g.pending_buf,g.pending-p,p)),A(e),p=g.pending,g.pending!==g.pending_buf_size));)K(g,255&g.gzhead.extra[g.gzindex]),g.gzindex++;g.gzhead.hcrc&&g.pending>p&&(e.adler=y(e.adler,g.pending_buf,g.pending-p,p)),g.gzindex===g.gzhead.extra.length&&(g.gzindex=0,g.status=73)}else g.status=73;if(g.status===73)if(g.gzhead.name){p=g.pending;do{if(g.pending===g.pending_buf_size&&(g.gzhead.hcrc&&g.pending>p&&(e.adler=y(e.adler,g.pending_buf,g.pending-p,p)),A(e),p=g.pending,g.pending===g.pending_buf_size)){C=1;break}C=g.gzindex<g.gzhead.name.length?255&g.gzhead.name.charCodeAt(g.gzindex++):0,K(g,C)}while(C!==0);g.gzhead.hcrc&&g.pending>p&&(e.adler=y(e.adler,g.pending_buf,g.pending-p,p)),C===0&&(g.gzindex=0,g.status=91)}else g.status=91;if(g.status===91)if(g.gzhead.comment){p=g.pending;do{if(g.pending===g.pending_buf_size&&(g.gzhead.hcrc&&g.pending>p&&(e.adler=y(e.adler,g.pending_buf,g.pending-p,p)),A(e),p=g.pending,g.pending===g.pending_buf_size)){C=1;break}C=g.gzindex<g.gzhead.comment.length?255&g.gzhead.comment.charCodeAt(g.gzindex++):0,K(g,C)}while(C!==0);g.gzhead.hcrc&&g.pending>p&&(e.adler=y(e.adler,g.pending_buf,g.pending-p,p)),C===0&&(g.status=103)}else g.status=103;if(g.status===103&&(g.gzhead.hcrc?(g.pending+2>g.pending_buf_size&&A(e),g.pending+2<=g.pending_buf_size&&(K(g,255&e.adler),K(g,e.adler>>8&255),e.adler=0,g.status=R)):g.status=R),g.pending!==0){if(A(e),e.avail_out===0)return g.last_flush=-1,l}else if(e.avail_in===0&&M(F)<=M(T)&&F!==w)return tt(e,-5);if(g.status===666&&e.avail_in!==0)return tt(e,-5);if(e.avail_in!==0||g.lookahead!==0||F!==v&&g.status!==666){var N=g.strategy===2?(function(z,$){for(var q;;){if(z.lookahead===0&&(at(z),z.lookahead===0)){if($===v)return a;break}if(z.match_length=0,q=s._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,q&&(I(z,!1),z.strm.avail_out===0))return a}return z.insert=0,$===w?(I(z,!0),z.strm.avail_out===0?Q:W):z.last_lit&&(I(z,!1),z.strm.avail_out===0)?a:P})(g,F):g.strategy===3?(function(z,$){for(var q,H,Y,st,nt=z.window;;){if(z.lookahead<=Z){if(at(z),z.lookahead<=Z&&$===v)return a;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=B&&0<z.strstart&&(H=nt[Y=z.strstart-1])===nt[++Y]&&H===nt[++Y]&&H===nt[++Y]){st=z.strstart+Z;do;while(H===nt[++Y]&&H===nt[++Y]&&H===nt[++Y]&&H===nt[++Y]&&H===nt[++Y]&&H===nt[++Y]&&H===nt[++Y]&&H===nt[++Y]&&Y<st);z.match_length=Z-(st-Y),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=B?(q=s._tr_tally(z,1,z.match_length-B),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(q=s._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),q&&(I(z,!1),z.strm.avail_out===0))return a}return z.insert=0,$===w?(I(z,!0),z.strm.avail_out===0?Q:W):z.last_lit&&(I(z,!1),z.strm.avail_out===0)?a:P})(g,F):r[g.level].func(g,F);if(N!==Q&&N!==W||(g.status=666),N===a||N===Q)return e.avail_out===0&&(g.last_flush=-1),l;if(N===P&&(F===1?s._tr_align(g):F!==5&&(s._tr_stored_block(g,0,0,!1),F===3&&(J(g.head),g.lookahead===0&&(g.strstart=0,g.block_start=0,g.insert=0))),A(e),e.avail_out===0))return g.last_flush=-1,l}return F!==w?l:g.wrap<=0?1:(g.wrap===2?(K(g,255&e.adler),K(g,e.adler>>8&255),K(g,e.adler>>16&255),K(g,e.adler>>24&255),K(g,255&e.total_in),K(g,e.total_in>>8&255),K(g,e.total_in>>16&255),K(g,e.total_in>>24&255)):(G(g,e.adler>>>16),G(g,65535&e.adler)),A(e),0<g.wrap&&(g.wrap=-g.wrap),g.pending!==0?l:1)},o.deflateEnd=function(e){var F;return e&&e.state?(F=e.state.status)!==x&&F!==69&&F!==73&&F!==91&&F!==103&&F!==R&&F!==666?tt(e,m):(e.state=null,F===R?tt(e,-3):l):m},o.deflateSetDictionary=function(e,F){var T,g,p,C,L,N,z,$,q=F.length;if(!e||!e.state||(C=(T=e.state).wrap)===2||C===1&&T.status!==x||T.lookahead)return m;for(C===1&&(e.adler=h(e.adler,F,q,0)),T.wrap=0,q>=T.w_size&&(C===0&&(J(T.head),T.strstart=0,T.block_start=0,T.insert=0),$=new n.Buf8(T.w_size),n.arraySet($,F,q-T.w_size,T.w_size,0),F=$,q=T.w_size),L=e.avail_in,N=e.next_in,z=e.input,e.avail_in=q,e.next_in=0,e.input=F,at(T);T.lookahead>=B;){for(g=T.strstart,p=T.lookahead-(B-1);T.ins_h=(T.ins_h<<T.hash_shift^T.window[g+B-1])&T.hash_mask,T.prev[g&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=g,g++,--p;);T.strstart=g,T.lookahead=B-1,at(T)}return T.strstart+=T.lookahead,T.block_start=T.strstart,T.insert=T.lookahead,T.lookahead=0,T.match_length=T.prev_length=B-1,T.match_available=0,e.next_in=N,e.input=z,e.avail_in=L,T.wrap=C,l},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,f,o){f.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,f,o){f.exports=function(r,n){var s,h,y,b,v,w,l,m,u,d,c,_,k,E,S,O,D,U,B,Z,V,x,R,a,P;s=r.state,h=r.next_in,a=r.input,y=h+(r.avail_in-5),b=r.next_out,P=r.output,v=b-(n-r.avail_out),w=b+(r.avail_out-257),l=s.dmax,m=s.wsize,u=s.whave,d=s.wnext,c=s.window,_=s.hold,k=s.bits,E=s.lencode,S=s.distcode,O=(1<<s.lenbits)-1,D=(1<<s.distbits)-1;t:do{k<15&&(_+=a[h++]<<k,k+=8,_+=a[h++]<<k,k+=8),U=E[_&O];e:for(;;){if(_>>>=B=U>>>24,k-=B,(B=U>>>16&255)===0)P[b++]=65535&U;else{if(!(16&B)){if((64&B)==0){U=E[(65535&U)+(_&(1<<B)-1)];continue e}if(32&B){s.mode=12;break t}r.msg="invalid literal/length code",s.mode=30;break t}Z=65535&U,(B&=15)&&(k<B&&(_+=a[h++]<<k,k+=8),Z+=_&(1<<B)-1,_>>>=B,k-=B),k<15&&(_+=a[h++]<<k,k+=8,_+=a[h++]<<k,k+=8),U=S[_&D];r:for(;;){if(_>>>=B=U>>>24,k-=B,!(16&(B=U>>>16&255))){if((64&B)==0){U=S[(65535&U)+(_&(1<<B)-1)];continue r}r.msg="invalid distance code",s.mode=30;break t}if(V=65535&U,k<(B&=15)&&(_+=a[h++]<<k,(k+=8)<B&&(_+=a[h++]<<k,k+=8)),l<(V+=_&(1<<B)-1)){r.msg="invalid distance too far back",s.mode=30;break t}if(_>>>=B,k-=B,(B=b-v)<V){if(u<(B=V-B)&&s.sane){r.msg="invalid distance too far back",s.mode=30;break t}if(R=c,(x=0)===d){if(x+=m-B,B<Z){for(Z-=B;P[b++]=c[x++],--B;);x=b-V,R=P}}else if(d<B){if(x+=m+d-B,(B-=d)<Z){for(Z-=B;P[b++]=c[x++],--B;);if(x=0,d<Z){for(Z-=B=d;P[b++]=c[x++],--B;);x=b-V,R=P}}}else if(x+=d-B,B<Z){for(Z-=B;P[b++]=c[x++],--B;);x=b-V,R=P}for(;2<Z;)P[b++]=R[x++],P[b++]=R[x++],P[b++]=R[x++],Z-=3;Z&&(P[b++]=R[x++],1<Z&&(P[b++]=R[x++]))}else{for(x=b-V;P[b++]=P[x++],P[b++]=P[x++],P[b++]=P[x++],2<(Z-=3););Z&&(P[b++]=P[x++],1<Z&&(P[b++]=P[x++]))}break}}break}}while(h<y&&b<w);h-=Z=k>>3,_&=(1<<(k-=Z<<3))-1,r.next_in=h,r.next_out=b,r.avail_in=h<y?y-h+5:5-(h-y),r.avail_out=b<w?w-b+257:257-(b-w),s.hold=_,s.bits=k}},{}],49:[function(t,f,o){var r=t("../utils/common"),n=t("./adler32"),s=t("./crc32"),h=t("./inffast"),y=t("./inftrees"),b=1,v=2,w=0,l=-2,m=1,u=852,d=592;function c(x){return(x>>>24&255)+(x>>>8&65280)+((65280&x)<<8)+((255&x)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(x){var R;return x&&x.state?(R=x.state,x.total_in=x.total_out=R.total=0,x.msg="",R.wrap&&(x.adler=1&R.wrap),R.mode=m,R.last=0,R.havedict=0,R.dmax=32768,R.head=null,R.hold=0,R.bits=0,R.lencode=R.lendyn=new r.Buf32(u),R.distcode=R.distdyn=new r.Buf32(d),R.sane=1,R.back=-1,w):l}function E(x){var R;return x&&x.state?((R=x.state).wsize=0,R.whave=0,R.wnext=0,k(x)):l}function S(x,R){var a,P;return x&&x.state?(P=x.state,R<0?(a=0,R=-R):(a=1+(R>>4),R<48&&(R&=15)),R&&(R<8||15<R)?l:(P.window!==null&&P.wbits!==R&&(P.window=null),P.wrap=a,P.wbits=R,E(x))):l}function O(x,R){var a,P;return x?(P=new _,(x.state=P).window=null,(a=S(x,R))!==w&&(x.state=null),a):l}var D,U,B=!0;function Z(x){if(B){var R;for(D=new r.Buf32(512),U=new r.Buf32(32),R=0;R<144;)x.lens[R++]=8;for(;R<256;)x.lens[R++]=9;for(;R<280;)x.lens[R++]=7;for(;R<288;)x.lens[R++]=8;for(y(b,x.lens,0,288,D,0,x.work,{bits:9}),R=0;R<32;)x.lens[R++]=5;y(v,x.lens,0,32,U,0,x.work,{bits:5}),B=!1}x.lencode=D,x.lenbits=9,x.distcode=U,x.distbits=5}function V(x,R,a,P){var Q,W=x.state;return W.window===null&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new r.Buf8(W.wsize)),P>=W.wsize?(r.arraySet(W.window,R,a-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(P<(Q=W.wsize-W.wnext)&&(Q=P),r.arraySet(W.window,R,a-P,Q,W.wnext),(P-=Q)?(r.arraySet(W.window,R,a-P,P,0),W.wnext=P,W.whave=W.wsize):(W.wnext+=Q,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=Q))),0}o.inflateReset=E,o.inflateReset2=S,o.inflateResetKeep=k,o.inflateInit=function(x){return O(x,15)},o.inflateInit2=O,o.inflate=function(x,R){var a,P,Q,W,tt,M,J,A,I,K,G,X,at,ht,rt,it,ut,ot,pt,ft,e,F,T,g,p=0,C=new r.Buf8(4),L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!x||!x.state||!x.output||!x.input&&x.avail_in!==0)return l;(a=x.state).mode===12&&(a.mode=13),tt=x.next_out,Q=x.output,J=x.avail_out,W=x.next_in,P=x.input,M=x.avail_in,A=a.hold,I=a.bits,K=M,G=J,F=w;t:for(;;)switch(a.mode){case m:if(a.wrap===0){a.mode=13;break}for(;I<16;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if(2&a.wrap&&A===35615){C[a.check=0]=255&A,C[1]=A>>>8&255,a.check=s(a.check,C,2,0),I=A=0,a.mode=2;break}if(a.flags=0,a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&A)<<8)+(A>>8))%31){x.msg="incorrect header check",a.mode=30;break}if((15&A)!=8){x.msg="unknown compression method",a.mode=30;break}if(I-=4,e=8+(15&(A>>>=4)),a.wbits===0)a.wbits=e;else if(e>a.wbits){x.msg="invalid window size",a.mode=30;break}a.dmax=1<<e,x.adler=a.check=1,a.mode=512&A?10:12,I=A=0;break;case 2:for(;I<16;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if(a.flags=A,(255&a.flags)!=8){x.msg="unknown compression method",a.mode=30;break}if(57344&a.flags){x.msg="unknown header flags set",a.mode=30;break}a.head&&(a.head.text=A>>8&1),512&a.flags&&(C[0]=255&A,C[1]=A>>>8&255,a.check=s(a.check,C,2,0)),I=A=0,a.mode=3;case 3:for(;I<32;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}a.head&&(a.head.time=A),512&a.flags&&(C[0]=255&A,C[1]=A>>>8&255,C[2]=A>>>16&255,C[3]=A>>>24&255,a.check=s(a.check,C,4,0)),I=A=0,a.mode=4;case 4:for(;I<16;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}a.head&&(a.head.xflags=255&A,a.head.os=A>>8),512&a.flags&&(C[0]=255&A,C[1]=A>>>8&255,a.check=s(a.check,C,2,0)),I=A=0,a.mode=5;case 5:if(1024&a.flags){for(;I<16;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}a.length=A,a.head&&(a.head.extra_len=A),512&a.flags&&(C[0]=255&A,C[1]=A>>>8&255,a.check=s(a.check,C,2,0)),I=A=0}else a.head&&(a.head.extra=null);a.mode=6;case 6:if(1024&a.flags&&(M<(X=a.length)&&(X=M),X&&(a.head&&(e=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Array(a.head.extra_len)),r.arraySet(a.head.extra,P,W,X,e)),512&a.flags&&(a.check=s(a.check,P,X,W)),M-=X,W+=X,a.length-=X),a.length))break t;a.length=0,a.mode=7;case 7:if(2048&a.flags){if(M===0)break t;for(X=0;e=P[W+X++],a.head&&e&&a.length<65536&&(a.head.name+=String.fromCharCode(e)),e&&X<M;);if(512&a.flags&&(a.check=s(a.check,P,X,W)),M-=X,W+=X,e)break t}else a.head&&(a.head.name=null);a.length=0,a.mode=8;case 8:if(4096&a.flags){if(M===0)break t;for(X=0;e=P[W+X++],a.head&&e&&a.length<65536&&(a.head.comment+=String.fromCharCode(e)),e&&X<M;);if(512&a.flags&&(a.check=s(a.check,P,X,W)),M-=X,W+=X,e)break t}else a.head&&(a.head.comment=null);a.mode=9;case 9:if(512&a.flags){for(;I<16;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if(A!==(65535&a.check)){x.msg="header crc mismatch",a.mode=30;break}I=A=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),x.adler=a.check=0,a.mode=12;break;case 10:for(;I<32;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}x.adler=a.check=c(A),I=A=0,a.mode=11;case 11:if(a.havedict===0)return x.next_out=tt,x.avail_out=J,x.next_in=W,x.avail_in=M,a.hold=A,a.bits=I,2;x.adler=a.check=1,a.mode=12;case 12:if(R===5||R===6)break t;case 13:if(a.last){A>>>=7&I,I-=7&I,a.mode=27;break}for(;I<3;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}switch(a.last=1&A,I-=1,3&(A>>>=1)){case 0:a.mode=14;break;case 1:if(Z(a),a.mode=20,R!==6)break;A>>>=2,I-=2;break t;case 2:a.mode=17;break;case 3:x.msg="invalid block type",a.mode=30}A>>>=2,I-=2;break;case 14:for(A>>>=7&I,I-=7&I;I<32;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if((65535&A)!=(A>>>16^65535)){x.msg="invalid stored block lengths",a.mode=30;break}if(a.length=65535&A,I=A=0,a.mode=15,R===6)break t;case 15:a.mode=16;case 16:if(X=a.length){if(M<X&&(X=M),J<X&&(X=J),X===0)break t;r.arraySet(Q,P,W,X,tt),M-=X,W+=X,J-=X,tt+=X,a.length-=X;break}a.mode=12;break;case 17:for(;I<14;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if(a.nlen=257+(31&A),A>>>=5,I-=5,a.ndist=1+(31&A),A>>>=5,I-=5,a.ncode=4+(15&A),A>>>=4,I-=4,286<a.nlen||30<a.ndist){x.msg="too many length or distance symbols",a.mode=30;break}a.have=0,a.mode=18;case 18:for(;a.have<a.ncode;){for(;I<3;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}a.lens[L[a.have++]]=7&A,A>>>=3,I-=3}for(;a.have<19;)a.lens[L[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,T={bits:a.lenbits},F=y(0,a.lens,0,19,a.lencode,0,a.work,T),a.lenbits=T.bits,F){x.msg="invalid code lengths set",a.mode=30;break}a.have=0,a.mode=19;case 19:for(;a.have<a.nlen+a.ndist;){for(;it=(p=a.lencode[A&(1<<a.lenbits)-1])>>>16&255,ut=65535&p,!((rt=p>>>24)<=I);){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if(ut<16)A>>>=rt,I-=rt,a.lens[a.have++]=ut;else{if(ut===16){for(g=rt+2;I<g;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if(A>>>=rt,I-=rt,a.have===0){x.msg="invalid bit length repeat",a.mode=30;break}e=a.lens[a.have-1],X=3+(3&A),A>>>=2,I-=2}else if(ut===17){for(g=rt+3;I<g;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}I-=rt,e=0,X=3+(7&(A>>>=rt)),A>>>=3,I-=3}else{for(g=rt+7;I<g;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}I-=rt,e=0,X=11+(127&(A>>>=rt)),A>>>=7,I-=7}if(a.have+X>a.nlen+a.ndist){x.msg="invalid bit length repeat",a.mode=30;break}for(;X--;)a.lens[a.have++]=e}}if(a.mode===30)break;if(a.lens[256]===0){x.msg="invalid code -- missing end-of-block",a.mode=30;break}if(a.lenbits=9,T={bits:a.lenbits},F=y(b,a.lens,0,a.nlen,a.lencode,0,a.work,T),a.lenbits=T.bits,F){x.msg="invalid literal/lengths set",a.mode=30;break}if(a.distbits=6,a.distcode=a.distdyn,T={bits:a.distbits},F=y(v,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,T),a.distbits=T.bits,F){x.msg="invalid distances set",a.mode=30;break}if(a.mode=20,R===6)break t;case 20:a.mode=21;case 21:if(6<=M&&258<=J){x.next_out=tt,x.avail_out=J,x.next_in=W,x.avail_in=M,a.hold=A,a.bits=I,h(x,G),tt=x.next_out,Q=x.output,J=x.avail_out,W=x.next_in,P=x.input,M=x.avail_in,A=a.hold,I=a.bits,a.mode===12&&(a.back=-1);break}for(a.back=0;it=(p=a.lencode[A&(1<<a.lenbits)-1])>>>16&255,ut=65535&p,!((rt=p>>>24)<=I);){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if(it&&(240&it)==0){for(ot=rt,pt=it,ft=ut;it=(p=a.lencode[ft+((A&(1<<ot+pt)-1)>>ot)])>>>16&255,ut=65535&p,!(ot+(rt=p>>>24)<=I);){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}A>>>=ot,I-=ot,a.back+=ot}if(A>>>=rt,I-=rt,a.back+=rt,a.length=ut,it===0){a.mode=26;break}if(32&it){a.back=-1,a.mode=12;break}if(64&it){x.msg="invalid literal/length code",a.mode=30;break}a.extra=15&it,a.mode=22;case 22:if(a.extra){for(g=a.extra;I<g;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}a.length+=A&(1<<a.extra)-1,A>>>=a.extra,I-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=23;case 23:for(;it=(p=a.distcode[A&(1<<a.distbits)-1])>>>16&255,ut=65535&p,!((rt=p>>>24)<=I);){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if((240&it)==0){for(ot=rt,pt=it,ft=ut;it=(p=a.distcode[ft+((A&(1<<ot+pt)-1)>>ot)])>>>16&255,ut=65535&p,!(ot+(rt=p>>>24)<=I);){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}A>>>=ot,I-=ot,a.back+=ot}if(A>>>=rt,I-=rt,a.back+=rt,64&it){x.msg="invalid distance code",a.mode=30;break}a.offset=ut,a.extra=15&it,a.mode=24;case 24:if(a.extra){for(g=a.extra;I<g;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}a.offset+=A&(1<<a.extra)-1,A>>>=a.extra,I-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){x.msg="invalid distance too far back",a.mode=30;break}a.mode=25;case 25:if(J===0)break t;if(X=G-J,a.offset>X){if((X=a.offset-X)>a.whave&&a.sane){x.msg="invalid distance too far back",a.mode=30;break}at=X>a.wnext?(X-=a.wnext,a.wsize-X):a.wnext-X,X>a.length&&(X=a.length),ht=a.window}else ht=Q,at=tt-a.offset,X=a.length;for(J<X&&(X=J),J-=X,a.length-=X;Q[tt++]=ht[at++],--X;);a.length===0&&(a.mode=21);break;case 26:if(J===0)break t;Q[tt++]=a.length,J--,a.mode=21;break;case 27:if(a.wrap){for(;I<32;){if(M===0)break t;M--,A|=P[W++]<<I,I+=8}if(G-=J,x.total_out+=G,a.total+=G,G&&(x.adler=a.check=a.flags?s(a.check,Q,G,tt-G):n(a.check,Q,G,tt-G)),G=J,(a.flags?A:c(A))!==a.check){x.msg="incorrect data check",a.mode=30;break}I=A=0}a.mode=28;case 28:if(a.wrap&&a.flags){for(;I<32;){if(M===0)break t;M--,A+=P[W++]<<I,I+=8}if(A!==(4294967295&a.total)){x.msg="incorrect length check",a.mode=30;break}I=A=0}a.mode=29;case 29:F=1;break t;case 30:F=-3;break t;case 31:return-4;case 32:default:return l}return x.next_out=tt,x.avail_out=J,x.next_in=W,x.avail_in=M,a.hold=A,a.bits=I,(a.wsize||G!==x.avail_out&&a.mode<30&&(a.mode<27||R!==4))&&V(x,x.output,x.next_out,G-x.avail_out)?(a.mode=31,-4):(K-=x.avail_in,G-=x.avail_out,x.total_in+=K,x.total_out+=G,a.total+=G,a.wrap&&G&&(x.adler=a.check=a.flags?s(a.check,Q,G,x.next_out-G):n(a.check,Q,G,x.next_out-G)),x.data_type=a.bits+(a.last?64:0)+(a.mode===12?128:0)+(a.mode===20||a.mode===15?256:0),(K==0&&G===0||R===4)&&F===w&&(F=-5),F)},o.inflateEnd=function(x){if(!x||!x.state)return l;var R=x.state;return R.window&&(R.window=null),x.state=null,w},o.inflateGetHeader=function(x,R){var a;return x&&x.state?(2&(a=x.state).wrap)==0?l:((a.head=R).done=!1,w):l},o.inflateSetDictionary=function(x,R){var a,P=R.length;return x&&x.state?(a=x.state).wrap!==0&&a.mode!==11?l:a.mode===11&&n(1,R,P,0)!==a.check?-3:V(x,R,P,P)?(a.mode=31,-4):(a.havedict=1,w):l},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,f,o){var r=t("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],h=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],y=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];f.exports=function(b,v,w,l,m,u,d,c){var _,k,E,S,O,D,U,B,Z,V=c.bits,x=0,R=0,a=0,P=0,Q=0,W=0,tt=0,M=0,J=0,A=0,I=null,K=0,G=new r.Buf16(16),X=new r.Buf16(16),at=null,ht=0;for(x=0;x<=15;x++)G[x]=0;for(R=0;R<l;R++)G[v[w+R]]++;for(Q=V,P=15;1<=P&&G[P]===0;P--);if(P<Q&&(Q=P),P===0)return m[u++]=20971520,m[u++]=20971520,c.bits=1,0;for(a=1;a<P&&G[a]===0;a++);for(Q<a&&(Q=a),x=M=1;x<=15;x++)if(M<<=1,(M-=G[x])<0)return-1;if(0<M&&(b===0||P!==1))return-1;for(X[1]=0,x=1;x<15;x++)X[x+1]=X[x]+G[x];for(R=0;R<l;R++)v[w+R]!==0&&(d[X[v[w+R]]++]=R);if(D=b===0?(I=at=d,19):b===1?(I=n,K-=257,at=s,ht-=257,256):(I=h,at=y,-1),x=a,O=u,tt=R=A=0,E=-1,S=(J=1<<(W=Q))-1,b===1&&852<J||b===2&&592<J)return 1;for(;;){for(U=x-tt,Z=d[R]<D?(B=0,d[R]):d[R]>D?(B=at[ht+d[R]],I[K+d[R]]):(B=96,0),_=1<<x-tt,a=k=1<<W;m[O+(A>>tt)+(k-=_)]=U<<24|B<<16|Z|0,k!==0;);for(_=1<<x-1;A&_;)_>>=1;if(_!==0?(A&=_-1,A+=_):A=0,R++,--G[x]==0){if(x===P)break;x=v[w+d[R]]}if(Q<x&&(A&S)!==E){for(tt===0&&(tt=Q),O+=a,M=1<<(W=x-tt);W+tt<P&&!((M-=G[W+tt])<=0);)W++,M<<=1;if(J+=1<<W,b===1&&852<J||b===2&&592<J)return 1;m[E=A&S]=Q<<24|W<<16|O-u|0}}return A!==0&&(m[O+A]=x-tt<<24|64<<16|0),c.bits=Q,0}},{"../utils/common":41}],51:[function(t,f,o){f.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,f,o){var r=t("../utils/common"),n=0,s=1;function h(p){for(var C=p.length;0<=--C;)p[C]=0}var y=0,b=29,v=256,w=v+1+b,l=30,m=19,u=2*w+1,d=15,c=16,_=7,k=256,E=16,S=17,O=18,D=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],U=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=new Array(2*(w+2));h(V);var x=new Array(2*l);h(x);var R=new Array(512);h(R);var a=new Array(256);h(a);var P=new Array(b);h(P);var Q,W,tt,M=new Array(l);function J(p,C,L,N,z){this.static_tree=p,this.extra_bits=C,this.extra_base=L,this.elems=N,this.max_length=z,this.has_stree=p&&p.length}function A(p,C){this.dyn_tree=p,this.max_code=0,this.stat_desc=C}function I(p){return p<256?R[p]:R[256+(p>>>7)]}function K(p,C){p.pending_buf[p.pending++]=255&C,p.pending_buf[p.pending++]=C>>>8&255}function G(p,C,L){p.bi_valid>c-L?(p.bi_buf|=C<<p.bi_valid&65535,K(p,p.bi_buf),p.bi_buf=C>>c-p.bi_valid,p.bi_valid+=L-c):(p.bi_buf|=C<<p.bi_valid&65535,p.bi_valid+=L)}function X(p,C,L){G(p,L[2*C],L[2*C+1])}function at(p,C){for(var L=0;L|=1&p,p>>>=1,L<<=1,0<--C;);return L>>>1}function ht(p,C,L){var N,z,$=new Array(d+1),q=0;for(N=1;N<=d;N++)$[N]=q=q+L[N-1]<<1;for(z=0;z<=C;z++){var H=p[2*z+1];H!==0&&(p[2*z]=at($[H]++,H))}}function rt(p){var C;for(C=0;C<w;C++)p.dyn_ltree[2*C]=0;for(C=0;C<l;C++)p.dyn_dtree[2*C]=0;for(C=0;C<m;C++)p.bl_tree[2*C]=0;p.dyn_ltree[2*k]=1,p.opt_len=p.static_len=0,p.last_lit=p.matches=0}function it(p){8<p.bi_valid?K(p,p.bi_buf):0<p.bi_valid&&(p.pending_buf[p.pending++]=p.bi_buf),p.bi_buf=0,p.bi_valid=0}function ut(p,C,L,N){var z=2*C,$=2*L;return p[z]<p[$]||p[z]===p[$]&&N[C]<=N[L]}function ot(p,C,L){for(var N=p.heap[L],z=L<<1;z<=p.heap_len&&(z<p.heap_len&&ut(C,p.heap[z+1],p.heap[z],p.depth)&&z++,!ut(C,N,p.heap[z],p.depth));)p.heap[L]=p.heap[z],L=z,z<<=1;p.heap[L]=N}function pt(p,C,L){var N,z,$,q,H=0;if(p.last_lit!==0)for(;N=p.pending_buf[p.d_buf+2*H]<<8|p.pending_buf[p.d_buf+2*H+1],z=p.pending_buf[p.l_buf+H],H++,N===0?X(p,z,C):(X(p,($=a[z])+v+1,C),(q=D[$])!==0&&G(p,z-=P[$],q),X(p,$=I(--N),L),(q=U[$])!==0&&G(p,N-=M[$],q)),H<p.last_lit;);X(p,k,C)}function ft(p,C){var L,N,z,$=C.dyn_tree,q=C.stat_desc.static_tree,H=C.stat_desc.has_stree,Y=C.stat_desc.elems,st=-1;for(p.heap_len=0,p.heap_max=u,L=0;L<Y;L++)$[2*L]!==0?(p.heap[++p.heap_len]=st=L,p.depth[L]=0):$[2*L+1]=0;for(;p.heap_len<2;)$[2*(z=p.heap[++p.heap_len]=st<2?++st:0)]=1,p.depth[z]=0,p.opt_len--,H&&(p.static_len-=q[2*z+1]);for(C.max_code=st,L=p.heap_len>>1;1<=L;L--)ot(p,$,L);for(z=Y;L=p.heap[1],p.heap[1]=p.heap[p.heap_len--],ot(p,$,1),N=p.heap[1],p.heap[--p.heap_max]=L,p.heap[--p.heap_max]=N,$[2*z]=$[2*L]+$[2*N],p.depth[z]=(p.depth[L]>=p.depth[N]?p.depth[L]:p.depth[N])+1,$[2*L+1]=$[2*N+1]=z,p.heap[1]=z++,ot(p,$,1),2<=p.heap_len;);p.heap[--p.heap_max]=p.heap[1],(function(nt,dt){var yt,mt,vt,lt,xt,zt,gt=dt.dyn_tree,Dt=dt.max_code,Ut=dt.stat_desc.static_tree,jt=dt.stat_desc.has_stree,Wt=dt.stat_desc.extra_bits,Rt=dt.stat_desc.extra_base,wt=dt.stat_desc.max_length,kt=0;for(lt=0;lt<=d;lt++)nt.bl_count[lt]=0;for(gt[2*nt.heap[nt.heap_max]+1]=0,yt=nt.heap_max+1;yt<u;yt++)wt<(lt=gt[2*gt[2*(mt=nt.heap[yt])+1]+1]+1)&&(lt=wt,kt++),gt[2*mt+1]=lt,Dt<mt||(nt.bl_count[lt]++,xt=0,Rt<=mt&&(xt=Wt[mt-Rt]),zt=gt[2*mt],nt.opt_len+=zt*(lt+xt),jt&&(nt.static_len+=zt*(Ut[2*mt+1]+xt)));if(kt!==0){do{for(lt=wt-1;nt.bl_count[lt]===0;)lt--;nt.bl_count[lt]--,nt.bl_count[lt+1]+=2,nt.bl_count[wt]--,kt-=2}while(0<kt);for(lt=wt;lt!==0;lt--)for(mt=nt.bl_count[lt];mt!==0;)Dt<(vt=nt.heap[--yt])||(gt[2*vt+1]!==lt&&(nt.opt_len+=(lt-gt[2*vt+1])*gt[2*vt],gt[2*vt+1]=lt),mt--)}})(p,C),ht($,st,p.bl_count)}function e(p,C,L){var N,z,$=-1,q=C[1],H=0,Y=7,st=4;for(q===0&&(Y=138,st=3),C[2*(L+1)+1]=65535,N=0;N<=L;N++)z=q,q=C[2*(N+1)+1],++H<Y&&z===q||(H<st?p.bl_tree[2*z]+=H:z!==0?(z!==$&&p.bl_tree[2*z]++,p.bl_tree[2*E]++):H<=10?p.bl_tree[2*S]++:p.bl_tree[2*O]++,$=z,st=(H=0)===q?(Y=138,3):z===q?(Y=6,3):(Y=7,4))}function F(p,C,L){var N,z,$=-1,q=C[1],H=0,Y=7,st=4;for(q===0&&(Y=138,st=3),N=0;N<=L;N++)if(z=q,q=C[2*(N+1)+1],!(++H<Y&&z===q)){if(H<st)for(;X(p,z,p.bl_tree),--H!=0;);else z!==0?(z!==$&&(X(p,z,p.bl_tree),H--),X(p,E,p.bl_tree),G(p,H-3,2)):H<=10?(X(p,S,p.bl_tree),G(p,H-3,3)):(X(p,O,p.bl_tree),G(p,H-11,7));$=z,st=(H=0)===q?(Y=138,3):z===q?(Y=6,3):(Y=7,4)}}h(M);var T=!1;function g(p,C,L,N){G(p,(y<<1)+(N?1:0),3),(function(z,$,q,H){it(z),K(z,q),K(z,~q),r.arraySet(z.pending_buf,z.window,$,q,z.pending),z.pending+=q})(p,C,L)}o._tr_init=function(p){T||((function(){var C,L,N,z,$,q=new Array(d+1);for(z=N=0;z<b-1;z++)for(P[z]=N,C=0;C<1<<D[z];C++)a[N++]=z;for(a[N-1]=z,z=$=0;z<16;z++)for(M[z]=$,C=0;C<1<<U[z];C++)R[$++]=z;for($>>=7;z<l;z++)for(M[z]=$<<7,C=0;C<1<<U[z]-7;C++)R[256+$++]=z;for(L=0;L<=d;L++)q[L]=0;for(C=0;C<=143;)V[2*C+1]=8,C++,q[8]++;for(;C<=255;)V[2*C+1]=9,C++,q[9]++;for(;C<=279;)V[2*C+1]=7,C++,q[7]++;for(;C<=287;)V[2*C+1]=8,C++,q[8]++;for(ht(V,w+1,q),C=0;C<l;C++)x[2*C+1]=5,x[2*C]=at(C,5);Q=new J(V,D,v+1,w,d),W=new J(x,U,0,l,d),tt=new J(new Array(0),B,0,m,_)})(),T=!0),p.l_desc=new A(p.dyn_ltree,Q),p.d_desc=new A(p.dyn_dtree,W),p.bl_desc=new A(p.bl_tree,tt),p.bi_buf=0,p.bi_valid=0,rt(p)},o._tr_stored_block=g,o._tr_flush_block=function(p,C,L,N){var z,$,q=0;0<p.level?(p.strm.data_type===2&&(p.strm.data_type=(function(H){var Y,st=4093624447;for(Y=0;Y<=31;Y++,st>>>=1)if(1&st&&H.dyn_ltree[2*Y]!==0)return n;if(H.dyn_ltree[18]!==0||H.dyn_ltree[20]!==0||H.dyn_ltree[26]!==0)return s;for(Y=32;Y<v;Y++)if(H.dyn_ltree[2*Y]!==0)return s;return n})(p)),ft(p,p.l_desc),ft(p,p.d_desc),q=(function(H){var Y;for(e(H,H.dyn_ltree,H.l_desc.max_code),e(H,H.dyn_dtree,H.d_desc.max_code),ft(H,H.bl_desc),Y=m-1;3<=Y&&H.bl_tree[2*Z[Y]+1]===0;Y--);return H.opt_len+=3*(Y+1)+5+5+4,Y})(p),z=p.opt_len+3+7>>>3,($=p.static_len+3+7>>>3)<=z&&(z=$)):z=$=L+5,L+4<=z&&C!==-1?g(p,C,L,N):p.strategy===4||$===z?(G(p,2+(N?1:0),3),pt(p,V,x)):(G(p,4+(N?1:0),3),(function(H,Y,st,nt){var dt;for(G(H,Y-257,5),G(H,st-1,5),G(H,nt-4,4),dt=0;dt<nt;dt++)G(H,H.bl_tree[2*Z[dt]+1],3);F(H,H.dyn_ltree,Y-1),F(H,H.dyn_dtree,st-1)})(p,p.l_desc.max_code+1,p.d_desc.max_code+1,q+1),pt(p,p.dyn_ltree,p.dyn_dtree)),rt(p),N&&it(p)},o._tr_tally=function(p,C,L){return p.pending_buf[p.d_buf+2*p.last_lit]=C>>>8&255,p.pending_buf[p.d_buf+2*p.last_lit+1]=255&C,p.pending_buf[p.l_buf+p.last_lit]=255&L,p.last_lit++,C===0?p.dyn_ltree[2*L]++:(p.matches++,C--,p.dyn_ltree[2*(a[L]+v+1)]++,p.dyn_dtree[2*I(C)]++),p.last_lit===p.lit_bufsize-1},o._tr_align=function(p){G(p,2,3),X(p,k,V),(function(C){C.bi_valid===16?(K(C,C.bi_buf),C.bi_buf=0,C.bi_valid=0):8<=C.bi_valid&&(C.pending_buf[C.pending++]=255&C.bi_buf,C.bi_buf>>=8,C.bi_valid-=8)})(p)}},{"../utils/common":41}],53:[function(t,f,o){f.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,f,o){(function(r){(function(n,s){if(!n.setImmediate){var h,y,b,v,w=1,l={},m=!1,u=n.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(n);d=d&&d.setTimeout?d:n,h={}.toString.call(n.process)==="[object process]"?function(E){process.nextTick(function(){_(E)})}:(function(){if(n.postMessage&&!n.importScripts){var E=!0,S=n.onmessage;return n.onmessage=function(){E=!1},n.postMessage("","*"),n.onmessage=S,E}})()?(v="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",k,!1):n.attachEvent("onmessage",k),function(E){n.postMessage(v+E,"*")}):n.MessageChannel?((b=new MessageChannel).port1.onmessage=function(E){_(E.data)},function(E){b.port2.postMessage(E)}):u&&"onreadystatechange"in u.createElement("script")?(y=u.documentElement,function(E){var S=u.createElement("script");S.onreadystatechange=function(){_(E),S.onreadystatechange=null,y.removeChild(S),S=null},y.appendChild(S)}):function(E){setTimeout(_,0,E)},d.setImmediate=function(E){typeof E!="function"&&(E=new Function(""+E));for(var S=new Array(arguments.length-1),O=0;O<S.length;O++)S[O]=arguments[O+1];var D={callback:E,args:S};return l[w]=D,h(w),w++},d.clearImmediate=c}function c(E){delete l[E]}function _(E){if(m)setTimeout(_,0,E);else{var S=l[E];if(S){m=!0;try{(function(O){var D=O.callback,U=O.args;switch(U.length){case 0:D();break;case 1:D(U[0]);break;case 2:D(U[0],U[1]);break;case 3:D(U[0],U[1],U[2]);break;default:D.apply(s,U)}})(S)}finally{c(E),m=!1}}}}function k(E){E.source===n&&typeof E.data=="string"&&E.data.indexOf(v)===0&&_(+E.data.slice(v.length))}})(typeof self>"u"?r===void 0?this:r:self)}).call(this,typeof Et<"u"?Et:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(It)),It.exports}var Gt=Xt();const Lt=Ht(Gt);class qt{constructor(){et(this,"scriptLoaded",!1);this.ensureScriptLoaded()}ensureScriptLoaded(){if(this.scriptLoaded)return;if(typeof window.officeParser<"u"){this.scriptLoaded=!0;return}if(document.querySelector('script[src="/officeparser.browser.js"]')){this.scriptLoaded=!0;return}throw new Error('officeparser.browser.js not loaded. Add <script src="/officeparser.browser.js"><\/script> to index.html')}async parseFile(i){this.ensureScriptLoaded();const t=await i.arrayBuffer(),f=await window.officeParser.parseOffice(t),o=await this.extractSectionProperties(t),r=this.normalizeAST(f);return r.sectionProperties=o,r}async extractSectionProperties(i){try{const f=await(await Lt.loadAsync(i)).file("word/document.xml")?.async("string");if(!f)return{};const n=new DOMParser().parseFromString(f,"application/xml").getElementsByTagName("w:sectPr");if(n.length===0)return{};const h=n[n.length-1].getElementsByTagName("w:cols");if(h.length===0)return{};const y=h[0],b=y.getAttribute("w:num"),v=y.getAttribute("w:space"),w={};return b&&(w.columnCount=parseInt(b,10)),v&&(w.columnSpace=parseInt(v,10)),w}catch(t){return console.warn("Failed to extract section properties:",t),{}}}normalizeAST(i){const t=[],f={author:i.author||void 0,title:i.title||void 0,created:i.created?new Date(i.created):void 0,modified:i.modified?new Date(i.modified):void 0};return Array.isArray(i.content)&&i.content.forEach((o,r)=>{if(o.type&&o.type!=="paragraph"&&o.type!=="heading"&&o.type!=="table"&&console.log(`[DocxParser] Unhandled item type at index ${r}:`,o.type,o),o.type==="paragraph"||o.type==="heading"){const n=this.normalizeParagraph(o,r);n&&t.push(n)}else if(o.type==="table"){const n=this.normalizeTable(o,r);n&&t.push(n)}else(o.type==="page-break"||o.type==="break")&&t.push({id:`page-break-${r}`,type:"page-break",text:"",runs:[],formatting:{}})}),{metadata:f,blocks:t}}normalizeParagraph(i,t){let f="paragraph";if(i.style){const n=i.style.toLowerCase();n.includes("heading1")||n.includes("heading 1")?f="heading1":n.includes("heading2")||n.includes("heading 2")?f="heading2":(n.includes("heading3")||n.includes("heading 3"))&&(f="heading3")}let o=i.text||"";const r=[];if(Array.isArray(i.runs)&&i.runs.length>0&&(i.runs.forEach(n=>{const s=n.text||"";s&&r.push({text:s,formatting:this.extractFormatting(n)})}),o=r.map(n=>n.text).join("").trim().replace(/\s+/g," ")),r.length===0&&o){const n=o.trim().replace(/\s+/g," ");r.push({text:n,formatting:this.extractFormatting(i)}),o=n}return o.trim()?{id:this.generateBlockId(o,t),type:f,text:o.trim().replace(/\s+/g," "),runs:r,formatting:this.extractFormatting(i)}:null}normalizeTable(i,t){let f="";if(Array.isArray(i.rows)&&i.rows.forEach(r=>{if(Array.isArray(r.cells)){const n=r.cells.map(s=>s.text||"").filter(s=>s.trim());n.length>0&&(f+=n.join(" | ")+`
`)}}),!f.trim())return null;const o=f.trim().replace(/\s+/g," ");return{id:this.generateBlockId(o,t),type:"table",text:o,runs:[{text:o,formatting:{}}],formatting:{}}}extractFormatting(i){const t={};return i.bold===!0&&(t.bold=!0),i.italic===!0&&(t.italic=!0),i.underline===!0&&(t.underline=!0),i.color&&(t.color=i.color),i.font&&(t.font=i.font),i.fontSize&&(t.fontSize=i.fontSize),t}generateBlockId(i,t){const f=this.simpleHash(i.substring(0,100));return`block-${t}-${f}`}simpleHash(i){let t=0;for(let f=0;f<i.length;f++){const o=i.charCodeAt(f);t=(t<<5)-t+o,t=t&t}return Math.abs(t).toString(36)}terminate(){}}function _t(){}_t.prototype={diff:function(i,t){var f,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=o.callback;typeof o=="function"&&(r=o,o={}),this.options=o;var n=this;function s(E){return r?(setTimeout(function(){r(void 0,E)},0),!0):E}i=this.castInput(i),t=this.castInput(t),i=this.removeEmpty(this.tokenize(i)),t=this.removeEmpty(this.tokenize(t));var h=t.length,y=i.length,b=1,v=h+y;o.maxEditLength&&(v=Math.min(v,o.maxEditLength));var w=(f=o.timeout)!==null&&f!==void 0?f:1/0,l=Date.now()+w,m=[{oldPos:-1,lastComponent:void 0}],u=this.extractCommon(m[0],t,i,0);if(m[0].oldPos+1>=y&&u+1>=h)return s([{value:this.join(t),count:t.length}]);var d=-1/0,c=1/0;function _(){for(var E=Math.max(d,-b);E<=Math.min(c,b);E+=2){var S=void 0,O=m[E-1],D=m[E+1];O&&(m[E-1]=void 0);var U=!1;if(D){var B=D.oldPos-E;U=D&&0<=B&&B<h}var Z=O&&O.oldPos+1<y;if(!U&&!Z){m[E]=void 0;continue}if(!Z||U&&O.oldPos+1<D.oldPos?S=n.addToPath(D,!0,void 0,0):S=n.addToPath(O,void 0,!0,1),u=n.extractCommon(S,t,i,E),S.oldPos+1>=y&&u+1>=h)return s(Yt(n,S.lastComponent,t,i,n.useLongestToken));m[E]=S,S.oldPos+1>=y&&(c=Math.min(c,E-1)),u+1>=h&&(d=Math.max(d,E+1))}b++}if(r)(function E(){setTimeout(function(){if(b>v||Date.now()>l)return r();_()||E()},0)})();else for(;b<=v&&Date.now()<=l;){var k=_();if(k)return k}},addToPath:function(i,t,f,o){var r=i.lastComponent;return r&&r.added===t&&r.removed===f?{oldPos:i.oldPos+o,lastComponent:{count:r.count+1,added:t,removed:f,previousComponent:r.previousComponent}}:{oldPos:i.oldPos+o,lastComponent:{count:1,added:t,removed:f,previousComponent:r}}},extractCommon:function(i,t,f,o){for(var r=t.length,n=f.length,s=i.oldPos,h=s-o,y=0;h+1<r&&s+1<n&&this.equals(t[h+1],f[s+1]);)h++,s++,y++;return y&&(i.lastComponent={count:y,previousComponent:i.lastComponent}),i.oldPos=s,h},equals:function(i,t){return this.options.comparator?this.options.comparator(i,t):i===t||this.options.ignoreCase&&i.toLowerCase()===t.toLowerCase()},removeEmpty:function(i){for(var t=[],f=0;f<i.length;f++)i[f]&&t.push(i[f]);return t},castInput:function(i){return i},tokenize:function(i){return i.split("")},join:function(i){return i.join("")}};function Yt(j,i,t,f,o){for(var r=[],n;i;)r.push(i),n=i.previousComponent,delete i.previousComponent,i=n;r.reverse();for(var s=0,h=r.length,y=0,b=0;s<h;s++){var v=r[s];if(v.removed){if(v.value=j.join(f.slice(b,b+v.count)),b+=v.count,s&&r[s-1].added){var l=r[s-1];r[s-1]=r[s],r[s]=l}}else{if(!v.added&&o){var w=t.slice(y,y+v.count);w=w.map(function(u,d){var c=f[b+d];return c.length>u.length?c:u}),v.value=j.join(w)}else v.value=j.join(t.slice(y,y+v.count));y+=v.count,v.added||(b+=v.count)}}var m=r[h-1];return h>1&&typeof m.value=="string"&&(m.added||m.removed)&&j.equals("",m.value)&&(r[h-2].value+=m.value,r.pop()),r}function Kt(j,i){if(typeof j=="function")i.callback=j;else if(j)for(var t in j)j.hasOwnProperty(t)&&(i[t]=j[t]);return i}var Ft=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,Pt=/\S/,Bt=new _t;Bt.equals=function(j,i){return this.options.ignoreCase&&(j=j.toLowerCase(),i=i.toLowerCase()),j===i||this.options.ignoreWhitespace&&!Pt.test(j)&&!Pt.test(i)};Bt.tokenize=function(j){for(var i=j.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),t=0;t<i.length-1;t++)!i[t+1]&&i[t+2]&&Ft.test(i[t])&&Ft.test(i[t+2])&&(i[t]+=i[t+2],i.splice(t+1,2),t--);return i};function Vt(j,i,t){return t=Kt(t,{ignoreWhitespace:!0}),Bt.diff(j,i,t)}var Nt=new _t;Nt.tokenize=function(j){this.options.stripTrailingCr&&(j=j.replace(/\r\n/g,`
`));var i=[],t=j.split(/(\n|\r\n)/);t[t.length-1]||t.pop();for(var f=0;f<t.length;f++){var o=t[f];f%2&&!this.options.newlineIsToken?i[i.length-1]+=o:(this.options.ignoreWhitespace&&(o=o.trim()),i.push(o))}return i};var Jt=new _t;Jt.tokenize=function(j){return j.split(/(\S.+?[.!?])(?=\s+|$)/)};var Qt=new _t;Qt.tokenize=function(j){return j.split(/([{}:;,]|\s+)/)};function St(j){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?St=function(i){return typeof i}:St=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},St(j)}var te=Object.prototype.toString,bt=new _t;bt.useLongestToken=!0;bt.tokenize=Nt.tokenize;bt.castInput=function(j){var i=this.options,t=i.undefinedReplacement,f=i.stringifyReplacer,o=f===void 0?function(r,n){return typeof n>"u"?t:n}:f;return typeof j=="string"?j:JSON.stringify(At(j,null,null,o),o,"  ")};bt.equals=function(j,i){return _t.prototype.equals.call(bt,j.replace(/,([\r\n])/g,"$1"),i.replace(/,([\r\n])/g,"$1"))};function At(j,i,t,f,o){i=i||[],t=t||[],f&&(j=f(o,j));var r;for(r=0;r<i.length;r+=1)if(i[r]===j)return t[r];var n;if(te.call(j)==="[object Array]"){for(i.push(j),n=new Array(j.length),t.push(n),r=0;r<j.length;r+=1)n[r]=At(j[r],i,t,f,o);return i.pop(),t.pop(),n}if(j&&j.toJSON&&(j=j.toJSON()),St(j)==="object"&&j!==null){i.push(j),n={},t.push(n);var s=[],h;for(h in j)j.hasOwnProperty(h)&&s.push(h);for(s.sort(),r=0;r<s.length;r+=1)h=s[r],n[h]=At(j[h],i,t,f,h);i.pop(),t.pop()}else n=j;return n}var Tt=new _t;Tt.tokenize=function(j){return j.slice()};Tt.join=Tt.removeEmpty=function(j){return j};class ee{constructor(){et(this,"debugMode",!1)}setDebugMode(i){this.debugMode=i}isDebugMode(){return this.debugMode}diffDocuments(i,t){return this.diffDocumentsWithDebug(i,t).diff}diffDocumentsWithDebug(i,t){const{alignment:f,decisions:o}=this.alignBlocks(i.blocks,t.blocks),r=[];let n=0;return f.forEach(([h,y])=>{if(!h&&y)r.push({type:"insert",currentBlock:y,changeId:`change-${n++}`});else if(h&&!y)r.push({type:"delete",originalBlock:h,changeId:`change-${n++}`});else if(h&&y)if(h.text===y.text&&this.formatingsEqual(h.formatting,y.formatting))r.push({type:"unchanged",originalBlock:h,currentBlock:y});else{const b=Vt(h.text,y.text),v=this.diffFormatting(h,y,b),w=b.some(l=>l.added||l.removed)||v.some(l=>l.type==="format-change");r.push({type:w?"modify":"unchanged",originalBlock:h,currentBlock:y,wordDiff:b,formatDiff:v,changeId:w?`change-${n++}`:void 0})}}),{diff:{blockDiffs:r,totalChanges:n,sectionProperties:t.sectionProperties},alignmentDecisions:o}}alignBlocks(i,t){const f=[],o=[],r=l=>l.trim().replace(/\s+/g," "),n=l=>r(l.text),s=l=>l.substring(0,100),h=(l,m)=>{const u=r(l.text),d=r(m.text);if(u===d)return 1;if(!u||!d)return 0;const c=u.split(/\s+/),_=d.split(/\s+/),k=new Set(c),E=new Set(_);let S=0;return k.forEach(O=>{E.has(O)&&S++}),2*S/(k.size+E.size)},y=new Map;t.forEach(l=>{const m=n(l);y.has(m)||y.set(m,[]),y.get(m).push(l)});const b=new Set,v=[];i.forEach((l,m)=>{const u=n(l),d=y.get(u)||[];let c=!1;for(let _=0;_<d.length;_++){const k=t.indexOf(d[_]);if(!b.has(k)){f.push([l,d[_]]),b.add(k),c=!0,o.push({originalIndex:m,currentIndex:k,matchType:"exact",similarityScore:1,reason:"Exact text match after whitespace normalization",originalPreview:s(l.text),currentPreview:s(d[_].text)});break}}c||v.push({block:l,index:m})});const w=.5;return v.forEach(({block:l,index:m})=>{let u=null;if(t.forEach((d,c)=>{if(b.has(c))return;const _=h(l,d);_>=w&&(!u||_>u.similarity)&&(u={block:d,index:c,similarity:_})}),u){const d=u;f.push([l,d.block]),b.add(d.index),o.push({originalIndex:m,currentIndex:d.index,matchType:"fuzzy",similarityScore:d.similarity,reason:`Fuzzy match: ${(d.similarity*100).toFixed(1)}% word overlap (threshold: ${w*100}%)`,originalPreview:s(l.text),currentPreview:s(d.block.text)})}else{f.push([l,null]);let d=0,c=null;t.forEach((k,E)=>{if(b.has(E))return;const S=h(l,k);S>d&&(d=S,c=E)});const _=c!==null?`No match found. Best candidate had ${(d*100).toFixed(1)}% similarity (below ${w*100}% threshold)`:"No match found. No unmatched candidates remaining";o.push({originalIndex:m,currentIndex:null,matchType:"delete",similarityScore:d>0?d:void 0,reason:_,originalPreview:s(l.text)})}}),t.forEach((l,m)=>{b.has(m)||(f.push([null,l]),o.push({originalIndex:null,currentIndex:m,matchType:"insert",reason:"No matching block in original document",currentPreview:s(l.text)}))}),f.sort((l,m)=>{const u=l[0]?i.indexOf(l[0]):1/0,d=m[0]?i.indexOf(m[0]):1/0;if(u!==d)return u-d;const c=l[1]?t.indexOf(l[1]):1/0,_=m[1]?t.indexOf(m[1]):1/0;return c-_}),{alignment:f,decisions:o}}diffFormatting(i,t,f){const o=[];return f.forEach(r=>{if(r.added)o.push({type:"insert",text:r.value,formatting:t.formatting});else if(r.removed)o.push({type:"delete",text:r.value,formatting:i.formatting});else{const n=this.compareFormatting(i.formatting,t.formatting);n.changed?o.push({type:"format-change",text:r.value,from:i.formatting,to:t.formatting,changes:n.changes}):o.push({type:"unchanged",text:r.value,formatting:i.formatting})}}),o}compareFormatting(i,t){const f={};let o=!1;return["bold","italic","underline","color","font","fontSize"].forEach(n=>{i[n]!==t[n]&&(f[n]={from:i[n],to:t[n]},o=!0)}),{changed:o,changes:f}}formatingsEqual(i,t){return i.bold===t.bold&&i.italic===t.italic&&i.underline===t.underline&&i.color===t.color&&i.font===t.font&&i.fontSize===t.fontSize}}class re{constructor(i){et(this,"redlinedPane");et(this,"changeElements",[]);const t=document.getElementById(i);if(!t)throw new Error("Redlined pane not found");this.redlinedPane=t}renderRedlined(i){this.changeElements=[];const t=[];i.blockDiffs.forEach(f=>{t.push(this.renderRedlinedBlock(f))}),this.applyColumnStyling(this.redlinedPane,i.sectionProperties),this.redlinedPane.innerHTML=t.join(""),this.collectChangeElements()}applyColumnStyling(i,t){if(t?.columnCount&&t.columnCount>1){const f=t.columnSpace?Math.round(t.columnSpace/1440*96):24;i.style.columnCount=String(t.columnCount),i.style.columnGap=`${f}px`}else i.style.columnCount="",i.style.columnGap=""}renderRedlinedBlock(i){const t=i.changeId?` data-change-id="${i.changeId}"`:"";switch(i.type){case"insert":return this.renderBlock(i.currentBlock,"inserted",t);case"delete":return this.renderBlock(i.originalBlock,"deleted",t);case"modify":return this.renderRedlinedModifiedBlock(i,t);case"unchanged":return this.renderBlock(i.currentBlock,"unchanged","");default:return""}}renderBlock(i,t,f){if(i.type==="page-break")return`<div class="block block-page-break ${t==="inserted"?"block-inserted":t==="deleted"?"block-deleted":"block-unchanged"}"${f}>
        <div class="page-break-indicator">
          <span> Page Break </span>
        </div>
      </div>`;const o=t==="inserted"?"block-inserted":t==="deleted"?"block-deleted":"block-unchanged",r=`para-${i.type}`;let n="";return i.runs&&i.runs.length>0?n=i.runs.map(s=>this.renderFormattedText(s.text,s.formatting)).join(""):n=this.escapeHtml(i.text),`<div class="block ${o} ${r}"${f}>${n}</div>`}renderRedlinedModifiedBlock(i,t){if(!i.wordDiff)return this.renderBlock(i.currentBlock,"unchanged",t);const f=i.currentBlock;let r=`<div class="block block-modified ${`para-${f.type}`}"${t}>`;return i.wordDiff.forEach(n=>{if(n.removed){const s=i.originalBlock,h=this.renderFormattedText(n.value,s.formatting);r+=`<span class="diff-delete">${h}</span>`}else if(n.added){const s=this.renderFormattedText(n.value,f.formatting);r+=`<span class="diff-insert">${s}</span>`}else r+=this.renderFormattedText(n.value,f.formatting)}),r+="</div>",r}renderFormattedText(i,t){let f=this.escapeHtml(i);t.bold&&(f=`<strong>${f}</strong>`),t.italic&&(f=`<em>${f}</em>`),t.underline&&(f=`<u>${f}</u>`);const o=[];return t.color&&o.push(`color: ${t.color}`),t.font&&o.push(`font-family: ${t.font}`),t.fontSize&&o.push(`font-size: ${t.fontSize}pt`),o.length>0&&(f=`<span style="${o.join("; ")}">${f}</span>`),f}escapeHtml(i){const t=document.createElement("div");return t.textContent=i,t.innerHTML}collectChangeElements(){this.changeElements=Array.from(this.redlinedPane.querySelectorAll("[data-change-id]"))}getChangeElements(){return this.changeElements}}class ne{constructor(i,t,f,o){et(this,"changeElements");et(this,"currentIndex",-1);et(this,"prevButton");et(this,"nextButton");et(this,"counterElement");this.changeElements=i;const r=document.getElementById(t),n=document.getElementById(f),s=document.getElementById(o);if(!r||!n||!s)throw new Error("Navigation elements not found");this.prevButton=r,this.nextButton=n,this.counterElement=s,this.setupListeners(),this.updateUI()}setupListeners(){this.prevButton.addEventListener("click",()=>this.goToPrevious()),this.nextButton.addEventListener("click",()=>this.goToNext()),document.addEventListener("keydown",i=>{i.key==="n"&&!this.isInputFocused()?(i.preventDefault(),this.goToNext()):i.key==="p"&&!this.isInputFocused()&&(i.preventDefault(),this.goToPrevious())})}isInputFocused(){const i=document.activeElement;return i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement}goToNext(){this.currentIndex<this.changeElements.length-1?this.navigateToIndex(this.currentIndex+1):this.changeElements.length>0&&this.navigateToIndex(0)}goToPrevious(){this.currentIndex>0?this.navigateToIndex(this.currentIndex-1):this.changeElements.length>0&&this.navigateToIndex(this.changeElements.length-1)}navigateToIndex(i){this.currentIndex>=0&&this.currentIndex<this.changeElements.length&&this.changeElements[this.currentIndex].classList.remove("change-highlight"),this.currentIndex=i;const t=this.changeElements[this.currentIndex];t.classList.add("change-highlight"),t.scrollIntoView({behavior:"smooth",block:"center"}),this.updateUI()}updateUI(){const i=this.changeElements.length;if(i===0)this.counterElement.textContent="No changes",this.prevButton.disabled=!0,this.nextButton.disabled=!0;else{const t=this.currentIndex+1;this.counterElement.textContent=`${t} of ${i} changes`,this.prevButton.disabled=!1,this.nextButton.disabled=!1}}reset(){this.changeElements.forEach(i=>i.classList.remove("change-highlight")),this.currentIndex=-1,this.updateUI()}updateChangeElements(i){this.changeElements=i,this.reset(),i.length>0?this.navigateToIndex(0):this.updateUI()}}const ct={w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"};class ie{constructor(){et(this,"zip",null);et(this,"documentXml",null);et(this,"comments",[]);et(this,"nextCommentId",0);et(this,"nextRevisionId",0);et(this,"author","Document Comparison");et(this,"date",new Date().toISOString())}async export(i,t,f){this.zip=await Lt.loadAsync(t);const o=await this.zip.file("word/document.xml")?.async("string");if(!o)throw new Error("Invalid DOCX: missing word/document.xml");const r=new DOMParser;this.documentXml=r.parseFromString(o,"application/xml"),this.comments=[],this.nextCommentId=0,this.nextRevisionId=0,this.date=new Date().toISOString();const n=Array.from(this.documentXml.getElementsByTagName("w:p"));this.processBlockDiffs(i.blockDiffs,n);const h=new XMLSerializer().serializeToString(this.documentXml);this.zip.file("word/document.xml",h),this.comments.length>0&&await this.addCommentsToZip();const y=await this.zip.generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});this.downloadBlob(y,`${this.getBaseName(f)}_redlined.docx`)}processBlockDiffs(i,t){const f=new Set,o=new Map;for(const r of i){if(r.type==="delete")continue;const n=r.currentBlock;if(!n||n.type==="page-break")continue;const s=this.matchBlockToParagraph(n,t,f);s&&(f.add(s),o.set(r,s))}for(let r=0;r<i.length;r++){const n=i[r];if(n.type==="unchanged")continue;if(n.type==="delete"){const y=n.originalBlock;if(!y||y.type==="page-break")continue;let b=null;for(let v=r+1;v<i.length;v++){const w=i[v];if(w.type!=="delete"&&(b=o.get(w)||null,b))break}this.insertDeletedParagraph(y,b);continue}const s=o.get(n);if(!s)continue;const h=n.currentBlock;switch(n.type){case"insert":this.markParagraphAsInserted(s,h);break;case"modify":this.applyWordLevelChanges(s,n);break}}}matchBlockToParagraph(i,t,f){const o=this.normalizeText(i.text);for(const r of t){if(f.has(r))continue;if(this.normalizeText(this.getParagraphText(r))===o)return r}for(const r of t){if(f.has(r))continue;const n=this.normalizeText(this.getParagraphText(r));if(n.length>0&&o.length>0){if(n.includes(o)||o.includes(n))return r;const s=Math.min(n.length,o.length,30);if(s>10&&n.substring(0,s)===o.substring(0,s))return r}}return null}getParagraphText(i){const t=i.getElementsByTagName("w:t");let f="";for(let o=0;o<t.length;o++)f+=t[o].textContent||"";return f}normalizeText(i){return i.trim().replace(/\s+/g," ").toLowerCase()}markParagraphAsInserted(i,t){const f=this.addComment(`Added: New ${t.type}`),o=Array.from(i.getElementsByTagName("w:r"));if(o.length===0)return;const r=o[0],n=this.createCommentRangeStart(f);r.parentNode?.insertBefore(n,r);for(const b of o)this.applyInsertionFormatting(b);const s=o[o.length-1],h=this.createCommentRangeEnd(f),y=this.createCommentReference(f);s.parentNode?.insertBefore(h,s.nextSibling),h.parentNode?.insertBefore(y,h.nextSibling)}insertDeletedParagraph(i,t){const f=this.documentXml?.getElementsByTagName("w:body")[0];if(!f)return;const o=this.addComment(`Removed: Deleted ${i.type}`),r=this.documentXml.createElementNS(ct.w,"w:p");r.appendChild(this.createCommentRangeStart(o));const n=this.createDelElement(),s=this.createRunWithText(i.text,!0);if(n.appendChild(s),r.appendChild(n),r.appendChild(this.createCommentRangeEnd(o)),r.appendChild(this.createCommentReference(o)),t)t.parentNode?.insertBefore(r,t);else{const h=f.getElementsByTagName("w:sectPr")[0];h?f.insertBefore(r,h):f.appendChild(r)}}applyWordLevelChanges(i,t){if(!t.wordDiff||t.wordDiff.length===0)return;const f=i.getElementsByTagName("w:pPr")[0];for(;i.firstChild;)i.removeChild(i.firstChild);f&&i.appendChild(f);for(const o of t.wordDiff)if(o.added){const r=this.addComment(`Added: "${o.value.trim()}"`);i.appendChild(this.createCommentRangeStart(r));const n=this.createRunWithText(o.value,!1,!0);i.appendChild(n),i.appendChild(this.createCommentRangeEnd(r)),i.appendChild(this.createCommentReference(r))}else if(o.removed){const r=this.addComment(`Removed: "${o.value.trim()}"`);i.appendChild(this.createCommentRangeStart(r));const n=this.createDelElement(),s=this.createRunWithText(o.value,!0);n.appendChild(s),i.appendChild(n),i.appendChild(this.createCommentRangeEnd(r)),i.appendChild(this.createCommentReference(r))}else{const r=this.createRunWithText(o.value,!1,!1);i.appendChild(r)}}createDelElement(){const i=this.documentXml.createElementNS(ct.w,"w:del");return i.setAttribute("w:id",String(this.nextRevisionId++)),i.setAttribute("w:author",this.author),i.setAttribute("w:date",this.date),i}createRunWithText(i,t,f=!1){const o=this.documentXml.createElementNS(ct.w,"w:r"),r=this.documentXml.createElementNS(ct.w,"w:rPr");if(t){const s=this.documentXml.createElementNS(ct.w,"w:color");s.setAttribute("w:val","FF0000"),r.appendChild(s);const h=this.documentXml.createElementNS(ct.w,"w:strike");r.appendChild(h)}else if(f){const s=this.documentXml.createElementNS(ct.w,"w:highlight");s.setAttribute("w:val","yellow"),r.appendChild(s)}o.appendChild(r);const n=this.documentXml.createElementNS(ct.w,t?"w:delText":"w:t");return n.setAttribute("xml:space","preserve"),n.textContent=i,o.appendChild(n),o}applyInsertionFormatting(i){let t=i.getElementsByTagName("w:rPr")[0];t||(t=this.documentXml.createElementNS(ct.w,"w:rPr"),i.insertBefore(t,i.firstChild));let f=t.getElementsByTagName("w:highlight")[0];f||(f=this.documentXml.createElementNS(ct.w,"w:highlight"),t.appendChild(f)),f.setAttribute("w:val","yellow")}createCommentRangeStart(i){const t=this.documentXml.createElementNS(ct.w,"w:commentRangeStart");return t.setAttribute("w:id",String(i)),t}createCommentRangeEnd(i){const t=this.documentXml.createElementNS(ct.w,"w:commentRangeEnd");return t.setAttribute("w:id",String(i)),t}createCommentReference(i){const t=this.documentXml.createElementNS(ct.w,"w:r"),f=this.documentXml.createElementNS(ct.w,"w:commentReference");return f.setAttribute("w:id",String(i)),t.appendChild(f),t}addComment(i){const t=this.nextCommentId++;return this.comments.push({id:t,text:i}),t}async addCommentsToZip(){const i=this.buildCommentsXml();this.zip.file("word/comments.xml",i),await this.updateRelationships(),await this.updateContentTypes()}buildCommentsXml(){return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:comments xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main"
            xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"
            xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006">
${this.comments.map(t=>`
    <w:comment w:id="${t.id}" w:author="${this.author}" w:date="${this.date}">
      <w:p>
        <w:r>
          <w:t>${this.escapeXml(t.text)}</w:t>
        </w:r>
      </w:p>
    </w:comment>`).join("")}
</w:comments>`}async updateRelationships(){const i="word/_rels/document.xml.rels";let t=await this.zip.file(i)?.async("string");if(t||(t=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
</Relationships>`),t.includes("comments.xml"))return;const f=t.match(/rId(\d+)/g)||[];let o=0;for(const s of f){const h=parseInt(s.replace("rId",""),10);h>o&&(o=h)}const n=`<Relationship Id="${`rId${o+1}`}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments" Target="comments.xml"/>`;t=t.replace("</Relationships>",`  ${n}
</Relationships>`),this.zip.file(i,t)}async updateContentTypes(){const i="[Content_Types].xml";let t=await this.zip.file(i)?.async("string");if(!t||t.includes("/word/comments.xml"))return;t=t.replace("</Types>",`  <Override PartName="/word/comments.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml"/>
</Types>`),this.zip.file(i,t)}escapeXml(i){return i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}downloadBlob(i,t){const f=URL.createObjectURL(i),o=document.createElement("a");o.href=f,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(f)}getBaseName(i){return i.replace(/\.(docx?|DOCX?)$/,"")}}class se{generateReport(i,t,f,o,r,n){return{timestamp:new Date().toISOString(),originalFile:r,currentFile:n,parsing:this.generateParsingDebug(i,t),alignment:this.generateAlignmentDebug(o),diffs:this.generateDiffDebug(f)}}generateParsingDebug(i,t){return{original:{blockCount:i.blocks.length,blocks:i.blocks.map((f,o)=>this.blockToDebug(f,o))},current:{blockCount:t.blocks.length,blocks:t.blocks.map((f,o)=>this.blockToDebug(f,o))}}}blockToDebug(i,t){const f=i.text.trim()?i.text.trim().split(/\s+/).length:0,o=!!(i.formatting.bold||i.formatting.italic||i.formatting.underline||i.formatting.color||i.formatting.font||i.formatting.fontSize);return{index:t,type:i.type,textPreview:i.text.substring(0,100),textLength:i.text.length,wordCount:f,hasFormatting:o}}generateAlignmentDebug(i){let t=0,f=0,o=0,r=0;for(const n of i)switch(n.matchType){case"exact":t++;break;case"fuzzy":f++;break;case"delete":o++;break;case"insert":r++;break}return{exactMatches:t,fuzzyMatches:f,deletions:o,insertions:r,decisions:i}}generateDiffDebug(i){return i.blockDiffs.map(t=>this.blockDiffToDebug(t))}blockDiffToDebug(i){const t={type:i.type,changeId:i.changeId};if(i.originalBlock&&(t.originalText=i.originalBlock.text),i.currentBlock&&(t.currentText=i.currentBlock.text),i.wordDiff){let f=0,o=0,r=0;for(const n of i.wordDiff){const s=n.value.trim()?n.value.trim().split(/\s+/).length:0;n.added?f+=s:n.removed?o+=s:r+=s}t.wordDiffSummary={addedWords:f,removedWords:o,unchangedWords:r}}return t}exportToFile(i){const t=JSON.stringify(i,null,2),f=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(f),r=document.createElement("a");r.href=o,r.download=`debug-report-${new Date().toISOString().replace(/[:.]/g,"-")}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(o)}}class ae{constructor(){et(this,"fileUpload");et(this,"parser");et(this,"diffEngine");et(this,"renderer",null);et(this,"navigator",null);et(this,"docxInPlaceExporter");et(this,"debugExporter");et(this,"originalFileName","");et(this,"currentFileName","");et(this,"debugMode",!1);et(this,"currentDiff",null);et(this,"originalAST",null);et(this,"currentAST",null);et(this,"alignmentDecisions",[]);et(this,"currentFileBuffer",null);this.fileUpload=new $t,this.parser=new qt,this.diffEngine=new ee,this.docxInPlaceExporter=new ie,this.debugExporter=new se,this.debugMode=this.checkDebugMode(),this.diffEngine.setDebugMode(this.debugMode),this.fileUpload.onFilesReady((i,t)=>{this.originalFileName=i.name,this.currentFileName=t.name,this.compareDocuments(i,t)}),this.setupDocxExportButton(),this.setupDebugExportButton()}checkDebugMode(){return new URLSearchParams(window.location.search).get("debug")==="true"}async compareDocuments(i,t){try{this.showProgress("Parsing documents..."),this.currentFileBuffer=await t.arrayBuffer();const[f,o]=await Promise.all([this.parser.parseFile(i),this.parser.parseFile(t)]);this.updateProgress(50,"Comparing documents...");const r=this.diffEngine.diffDocumentsWithDebug(f,o);this.currentDiff=r.diff,this.originalAST=f,this.currentAST=o,this.alignmentDecisions=r.alignmentDecisions,this.updateProgress(75,"Rendering comparison..."),this.renderComparison(r.diff),this.updateProgress(100,"Complete!"),setTimeout(()=>{this.hideProgress(),this.showComparison()},500)}catch(f){console.error("Error comparing documents:",f),alert("Error comparing documents: "+(f instanceof Error?f.message:"Unknown error")),this.hideProgress()}}renderComparison(i){this.renderer||(this.renderer=new re("pane-redlined-content")),this.renderer.renderRedlined(i);const t=this.renderer.getChangeElements();this.navigator?this.navigator.updateChangeElements(t):this.navigator=new ne(t,"prev-change","next-change","change-counter")}showProgress(i){const t=document.getElementById("progress");t&&(t.style.display="block"),this.updateProgress(0,i)}updateProgress(i,t){const f=document.getElementById("progress-fill"),o=document.getElementById("progress-text");f&&(f.style.width=i+"%"),o&&(o.textContent=t)}hideProgress(){const i=document.getElementById("progress");i&&(i.style.display="none")}showComparison(){const i=document.getElementById("comparison"),t=document.getElementById("controls");i&&(i.style.display="flex"),t&&(t.style.display="flex")}setupDocxExportButton(){const i=document.getElementById("export-docx");i&&i.addEventListener("click",()=>this.exportDocx())}setupDebugExportButton(){const i=document.getElementById("export-debug");i&&i.addEventListener("click",()=>this.exportDebugReport())}async exportDocx(){const i=document.getElementById("export-docx");if(!this.currentDiff){alert("Please compare documents first before exporting.");return}if(!this.currentFileBuffer){alert("Current file buffer not available. Please try comparing documents again.");return}this.setButtonLoading(i,!0,"Exporting...");try{await new Promise(t=>setTimeout(t,10)),await this.docxInPlaceExporter.export(this.currentDiff,this.currentFileBuffer,this.originalFileName)}catch(t){console.error("DOCX export failed:",t),alert("Failed to export DOCX. Please try again.")}finally{this.setButtonLoading(i,!1,"Export DOCX")}}exportDebugReport(){if(!this.currentDiff||!this.originalAST||!this.currentAST){alert("Please compare documents first before exporting debug report.");return}const i=this.debugExporter.generateReport(this.originalAST,this.currentAST,this.currentDiff,this.alignmentDecisions,this.originalFileName,this.currentFileName);this.debugExporter.exportToFile(i)}setButtonLoading(i,t,f){i&&(t?(i.classList.add("exporting"),i.innerHTML=`<span class="spinner"></span>${f}`):(i.classList.remove("exporting"),i.textContent=f))}}new ae;
